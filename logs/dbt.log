[0m23:27:40.698559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ca330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113c9fd0>]}


============================== 23:27:40.700436 | 9e434321-a22b-4f2c-b01e-4cdfef9d6462 ==============================
[0m23:27:40.700436 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:27:40.700761 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt debug', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'empty': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'version_check': 'True', 'introspect': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'printer_width': '80', 'use_experimental_parser': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'cache_selected_only': 'False', 'warn_error': 'None', 'use_colors': 'True'}
[0m23:27:40.707549 [info ] [MainThread]: dbt version: 1.8.7
[0m23:27:40.707734 [info ] [MainThread]: python version: 3.12.4
[0m23:27:40.707870 [info ] [MainThread]: python path: /opt/anaconda3/bin/python
[0m23:27:40.707991 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m23:27:41.265853 [info ] [MainThread]: Using profiles dir at /Users/JELB/.dbt
[0m23:27:41.266190 [info ] [MainThread]: Using profiles.yml file at /Users/JELB/.dbt/profiles.yml
[0m23:27:41.266438 [info ] [MainThread]: Using dbt_project.yml file at /Users/JELB/dbtCourse/AIRBNB_DBT/dbt_project.yml
[0m23:27:41.266933 [info ] [MainThread]: adapter type: snowflake
[0m23:27:41.267106 [info ] [MainThread]: adapter version: 1.8.3
[0m23:27:41.304632 [info ] [MainThread]: Configuration:
[0m23:27:41.304958 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m23:27:41.305098 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m23:27:41.305224 [info ] [MainThread]: Required dependencies:
[0m23:27:41.305410 [debug] [MainThread]: Executing "git --help"
[0m23:27:41.323667 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m23:27:41.324290 [debug] [MainThread]: STDERR: "b''"
[0m23:27:41.324464 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m23:27:41.324620 [info ] [MainThread]: Connection:
[0m23:27:41.324776 [info ] [MainThread]:   account: poqdnsp-veb67537
[0m23:27:41.324892 [info ] [MainThread]:   user: dbt
[0m23:27:41.324998 [info ] [MainThread]:   database: AIRBNB
[0m23:27:41.325104 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m23:27:41.325207 [info ] [MainThread]:   role: transform
[0m23:27:41.325313 [info ] [MainThread]:   schema: DEV
[0m23:27:41.325426 [info ] [MainThread]:   authenticator: None
[0m23:27:41.325532 [info ] [MainThread]:   oauth_client_id: None
[0m23:27:41.325638 [info ] [MainThread]:   query_tag: None
[0m23:27:41.325743 [info ] [MainThread]:   client_session_keep_alive: False
[0m23:27:41.325843 [info ] [MainThread]:   host: None
[0m23:27:41.325946 [info ] [MainThread]:   port: None
[0m23:27:41.326046 [info ] [MainThread]:   proxy_host: None
[0m23:27:41.326147 [info ] [MainThread]:   proxy_port: None
[0m23:27:41.326244 [info ] [MainThread]:   protocol: None
[0m23:27:41.326344 [info ] [MainThread]:   connect_retries: 1
[0m23:27:41.326441 [info ] [MainThread]:   connect_timeout: None
[0m23:27:41.326538 [info ] [MainThread]:   retry_on_database_errors: False
[0m23:27:41.326637 [info ] [MainThread]:   retry_all: False
[0m23:27:41.326736 [info ] [MainThread]:   insecure_mode: False
[0m23:27:41.326834 [info ] [MainThread]:   reuse_connections: None
[0m23:27:41.327185 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:27:41.336252 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m23:27:41.337423 [debug] [MainThread]: Using snowflake connection "debug"
[0m23:27:41.337567 [debug] [MainThread]: On debug: select 1 as id
[0m23:27:41.337693 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:27:42.260222 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.922 seconds
[0m23:27:42.263256 [debug] [MainThread]: On debug: Close
[0m23:27:42.434016 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m23:27:42.434886 [info ] [MainThread]: [32mAll checks passed![0m
[0m23:27:42.438751 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.7882355, "process_user_time": 1.615618, "process_kernel_time": 1.522565, "process_mem_max_rss": "189743104", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:27:42.439662 [debug] [MainThread]: Command `dbt debug` succeeded at 23:27:42.439498 after 1.79 seconds
[0m23:27:42.440104 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m23:27:42.440536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103286930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14437cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144265a00>]}
[0m23:27:42.441015 [debug] [MainThread]: Flushing usage events
[0m23:28:08.302086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105975670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10633ce60>]}


============================== 23:28:08.304654 | 070a157f-4aef-4e24-899d-f09790a02118 ==============================
[0m23:28:08.304654 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:28:08.304976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:28:08.529240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fde8d0>]}
[0m23:28:08.551859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9a8a0>]}
[0m23:28:08.553253 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:28:08.563302 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:28:08.563869 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:28:08.564068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3be60>]}
[0m23:28:09.128675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072dc1a0>]}
[0m23:28:09.173623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eff140>]}
[0m23:28:09.173892 [info ] [MainThread]: Found 2 models, 4 data tests, 454 macros
[0m23:28:09.174064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d6780>]}
[0m23:28:09.174924 [info ] [MainThread]: 
[0m23:28:09.175207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:28:09.177196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m23:28:09.184177 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m23:28:09.184436 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m23:28:09.184575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:28:10.034674 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.850 seconds
[0m23:28:10.037581 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m23:28:10.185653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m23:28:10.186702 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m23:28:10.193511 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m23:28:10.193921 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m23:28:10.194277 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:10.781289 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.587 seconds
[0m23:28:10.783604 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m23:28:11.009129 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m23:28:11.020663 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m23:28:11.021049 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m23:28:11.021326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:28:11.622529 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.601 seconds
[0m23:28:11.625315 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m23:28:11.757637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed6f60>]}
[0m23:28:11.758593 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:28:11.759010 [info ] [MainThread]: 
[0m23:28:11.771996 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.my_first_dbt_model
[0m23:28:11.772647 [info ] [Thread-1 (]: 1 of 2 START sql table model DEV.my_first_dbt_model ............................ [RUN]
[0m23:28:11.773116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.my_first_dbt_model)
[0m23:28:11.773426 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.my_first_dbt_model
[0m23:28:11.780065 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.my_first_dbt_model"
[0m23:28:11.780980 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.my_first_dbt_model
[0m23:28:11.801202 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.my_first_dbt_model"
[0m23:28:11.802503 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.my_first_dbt_model"
[0m23:28:11.802827 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.my_first_dbt_model"} */
create or replace transient table AIRBNB.DEV.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:28:11.803053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:13.398393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.595 seconds
[0m23:28:13.417985 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_first_dbt_model: Close
[0m23:28:13.633293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e66030>]}
[0m23:28:13.634558 [info ] [Thread-1 (]: 1 of 2 OK created sql table model DEV.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m23:28:13.635404 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.my_first_dbt_model
[0m23:28:13.636457 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.my_second_dbt_model
[0m23:28:13.636998 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.my_second_dbt_model ............................ [RUN]
[0m23:28:13.637720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.my_first_dbt_model, now model.AIRBNB_DBT.my_second_dbt_model)
[0m23:28:13.638286 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.my_second_dbt_model
[0m23:28:13.641976 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.my_second_dbt_model"
[0m23:28:13.642928 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.my_second_dbt_model
[0m23:28:13.663148 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.my_second_dbt_model"
[0m23:28:13.664169 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.my_second_dbt_model"
[0m23:28:13.664426 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.my_second_dbt_model"} */
create or replace   view AIRBNB.DEV.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from AIRBNB.DEV.my_first_dbt_model
where id = 1
  );
[0m23:28:13.664656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:28:14.426516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.761 seconds
[0m23:28:14.429898 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_second_dbt_model: Close
[0m23:28:14.596609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070a157f-4aef-4e24-899d-f09790a02118', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106314b90>]}
[0m23:28:14.597902 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.96s]
[0m23:28:14.598909 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.my_second_dbt_model
[0m23:28:14.600508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:28:14.600849 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.my_second_dbt_model' was properly closed.
[0m23:28:14.601193 [info ] [MainThread]: 
[0m23:28:14.601546 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.43 seconds (5.43s).
[0m23:28:14.602400 [debug] [MainThread]: Command end result
[0m23:28:14.626893 [info ] [MainThread]: 
[0m23:28:14.627312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:28:14.627538 [info ] [MainThread]: 
[0m23:28:14.627750 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:28:14.629507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3561673, "process_user_time": 1.807616, "process_kernel_time": 0.208928, "process_mem_max_rss": "137887744", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:28:14.629862 [debug] [MainThread]: Command `dbt run` succeeded at 23:28:14.629802 after 6.36 seconds
[0m23:28:14.630099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107294830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106908ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768cc20>]}
[0m23:28:14.630329 [debug] [MainThread]: Flushing usage events
[0m23:29:28.929977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110110d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110110aa0>]}


============================== 23:29:28.932636 | 79d2941c-1651-4906-a9c4-83a94f5ecefa ==============================
[0m23:29:28.932636 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:29:28.932957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:29:29.111071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ed6d80>]}
[0m23:29:29.133377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111dee660>]}
[0m23:29:29.133802 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:29:29.142762 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:29:29.193402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:29:29.193648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:29:29.210257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11207efc0>]}
[0m23:29:29.249219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122d7c80>]}
[0m23:29:29.249476 [info ] [MainThread]: Found 2 models, 4 data tests, 454 macros
[0m23:29:29.249649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123c62d0>]}
[0m23:29:29.250590 [info ] [MainThread]: 
[0m23:29:29.250887 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:29:29.252792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m23:29:29.260723 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m23:29:29.260969 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m23:29:29.261104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:29:29.947402 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.686 seconds
[0m23:29:29.949696 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m23:29:30.160147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m23:29:30.160863 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m23:29:30.166304 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m23:29:30.166647 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m23:29:30.167037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:30.678202 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.511 seconds
[0m23:29:30.679549 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m23:29:30.829298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m23:29:30.842174 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m23:29:30.842667 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m23:29:30.842953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:29:31.328688 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.486 seconds
[0m23:29:31.331249 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m23:29:31.467400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa1820>]}
[0m23:29:31.468508 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:29:31.468941 [info ] [MainThread]: 
[0m23:29:31.471725 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.my_first_dbt_model
[0m23:29:31.472417 [info ] [Thread-1 (]: 1 of 2 START sql table model DEV.my_first_dbt_model ............................ [RUN]
[0m23:29:31.473264 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.my_first_dbt_model)
[0m23:29:31.473730 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.my_first_dbt_model
[0m23:29:31.481832 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.my_first_dbt_model"
[0m23:29:31.482748 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.my_first_dbt_model
[0m23:29:31.504646 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.my_first_dbt_model"
[0m23:29:31.505484 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.my_first_dbt_model"
[0m23:29:31.505733 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.my_first_dbt_model"} */
create or replace transient table AIRBNB.DEV.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:29:31.505949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:32.817826 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.312 seconds
[0m23:29:32.840411 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_first_dbt_model: Close
[0m23:29:32.968482 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124e6450>]}
[0m23:29:32.969499 [info ] [Thread-1 (]: 1 of 2 OK created sql table model DEV.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.49s]
[0m23:29:32.970231 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.my_first_dbt_model
[0m23:29:32.971155 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.my_second_dbt_model
[0m23:29:32.971904 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.my_second_dbt_model ............................ [RUN]
[0m23:29:32.972378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.my_first_dbt_model, now model.AIRBNB_DBT.my_second_dbt_model)
[0m23:29:32.972818 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.my_second_dbt_model
[0m23:29:32.978325 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.my_second_dbt_model"
[0m23:29:32.979376 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.my_second_dbt_model
[0m23:29:32.997085 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.my_second_dbt_model"
[0m23:29:32.997920 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.my_second_dbt_model"
[0m23:29:32.998174 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.my_second_dbt_model"} */
create or replace   view AIRBNB.DEV.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from AIRBNB.DEV.my_first_dbt_model
where id = 1
  );
[0m23:29:32.998396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:29:33.763489 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.764 seconds
[0m23:29:33.767426 [debug] [Thread-1 (]: On model.AIRBNB_DBT.my_second_dbt_model: Close
[0m23:29:33.897820 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79d2941c-1651-4906-a9c4-83a94f5ecefa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1168d5c10>]}
[0m23:29:33.898293 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.93s]
[0m23:29:33.898636 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.my_second_dbt_model
[0m23:29:33.899516 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:29:33.899672 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.my_second_dbt_model' was properly closed.
[0m23:29:33.899812 [info ] [MainThread]: 
[0m23:29:33.899988 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.65 seconds (4.65s).
[0m23:29:33.900372 [debug] [MainThread]: Command end result
[0m23:29:33.921077 [info ] [MainThread]: 
[0m23:29:33.921505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:29:33.921764 [info ] [MainThread]: 
[0m23:29:33.922020 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m23:29:33.923325 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.0282946, "process_user_time": 1.230144, "process_kernel_time": 0.167953, "process_mem_max_rss": "134725632", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:29:33.923733 [debug] [MainThread]: Command `dbt run` succeeded at 23:29:33.923668 after 5.03 seconds
[0m23:29:33.923998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110110e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121f9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fb5c0>]}
[0m23:29:33.924249 [debug] [MainThread]: Flushing usage events
[0m16:14:53.949801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58980>]}


============================== 16:14:53.952605 | b867f387-b9aa-4459-8a1d-fa4045e2fe43 ==============================
[0m16:14:53.952605 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:14:53.952927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:53.963275 [info ] [MainThread]: dbt version: 1.8.7
[0m16:14:53.963499 [info ] [MainThread]: python version: 3.12.7
[0m16:14:53.963641 [info ] [MainThread]: python path: /Users/JELB/dbtCourse/venv/bin/python
[0m16:14:53.963769 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m16:14:54.471622 [info ] [MainThread]: Using profiles dir at /Users/JELB/.dbt
[0m16:14:54.471882 [info ] [MainThread]: Using profiles.yml file at /Users/JELB/.dbt/profiles.yml
[0m16:14:54.472028 [info ] [MainThread]: Using dbt_project.yml file at /Users/JELB/dbtCourse/AIRBNB_DBT/dbt_project.yml
[0m16:14:54.472443 [info ] [MainThread]: adapter type: snowflake
[0m16:14:54.472626 [info ] [MainThread]: adapter version: 1.8.3
[0m16:14:54.511819 [info ] [MainThread]: Configuration:
[0m16:14:54.512108 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:14:54.512248 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:14:54.512372 [info ] [MainThread]: Required dependencies:
[0m16:14:54.512553 [debug] [MainThread]: Executing "git --help"
[0m16:14:54.622554 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:14:54.623119 [debug] [MainThread]: STDERR: "b''"
[0m16:14:54.623301 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:14:54.623462 [info ] [MainThread]: Connection:
[0m16:14:54.623619 [info ] [MainThread]:   account: poqdnsp-veb67537
[0m16:14:54.623747 [info ] [MainThread]:   user: dbt
[0m16:14:54.623864 [info ] [MainThread]:   database: AIRBNB
[0m16:14:54.623977 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m16:14:54.624099 [info ] [MainThread]:   role: transform
[0m16:14:54.624246 [info ] [MainThread]:   schema: DEV
[0m16:14:54.624391 [info ] [MainThread]:   authenticator: None
[0m16:14:54.624525 [info ] [MainThread]:   oauth_client_id: None
[0m16:14:54.624659 [info ] [MainThread]:   query_tag: None
[0m16:14:54.624793 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:14:54.624929 [info ] [MainThread]:   host: None
[0m16:14:54.625065 [info ] [MainThread]:   port: None
[0m16:14:54.625205 [info ] [MainThread]:   proxy_host: None
[0m16:14:54.625343 [info ] [MainThread]:   proxy_port: None
[0m16:14:54.625474 [info ] [MainThread]:   protocol: None
[0m16:14:54.625613 [info ] [MainThread]:   connect_retries: 1
[0m16:14:54.625745 [info ] [MainThread]:   connect_timeout: None
[0m16:14:54.625876 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:14:54.626011 [info ] [MainThread]:   retry_all: False
[0m16:14:54.626141 [info ] [MainThread]:   insecure_mode: False
[0m16:14:54.626273 [info ] [MainThread]:   reuse_connections: None
[0m16:14:54.626676 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:14:54.635376 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:14:54.636365 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:14:54.636542 [debug] [MainThread]: On debug: select 1 as id
[0m16:14:54.636690 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:55.993772 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.357 seconds
[0m16:14:55.995274 [debug] [MainThread]: On debug: Close
[0m16:14:56.149892 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:14:56.150614 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:14:56.171784 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.2555442, "process_user_time": 0.909786, "process_kernel_time": 0.203429, "process_mem_max_rss": "125566976", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:14:56.173085 [debug] [MainThread]: Command `dbt debug` succeeded at 16:14:56.172862 after 2.26 seconds
[0m16:14:56.173609 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:14:56.173995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10842e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d58a10>]}
[0m16:14:56.174389 [debug] [MainThread]: Flushing usage events
[0m16:22:55.056115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b38740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c14bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c14830>]}


============================== 16:22:55.059107 | cb212b75-224f-446d-a1d3-b4bed45f1d23 ==============================
[0m16:22:55.059107 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:22:55.059432 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m16:22:55.126108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb212b75-224f-446d-a1d3-b4bed45f1d23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eee870>]}
[0m16:22:55.136440 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:22:55.136832 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:22:55.138359 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.114203624, "process_user_time": 0.65049, "process_kernel_time": 0.108564, "process_mem_max_rss": "95404032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:22:55.138661 [debug] [MainThread]: Command `cli deps` succeeded at 16:22:55.138606 after 0.11 seconds
[0m16:22:55.138836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c14920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c14980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d0da90>]}
[0m16:22:55.139007 [debug] [MainThread]: Flushing usage events
[0m16:28:19.494655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110399400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110818290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110818c80>]}


============================== 16:28:19.497325 | 710618aa-c219-4959-934c-dc8f2b8537c8 ==============================
[0m16:28:19.497325 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:28:19.497664 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:28:19.569930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '710618aa-c219-4959-934c-dc8f2b8537c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073536b0>]}
[0m16:28:19.576283 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:28:19.576788 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:28:19.577662 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11854875, "process_user_time": 0.637198, "process_kernel_time": 0.092733, "process_mem_max_rss": "97026048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:28:19.577901 [debug] [MainThread]: Command `cli deps` succeeded at 16:28:19.577855 after 0.12 seconds
[0m16:28:19.578069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108a0500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108188f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110818290>]}
[0m16:28:19.578227 [debug] [MainThread]: Flushing usage events
[0m16:28:30.493914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b82a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104620c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046208c0>]}


============================== 16:28:30.496499 | 1225a91e-738b-4c01-b558-e7d4bd342f1f ==============================
[0m16:28:30.496499 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:28:30.496805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:30.504293 [info ] [MainThread]: dbt version: 1.8.7
[0m16:28:30.504508 [info ] [MainThread]: python version: 3.12.7
[0m16:28:30.504643 [info ] [MainThread]: python path: /Users/JELB/dbtCourse/venv/bin/python
[0m16:28:30.504831 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m16:28:30.654879 [info ] [MainThread]: Using profiles dir at /Users/JELB/.dbt
[0m16:28:30.655176 [info ] [MainThread]: Using profiles.yml file at /Users/JELB/.dbt/profiles.yml
[0m16:28:30.655310 [info ] [MainThread]: Using dbt_project.yml file at /Users/JELB/dbtCourse/AIRBNB_DBT/dbt_project.yml
[0m16:28:30.655638 [info ] [MainThread]: adapter type: snowflake
[0m16:28:30.656003 [info ] [MainThread]: adapter version: 1.8.3
[0m16:28:30.696581 [info ] [MainThread]: Configuration:
[0m16:28:30.696964 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:28:30.697300 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:28:30.697533 [info ] [MainThread]: Required dependencies:
[0m16:28:30.697728 [debug] [MainThread]: Executing "git --help"
[0m16:28:30.710634 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:28:30.711230 [debug] [MainThread]: STDERR: "b''"
[0m16:28:30.711409 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:28:30.711578 [info ] [MainThread]: Connection:
[0m16:28:30.711738 [info ] [MainThread]:   account: poqdnsp-veb67537
[0m16:28:30.711859 [info ] [MainThread]:   user: dbt
[0m16:28:30.712311 [info ] [MainThread]:   database: AIRBNB
[0m16:28:30.712720 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m16:28:30.712948 [info ] [MainThread]:   role: transform
[0m16:28:30.713346 [info ] [MainThread]:   schema: DEV
[0m16:28:30.713525 [info ] [MainThread]:   authenticator: None
[0m16:28:30.713822 [info ] [MainThread]:   oauth_client_id: None
[0m16:28:30.714211 [info ] [MainThread]:   query_tag: None
[0m16:28:30.714576 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:28:30.714722 [info ] [MainThread]:   host: None
[0m16:28:30.714887 [info ] [MainThread]:   port: None
[0m16:28:30.715155 [info ] [MainThread]:   proxy_host: None
[0m16:28:30.715322 [info ] [MainThread]:   proxy_port: None
[0m16:28:30.715454 [info ] [MainThread]:   protocol: None
[0m16:28:30.715577 [info ] [MainThread]:   connect_retries: 1
[0m16:28:30.715693 [info ] [MainThread]:   connect_timeout: None
[0m16:28:30.715812 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:28:30.715926 [info ] [MainThread]:   retry_all: False
[0m16:28:30.716038 [info ] [MainThread]:   insecure_mode: False
[0m16:28:30.716146 [info ] [MainThread]:   reuse_connections: None
[0m16:28:30.716569 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:28:30.719977 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:28:30.721102 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:28:30.721246 [debug] [MainThread]: On debug: select 1 as id
[0m16:28:30.721371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:31.777227 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.056 seconds
[0m16:28:31.779480 [debug] [MainThread]: On debug: Close
[0m16:28:31.914129 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:28:31.914900 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:28:31.918070 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4581913, "process_user_time": 0.8316, "process_kernel_time": 0.1491, "process_mem_max_rss": "127729664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:28:31.919104 [debug] [MainThread]: Command `cli debug` succeeded at 16:28:31.918929 after 1.46 seconds
[0m16:28:31.919776 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:28:31.920240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104555e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b82a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104272300>]}
[0m16:28:31.920740 [debug] [MainThread]: Flushing usage events
[0m16:29:57.614304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c816a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105510b60>]}


============================== 16:29:57.616407 | b812731c-4d97-4d10-8f26-8bbf1d2e401c ==============================
[0m16:29:57.616407 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:29:57.616726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:29:57.796185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b812731c-4d97-4d10-8f26-8bbf1d2e401c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c42810>]}
[0m16:29:57.818784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b812731c-4d97-4d10-8f26-8bbf1d2e401c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf6ba0>]}
[0m16:29:57.819186 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:29:57.828039 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:29:57.859004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:29:57.859289 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:29:57.859531 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models
[0m16:29:57.862289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b812731c-4d97-4d10-8f26-8bbf1d2e401c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f3530>]}
[0m16:29:57.890932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b812731c-4d97-4d10-8f26-8bbf1d2e401c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f11b50>]}
[0m16:29:57.891225 [info ] [MainThread]: Found 454 macros
[0m16:29:57.891391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b812731c-4d97-4d10-8f26-8bbf1d2e401c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca84a0>]}
[0m16:29:57.892197 [info ] [MainThread]: 
[0m16:29:57.892373 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:29:57.893375 [debug] [MainThread]: Command end result
[0m16:29:57.905338 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.31948516, "process_user_time": 0.78757, "process_kernel_time": 0.123972, "process_mem_max_rss": "120864768", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:29:57.905687 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:57.905642 after 0.32 seconds
[0m16:29:57.905893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055109e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfb050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d6ad20>]}
[0m16:29:57.906055 [debug] [MainThread]: Flushing usage events
[0m16:36:18.312841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dd6e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104914c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104914950>]}


============================== 16:36:18.315185 | 73b1b8b2-b6e5-4c48-814f-4c87fe018d6a ==============================
[0m16:36:18.315185 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:36:18.315504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:36:18.382355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73b1b8b2-b6e5-4c48-814f-4c87fe018d6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103209ca0>]}
[0m16:36:18.390792 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.10943058, "process_user_time": 0.629147, "process_kernel_time": 0.091409, "process_mem_max_rss": "95420416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:18.391086 [debug] [MainThread]: Command `dbt clean` succeeded at 16:36:18.391036 after 0.11 seconds
[0m16:36:18.391264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100de4920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044aa1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103209ca0>]}
[0m16:36:18.391421 [debug] [MainThread]: Flushing usage events
[0m17:03:40.360630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031fc3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105810f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105810cb0>]}


============================== 17:03:40.363476 | d4a0b358-7f80-4bd2-b40c-82f707a1e855 ==============================
[0m17:03:40.363476 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:03:40.363808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:03:40.586803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aefa10>]}
[0m17:03:40.610025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069165a0>]}
[0m17:03:40.610660 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:03:40.619691 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:03:40.661070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:40.661333 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:40.672971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f00680>]}
[0m17:03:40.712668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f91d00>]}
[0m17:03:40.713004 [info ] [MainThread]: Found 1 model, 454 macros
[0m17:03:40.713184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d2cc0>]}
[0m17:03:40.714138 [info ] [MainThread]: 
[0m17:03:40.714501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:40.715010 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:03:40.722670 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:03:40.722861 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:03:40.722996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:41.548595 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.825 seconds
[0m17:03:41.550067 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:03:41.698747 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m17:03:41.699494 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m17:03:41.704622 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m17:03:41.704915 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m17:03:41.705149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:42.300811 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.595 seconds
[0m17:03:42.302853 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m17:03:42.493378 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m17:03:42.501422 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:03:42.501749 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:03:42.501966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:43.014443 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.512 seconds
[0m17:03:43.015536 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:03:43.135106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042b2ea0>]}
[0m17:03:43.135555 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:43.135751 [info ] [MainThread]: 
[0m17:03:43.137444 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m17:03:43.137770 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listing .................................... [RUN]
[0m17:03:43.138009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_listing)
[0m17:03:43.138179 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m17:03:43.141941 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m17:03:43.142570 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m17:03:43.157201 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m17:03:43.158272 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m17:03:43.158532 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
select 
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
from 
    raw_listings;
[0m17:03:43.158702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:43.580578 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7c2c3-0003-ecdc-0001-75d7000352c6
[0m17:03:43.581042 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 18 at position 16 unexpected ';'.
[0m17:03:43.581397 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m17:03:43.726332 [debug] [Thread-1 (]: Database Error in model src_listing (models/src/src_listing.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 16 unexpected ';'.
  compiled code at target/run/AIRBNB_DBT/models/src/src_listing.sql
[0m17:03:43.728338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4a0b358-7f80-4bd2-b40c-82f707a1e855', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ad100>]}
[0m17:03:43.729058 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DEV.src_listing ........................... [[31mERROR[0m in 0.59s]
[0m17:03:43.729689 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m17:03:43.731419 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:43.731683 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_listing' was properly closed.
[0m17:03:43.731942 [info ] [MainThread]: 
[0m17:03:43.732212 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m17:03:43.732739 [debug] [MainThread]: Command end result
[0m17:03:43.753587 [info ] [MainThread]: 
[0m17:03:43.753943 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:03:43.754128 [info ] [MainThread]: 
[0m17:03:43.754347 [error] [MainThread]:   Database Error in model src_listing (models/src/src_listing.sql)
  001003 (42000): SQL compilation error:
  syntax error line 18 at position 16 unexpected ';'.
  compiled code at target/run/AIRBNB_DBT/models/src/src_listing.sql
[0m17:03:43.754517 [info ] [MainThread]: 
[0m17:03:43.754701 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:03:43.756218 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.4265192, "process_user_time": 1.072216, "process_kernel_time": 0.189966, "process_mem_max_rss": "133562368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:03:43.756691 [debug] [MainThread]: Command `dbt run` failed at 17:03:43.756605 after 3.43 seconds
[0m17:03:43.757003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d824b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ffb830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10182ecc0>]}
[0m17:03:43.757226 [debug] [MainThread]: Flushing usage events
[0m17:04:57.591823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063fb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dcf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dccb0>]}


============================== 17:04:57.593908 | eed7e0da-cf2a-4b88-b595-6f20d8a2263b ==============================
[0m17:04:57.593908 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:04:57.594204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:04:57.774404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072446e0>]}
[0m17:04:57.796869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055e30e0>]}
[0m17:04:57.797270 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:04:57.805893 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:04:57.845543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:57.845788 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:57.856960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107320800>]}
[0m17:04:57.891771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074714f0>]}
[0m17:04:57.892051 [info ] [MainThread]: Found 1 model, 454 macros
[0m17:04:57.892221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737b890>]}
[0m17:04:57.893113 [info ] [MainThread]: 
[0m17:04:57.893403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:04:57.893843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:04:57.901401 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:04:57.901692 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:04:57.901867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:58.711133 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.809 seconds
[0m17:04:58.714014 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:04:58.852467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:04:58.860979 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:04:58.861297 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:04:58.861672 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:59.400109 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.538 seconds
[0m17:04:59.403754 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:04:59.625058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737af30>]}
[0m17:04:59.625756 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:04:59.626012 [info ] [MainThread]: 
[0m17:04:59.628219 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m17:04:59.628784 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listing .................................... [RUN]
[0m17:04:59.629123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_listing)
[0m17:04:59.629332 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m17:04:59.635001 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m17:04:59.635619 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m17:04:59.652602 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m17:04:59.653349 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m17:04:59.653793 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
select 
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
from 
    raw_listings
  );
[0m17:04:59.654037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:00.470183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m17:05:00.490988 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m17:05:00.715283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eed7e0da-cf2a-4b88-b595-6f20d8a2263b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071f5fd0>]}
[0m17:05:00.715890 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.08s]
[0m17:05:00.716213 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m17:05:00.716902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:00.717046 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_listing' was properly closed.
[0m17:05:00.717188 [info ] [MainThread]: 
[0m17:05:00.717421 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m17:05:00.718176 [debug] [MainThread]: Command end result
[0m17:05:00.740102 [info ] [MainThread]: 
[0m17:05:00.740432 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:00.740628 [info ] [MainThread]: 
[0m17:05:00.740796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:00.741833 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.178328, "process_user_time": 1.05298, "process_kernel_time": 0.164041, "process_mem_max_rss": "134692864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:05:00.742457 [debug] [MainThread]: Command `dbt run` succeeded at 17:05:00.742235 after 3.18 seconds
[0m17:05:00.742726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748a0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106468500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078aec90>]}
[0m17:05:00.742928 [debug] [MainThread]: Flushing usage events
[0m17:09:42.258564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a01820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105811040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105810d70>]}


============================== 17:09:42.260596 | 0a4dcc87-315a-4e9c-a9f1-6653990f9b48 ==============================
[0m17:09:42.260596 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:09:42.260895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:42.446727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f6eae0>]}
[0m17:09:42.469345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063cee40>]}
[0m17:09:42.469743 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:09:42.479148 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:09:42.521659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:42.521907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:42.533722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d06960>]}
[0m17:09:42.568359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106769d30>]}
[0m17:09:42.568612 [info ] [MainThread]: Found 1 model, 454 macros
[0m17:09:42.568797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067854c0>]}
[0m17:09:42.569721 [info ] [MainThread]: 
[0m17:09:42.569987 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:42.570495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:09:42.578039 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:09:42.578212 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:09:42.578344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:43.334893 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.756 seconds
[0m17:09:43.336248 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:09:43.458029 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:09:43.465348 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:09:43.465689 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:09:43.465872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:43.975591 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.510 seconds
[0m17:09:43.977675 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:09:44.151084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065240b0>]}
[0m17:09:44.151774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:44.151992 [info ] [MainThread]: 
[0m17:09:44.157117 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m17:09:44.157706 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listing .................................... [RUN]
[0m17:09:44.158029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_listing)
[0m17:09:44.158208 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m17:09:44.161865 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m17:09:44.162449 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m17:09:44.187738 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m17:09:44.189269 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m17:09:44.189505 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
select 
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
from 
    raw_listings
  );
[0m17:09:44.189671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:45.147523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.957 seconds
[0m17:09:45.176060 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m17:09:45.371477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a4dcc87-315a-4e9c-a9f1-6653990f9b48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063819a0>]}
[0m17:09:45.372866 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.21s]
[0m17:09:45.373942 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m17:09:45.375448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:45.375905 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_listing' was properly closed.
[0m17:09:45.376293 [info ] [MainThread]: 
[0m17:09:45.376800 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.81 seconds (2.81s).
[0m17:09:45.377704 [debug] [MainThread]: Command end result
[0m17:09:45.401927 [info ] [MainThread]: 
[0m17:09:45.402304 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:45.402511 [info ] [MainThread]: 
[0m17:09:45.402736 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:45.404844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1744664, "process_user_time": 1.040153, "process_kernel_time": 0.164063, "process_mem_max_rss": "132988928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:09:45.405402 [debug] [MainThread]: Command `dbt run` succeeded at 17:09:45.405334 after 3.18 seconds
[0m17:09:45.405718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105810fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105811040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105811010>]}
[0m17:09:45.406018 [debug] [MainThread]: Flushing usage events
[0m17:10:18.867316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111aaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111351010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111350d40>]}


============================== 17:10:18.869848 | 8d315d6e-1fcd-4c4f-81a8-da9812b194d0 ==============================
[0m17:10:18.869848 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:10:18.870186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:19.074776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11411ba10>]}
[0m17:10:19.098931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11075e420>]}
[0m17:10:19.099385 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:10:19.108624 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:10:19.150113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:10:19.150420 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://models/src/src_reviews.sql
[0m17:10:19.245941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11469c4d0>]}
[0m17:10:19.279709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11477d850>]}
[0m17:10:19.280012 [info ] [MainThread]: Found 2 models, 454 macros
[0m17:10:19.280182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147aabd0>]}
[0m17:10:19.281102 [info ] [MainThread]: 
[0m17:10:19.281383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:10:19.283327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:10:19.289989 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:10:19.290220 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:10:19.290357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:20.003775 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.713 seconds
[0m17:10:20.006575 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:10:20.154871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:10:20.162528 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:10:20.162846 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:10:20.163042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:20.709582 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.546 seconds
[0m17:10:20.711267 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:10:20.939679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146fc410>]}
[0m17:10:20.940251 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:20.940478 [info ] [MainThread]: 
[0m17:10:20.942098 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m17:10:20.942432 [info ] [Thread-1 (]: 1 of 2 START sql view model DEV.src_listing .................................... [RUN]
[0m17:10:20.942688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_listing)
[0m17:10:20.942954 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m17:10:20.946939 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m17:10:20.947507 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m17:10:20.964384 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m17:10:20.965180 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m17:10:20.965364 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
select 
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
from 
    raw_listings
  );
[0m17:10:20.965527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:21.704117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m17:10:21.722095 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m17:10:21.859779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106ec440>]}
[0m17:10:21.860627 [info ] [Thread-1 (]: 1 of 2 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m17:10:21.861266 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m17:10:21.861685 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m17:10:21.862100 [info ] [Thread-1 (]: 2 of 2 START sql view model DEV.src_reviews .................................... [RUN]
[0m17:10:21.862659 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m17:10:21.862979 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m17:10:21.864702 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m17:10:21.865580 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m17:10:21.868032 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m17:10:21.869292 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m17:10:21.869603 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m17:10:21.869862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:10:22.532332 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m17:10:22.535796 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m17:10:22.665981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d315d6e-1fcd-4c4f-81a8-da9812b194d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11475b5c0>]}
[0m17:10:22.667036 [info ] [Thread-1 (]: 2 of 2 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.80s]
[0m17:10:22.667440 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m17:10:22.668620 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:22.668897 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_reviews' was properly closed.
[0m17:10:22.669144 [info ] [MainThread]: 
[0m17:10:22.669343 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 3.39 seconds (3.39s).
[0m17:10:22.669959 [debug] [MainThread]: Command end result
[0m17:10:22.691578 [info ] [MainThread]: 
[0m17:10:22.691927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:22.692135 [info ] [MainThread]: 
[0m17:10:22.692339 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:10:22.693551 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8633614, "process_user_time": 1.174627, "process_kernel_time": 0.174258, "process_mem_max_rss": "138428416", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:10:22.693968 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:22.693902 after 3.86 seconds
[0m17:10:22.694248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e52f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111aaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142786e0>]}
[0m17:10:22.694498 [debug] [MainThread]: Flushing usage events
[0m20:16:49.614548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656a870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78c50>]}


============================== 20:16:49.617329 | 51d0e8a6-41ec-422f-99e6-e662ffc64f65 ==============================
[0m20:16:49.617329 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:16:49.617651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:16:49.837791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105948b90>]}
[0m20:16:49.861259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107242720>]}
[0m20:16:49.861896 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:16:49.870775 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:16:49.909709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:16:49.909950 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:16:49.921024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d0f20>]}
[0m20:16:49.961242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e9d30>]}
[0m20:16:49.961590 [info ] [MainThread]: Found 3 models, 454 macros
[0m20:16:49.961768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107651370>]}
[0m20:16:49.962728 [info ] [MainThread]: 
[0m20:16:49.963081 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:16:49.965108 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m20:16:49.972813 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m20:16:49.973046 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m20:16:49.973184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:16:50.765531 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.792 seconds
[0m20:16:50.768776 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:16:50.911857 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m20:16:50.923641 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:16:50.924052 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:16:50.924346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:16:51.516209 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.591 seconds
[0m20:16:51.522829 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:16:51.646159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077110a0>]}
[0m20:16:51.646856 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:16:51.647206 [info ] [MainThread]: 
[0m20:16:51.651121 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m20:16:51.651689 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m20:16:51.652093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m20:16:51.652382 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m20:16:51.659174 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m20:16:51.660230 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m20:16:51.681321 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m20:16:51.682173 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m20:16:51.682419 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m20:16:51.682634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:52.588128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.905 seconds
[0m20:16:52.614670 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m20:16:52.792998 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22c60>]}
[0m20:16:52.794088 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.14s]
[0m20:16:52.795242 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m20:16:52.795859 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m20:16:52.796624 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listing .................................... [RUN]
[0m20:16:52.797355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m20:16:52.797798 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m20:16:52.800327 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m20:16:52.801526 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m20:16:52.805092 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m20:16:52.806951 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m20:16:52.807369 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
select 
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
from 
    raw_listings
  );
[0m20:16:52.807693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:53.874235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.066 seconds
[0m20:16:53.882419 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m20:16:54.047183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e04110>]}
[0m20:16:54.049820 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.25s]
[0m20:16:54.051244 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m20:16:54.051769 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m20:16:54.052379 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.src_reviews .................................... [RUN]
[0m20:16:54.052941 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m20:16:54.053300 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m20:16:54.055767 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m20:16:54.057746 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m20:16:54.060478 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m20:16:54.062237 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m20:16:54.062649 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m20:16:54.063257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:16:54.880726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.816 seconds
[0m20:16:54.888614 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m20:16:55.077127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51d0e8a6-41ec-422f-99e6-e662ffc64f65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b87380>]}
[0m20:16:55.078204 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.02s]
[0m20:16:55.079127 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m20:16:55.080780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:16:55.081180 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_reviews' was properly closed.
[0m20:16:55.081643 [info ] [MainThread]: 
[0m20:16:55.082032 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 5.12 seconds (5.12s).
[0m20:16:55.082984 [debug] [MainThread]: Command end result
[0m20:16:55.108107 [info ] [MainThread]: 
[0m20:16:55.108546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:16:55.108764 [info ] [MainThread]: 
[0m20:16:55.108993 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m20:16:55.110894 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.526854, "process_user_time": 1.296573, "process_kernel_time": 0.197823, "process_mem_max_rss": "134365184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:16:55.111390 [debug] [MainThread]: Command `dbt run` succeeded at 20:16:55.111319 after 5.53 seconds
[0m20:16:55.111702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a78c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064af170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656a870>]}
[0m20:16:55.111960 [debug] [MainThread]: Flushing usage events
[0m21:37:53.630364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10294f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0cda0>]}


============================== 21:37:53.633341 | 373fe53c-c9f1-42c3-9317-ac06c1d7b091 ==============================
[0m21:37:53.633341 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:37:53.633655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:37:53.855829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373fe53c-c9f1-42c3-9317-ac06c1d7b091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103501c40>]}
[0m21:37:53.878421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '373fe53c-c9f1-42c3-9317-ac06c1d7b091', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042692b0>]}
[0m21:37:53.879048 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:37:53.888485 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:37:53.929426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:37:53.929788 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/src/src_reviews.sql
[0m21:37:54.000696 [error] [MainThread]: Encountered an error:
Compilation Error in model src_reviews (models/src/src_reviews.sql)
  expected token ',', got 'the'
    line 2
      materialized='table'  -- Specify the type of materialization here
[0m21:37:54.002544 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4117414, "process_user_time": 0.838297, "process_kernel_time": 0.143547, "process_mem_max_rss": "121569280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:37:54.002866 [debug] [MainThread]: Command `dbt run` failed at 21:37:54.002815 after 0.41 seconds
[0m21:37:54.003075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c0cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105add3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058af9b0>]}
[0m21:37:54.003242 [debug] [MainThread]: Flushing usage events
[0m21:38:13.437330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ed62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743cda0>]}


============================== 21:38:13.439433 | 5b3a5868-9c5f-4c90-8a7e-72dca61975cf ==============================
[0m21:38:13.439433 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:38:13.439748 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m21:38:13.620341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b3a5868-9c5f-4c90-8a7e-72dca61975cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460380>]}
[0m21:38:13.642962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b3a5868-9c5f-4c90-8a7e-72dca61975cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f2b10>]}
[0m21:38:13.644393 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:38:13.653640 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:38:13.693131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:13.693504 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/src/src_reviews.sql
[0m21:38:13.764784 [error] [MainThread]: Encountered an error:
Compilation Error in model src_reviews (models/src/src_reviews.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m21:38:13.766480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35763133, "process_user_time": 0.815811, "process_kernel_time": 0.117416, "process_mem_max_rss": "121470976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:38:13.766797 [debug] [MainThread]: Command `dbt run` failed at 21:38:13.766746 after 0.36 seconds
[0m21:38:13.767015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105587e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c76030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c13a0>]}
[0m21:38:13.767187 [debug] [MainThread]: Flushing usage events
[0m21:38:34.407961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa8110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c50ce0>]}


============================== 21:38:34.410619 | f8e43551-80a5-482a-83a5-0399b3681c1d ==============================
[0m21:38:34.410619 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:38:34.410945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:38:34.617242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8e43551-80a5-482a-83a5-0399b3681c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133762d0>]}
[0m21:38:34.639891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8e43551-80a5-482a-83a5-0399b3681c1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e76180>]}
[0m21:38:34.640491 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:38:34.649867 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:38:34.688878 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:38:34.689261 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/src/src_reviews.sql
[0m21:38:34.761704 [error] [MainThread]: Encountered an error:
Compilation Error in model src_reviews (models/src/src_reviews.sql)
  expected token 'end of print statement', got 'the'
    line 2
      materialized='table')  -- Specify the type of materialization here
[0m21:38:34.763459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.38951743, "process_user_time": 0.82398, "process_kernel_time": 0.125704, "process_mem_max_rss": "124043264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:38:34.763792 [debug] [MainThread]: Command `dbt run` failed at 21:38:34.763744 after 0.39 seconds
[0m21:38:34.764223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c510d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112970f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113753560>]}
[0m21:38:34.764441 [debug] [MainThread]: Flushing usage events
[0m21:39:07.130553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038d2600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4ce00>]}


============================== 21:39:07.133081 | 93d19741-c1d1-409b-b39e-680f605d0e9a ==============================
[0m21:39:07.133081 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:39:07.133379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:39:07.336982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a099d0>]}
[0m21:39:07.359726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4cb90>]}
[0m21:39:07.361173 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:39:07.370468 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:39:07.412631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:07.412897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:07.424395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120b85730>]}
[0m21:39:07.464960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d1ee70>]}
[0m21:39:07.465272 [info ] [MainThread]: Found 3 models, 454 macros
[0m21:39:07.465445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1209839b0>]}
[0m21:39:07.466403 [info ] [MainThread]: 
[0m21:39:07.466697 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:07.468723 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m21:39:07.476042 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m21:39:07.476249 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m21:39:07.476385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:08.354933 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.878 seconds
[0m21:39:08.357996 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m21:39:08.531858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m21:39:08.539620 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m21:39:08.539886 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m21:39:08.540080 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:09.087266 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.547 seconds
[0m21:39:09.090724 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m21:39:09.223752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a1880>]}
[0m21:39:09.224305 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:09.224602 [info ] [MainThread]: 
[0m21:39:09.228297 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m21:39:09.228751 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m21:39:09.229081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m21:39:09.229322 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m21:39:09.235583 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m21:39:09.237035 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m21:39:09.256468 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m21:39:09.257258 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m21:39:09.257470 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m21:39:09.257653 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:10.218833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.961 seconds
[0m21:39:10.249205 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m21:39:10.408554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120a09e20>]}
[0m21:39:10.409669 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.18s]
[0m21:39:10.410546 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m21:39:10.411145 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m21:39:10.411796 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listing .................................... [RUN]
[0m21:39:10.412385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m21:39:10.412794 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m21:39:10.415123 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m21:39:10.416117 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m21:39:10.419575 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m21:39:10.420697 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m21:39:10.421060 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m21:39:10.421386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:11.525794 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m21:39:11.533111 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m21:39:11.679452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1212f2bd0>]}
[0m21:39:11.680547 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.27s]
[0m21:39:11.681513 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m21:39:11.682099 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m21:39:11.682848 [info ] [Thread-1 (]: 3 of 3 START sql table model DEV.src_reviews ................................... [RUN]
[0m21:39:11.683460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m21:39:11.683873 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m21:39:11.687940 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m21:39:11.688914 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m21:39:11.699125 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type view
[0m21:39:11.706173 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_REVIEWS"
[0m21:39:11.712018 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:11.712293 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
drop view if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m21:39:11.712519 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:12.276293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m21:39:12.300215 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m21:39:12.301709 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:12.302051 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace transient table AIRBNB.DEV.src_reviews
         as
        (

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
        );
[0m21:39:16.312665 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.010 seconds
[0m21:39:16.316174 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m21:39:16.560195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93d19741-c1d1-409b-b39e-680f605d0e9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120fce000>]}
[0m21:39:16.561599 [info ] [Thread-1 (]: 3 of 3 OK created sql table model DEV.src_reviews .............................. [[32mSUCCESS 1[0m in 4.88s]
[0m21:39:16.562435 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m21:39:16.564238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:16.564576 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_reviews' was properly closed.
[0m21:39:16.565023 [info ] [MainThread]: 
[0m21:39:16.565394 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 9.10 seconds (9.10s).
[0m21:39:16.566357 [debug] [MainThread]: Command end result
[0m21:39:16.592524 [info ] [MainThread]: 
[0m21:39:16.592933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:16.593145 [info ] [MainThread]: 
[0m21:39:16.593363 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:39:16.595453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.49395, "process_user_time": 1.321092, "process_kernel_time": 0.192765, "process_mem_max_rss": "132792320", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:16.596073 [debug] [MainThread]: Command `dbt run` succeeded at 21:39:16.595997 after 9.49 seconds
[0m21:39:16.596385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d4d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120d9e9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d14530>]}
[0m21:39:16.596647 [debug] [MainThread]: Flushing usage events
[0m21:39:49.184650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197d580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f110a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f10e00>]}


============================== 21:39:49.187156 | e76a56a5-ad50-47df-b16f-b978333dc634 ==============================
[0m21:39:49.187156 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:39:49.187464 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:39:49.396161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383bad0>]}
[0m21:39:49.419021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a5dca0>]}
[0m21:39:49.420444 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:39:49.430036 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:39:49.471496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:39:49.471839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:39:49.483689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a6f170>]}
[0m21:39:49.521591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113dda630>]}
[0m21:39:49.521897 [info ] [MainThread]: Found 3 models, 454 macros
[0m21:39:49.522072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112edaff0>]}
[0m21:39:49.523079 [info ] [MainThread]: 
[0m21:39:49.523372 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:49.525435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m21:39:49.532827 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m21:39:49.533036 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m21:39:49.533167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:50.317582 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.784 seconds
[0m21:39:50.320699 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m21:39:50.523472 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m21:39:50.536937 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m21:39:50.537371 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m21:39:50.537660 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:39:51.441567 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.903 seconds
[0m21:39:51.446552 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m21:39:51.718030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109a1a00>]}
[0m21:39:51.718911 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:51.719310 [info ] [MainThread]: 
[0m21:39:51.723240 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m21:39:51.723793 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m21:39:51.724218 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m21:39:51.724894 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m21:39:51.731762 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m21:39:51.732842 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m21:39:51.754569 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m21:39:51.755408 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m21:39:51.755642 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m21:39:51.755884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:52.628610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m21:39:52.641738 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m21:39:52.791283 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119f44d0>]}
[0m21:39:52.792070 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.07s]
[0m21:39:52.792678 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m21:39:52.793108 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m21:39:52.793661 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listing .................................... [RUN]
[0m21:39:52.794169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m21:39:52.794508 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m21:39:52.796551 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m21:39:52.797387 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m21:39:52.800301 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m21:39:52.801475 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m21:39:52.801808 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m21:39:52.802100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:53.698982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.896 seconds
[0m21:39:53.707886 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m21:39:53.887697 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144f3b30>]}
[0m21:39:53.888876 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.09s]
[0m21:39:53.889736 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m21:39:53.890317 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m21:39:53.890973 [info ] [Thread-1 (]: 3 of 3 START sql incremental model DEV.src_reviews ............................. [RUN]
[0m21:39:53.891577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m21:39:53.892005 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m21:39:53.896149 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m21:39:53.897143 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m21:39:53.926941 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:53.927274 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace  temporary view AIRBNB.DEV.src_reviews__dbt_tmp
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m21:39:53.927493 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:54.631056 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m21:39:54.643066 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:54.643537 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
describe table AIRBNB.DEV.src_reviews__dbt_tmp
[0m21:39:54.763347 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.119 seconds
[0m21:39:54.772941 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:54.773501 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
describe table AIRBNB.DEV.src_reviews
[0m21:39:54.969350 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.195 seconds
[0m21:39:54.981145 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:54.981548 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
describe table "AIRBNB"."DEV"."SRC_REVIEWS"
[0m21:39:55.078172 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.096 seconds
[0m21:39:55.099273 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m21:39:55.100460 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:55.100782 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m21:39:55.284536 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m21:39:55.286311 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:55.287286 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
insert into AIRBNB.DEV.src_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.src_reviews__dbt_tmp
        );
[0m21:39:57.623685 [debug] [Thread-1 (]: SQL status: SUCCESS 410284 in 2.336 seconds
[0m21:39:57.624008 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:57.624180 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
COMMIT
[0m21:39:58.358499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.734 seconds
[0m21:39:58.368703 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.src_reviews__dbt_tmp
[0m21:39:58.374049 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m21:39:58.374310 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
drop view if exists AIRBNB.DEV.src_reviews__dbt_tmp cascade
[0m21:39:58.500528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.125 seconds
[0m21:39:58.507385 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m21:39:58.696314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e76a56a5-ad50-47df-b16f-b978333dc634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143ebbf0>]}
[0m21:39:58.697977 [info ] [Thread-1 (]: 3 of 3 OK created sql incremental model DEV.src_reviews ........................ [[32mSUCCESS 410284[0m in 4.80s]
[0m21:39:58.698782 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m21:39:58.700451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:58.700895 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_reviews' was properly closed.
[0m21:39:58.701375 [info ] [MainThread]: 
[0m21:39:58.701792 [info ] [MainThread]: Finished running 2 view models, 1 incremental model in 0 hours 0 minutes and 9.18 seconds (9.18s).
[0m21:39:58.702853 [debug] [MainThread]: Command end result
[0m21:39:58.728075 [info ] [MainThread]: 
[0m21:39:58.728599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:39:58.728823 [info ] [MainThread]: 
[0m21:39:58.729058 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m21:39:58.730866 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.574914, "process_user_time": 1.431306, "process_kernel_time": 0.201765, "process_mem_max_rss": "134774784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:58.731424 [debug] [MainThread]: Command `dbt run` succeeded at 21:39:58.731353 after 9.58 seconds
[0m21:39:58.731729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f10e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e82ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e82810>]}
[0m21:39:58.731991 [debug] [MainThread]: Flushing usage events
[0m17:46:43.485916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0da0>]}


============================== 17:46:43.488701 | 981bafcd-6ce3-4860-ad77-2995150d29f8 ==============================
[0m17:46:43.488701 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:46:43.489023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:46:43.716854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff1970>]}
[0m17:46:43.740917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0b90>]}
[0m17:46:43.741923 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:46:43.752116 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:46:43.794145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:46:43.794397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:46:43.806347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069cffb0>]}
[0m17:46:43.846305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae2ea0>]}
[0m17:46:43.846634 [info ] [MainThread]: Found 3 models, 454 macros
[0m17:46:43.846820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5f9b0>]}
[0m17:46:43.847790 [info ] [MainThread]: 
[0m17:46:43.848098 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:46:43.850167 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:46:43.857537 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:46:43.857734 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:46:43.857865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:46:46.500011 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.642 seconds
[0m17:46:46.502932 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:46:46.644103 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:46:46.656744 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:46:46.657222 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:46:46.657519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:46:47.095490 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.437 seconds
[0m17:46:47.100698 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:46:47.254577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047157c0>]}
[0m17:46:47.255406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:46:47.255865 [info ] [MainThread]: 
[0m17:46:47.260290 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m17:46:47.260890 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.src_hosts ...................................... [RUN]
[0m17:46:47.261365 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m17:46:47.262240 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m17:46:47.269840 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m17:46:47.271208 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m17:46:47.294663 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m17:46:47.295777 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m17:46:47.296198 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m17:46:47.296454 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:48.012625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m17:46:48.037274 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m17:46:48.178416 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d9df0>]}
[0m17:46:48.179105 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.92s]
[0m17:46:48.179633 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m17:46:48.179998 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m17:46:48.180431 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listing .................................... [RUN]
[0m17:46:48.180820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m17:46:48.181081 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m17:46:48.182639 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m17:46:48.183255 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m17:46:48.186761 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m17:46:48.187686 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m17:46:48.187947 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m17:46:48.188177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:48.926111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.737 seconds
[0m17:46:48.930634 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m17:46:49.121396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed1cd0>]}
[0m17:46:49.122399 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.94s]
[0m17:46:49.123254 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m17:46:49.123841 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m17:46:49.124373 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.src_reviews .................................... [RUN]
[0m17:46:49.124876 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m17:46:49.125390 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m17:46:49.129485 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m17:46:49.130482 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m17:46:49.138049 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."SRC_REVIEWS" because it is of type table
[0m17:46:49.143480 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."SRC_REVIEWS"
[0m17:46:49.149333 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m17:46:49.149636 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
drop table if exists "AIRBNB"."DEV"."SRC_REVIEWS" cascade
[0m17:46:49.149891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:46:49.617699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.467 seconds
[0m17:46:49.624953 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m17:46:49.628569 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m17:46:49.629311 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m17:46:50.116841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m17:46:50.122130 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m17:46:50.256829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '981bafcd-6ce3-4860-ad77-2995150d29f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e7c500>]}
[0m17:46:50.258003 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.13s]
[0m17:46:50.258757 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m17:46:50.260289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:46:50.260723 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.src_reviews' was properly closed.
[0m17:46:50.261219 [info ] [MainThread]: 
[0m17:46:50.261614 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m17:46:50.262628 [debug] [MainThread]: Command end result
[0m17:46:50.288330 [info ] [MainThread]: 
[0m17:46:50.288687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:46:50.288903 [info ] [MainThread]: 
[0m17:46:50.289126 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:46:50.290916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8389606, "process_user_time": 1.380918, "process_kernel_time": 0.240621, "process_mem_max_rss": "134168576", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:46:50.291370 [debug] [MainThread]: Command `dbt run` succeeded at 17:46:50.291300 after 6.84 seconds
[0m17:46:50.291642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064aede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc0fe0>]}
[0m17:46:50.291877 [debug] [MainThread]: Flushing usage events
[0m18:23:11.229350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcc230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108228d40>]}


============================== 18:23:11.232172 | 817416f0-0006-4602-a2ba-b7ac5c4b5afe ==============================
[0m18:23:11.232172 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:11.232494 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:23:11.455163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '817416f0-0006-4602-a2ba-b7ac5c4b5afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108768d40>]}
[0m18:23:11.478212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '817416f0-0006-4602-a2ba-b7ac5c4b5afe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b36090>]}
[0m18:23:11.478870 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:23:11.488577 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:23:11.540061 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:23:11.540402 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/dim/dim_lsitings_cleaned.sql
[0m18:23:11.613383 [error] [MainThread]: Encountered an error:
Compilation Error in model dim_lsitings_cleaned (models/dim/dim_lsitings_cleaned.sql)
  expected token ':', got '}'
    line 2
      SELECT * FROM {{({{ ref('src_listing') }})}}
[0m18:23:11.615063 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.41745695, "process_user_time": 0.836581, "process_kernel_time": 0.142236, "process_mem_max_rss": "120340480", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:23:11.615389 [debug] [MainThread]: Command `dbt run` failed at 18:23:11.615337 after 0.42 seconds
[0m18:23:11.615606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108228d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090a7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b2330>]}
[0m18:23:11.615778 [debug] [MainThread]: Flushing usage events
[0m18:23:27.295968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c72ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4cfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e4cd40>]}


============================== 18:23:27.298615 | bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b ==============================
[0m18:23:27.298615 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:23:27.298926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:23:27.505418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df4b00>]}
[0m18:23:27.529596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10576dfa0>]}
[0m18:23:27.531285 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:23:27.540345 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:23:27.581224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:23:27.581499 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:23:27.593804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e39be0>]}
[0m18:23:27.632648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e884a0>]}
[0m18:23:27.632924 [info ] [MainThread]: Found 4 models, 454 macros
[0m18:23:27.633103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106102690>]}
[0m18:23:27.634086 [info ] [MainThread]: 
[0m18:23:27.634362 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:23:27.636415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:23:27.643604 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:23:27.643824 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:23:27.643963 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:28.414810 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.771 seconds
[0m18:23:28.417971 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:23:28.556049 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:23:28.567234 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:23:28.567605 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:23:28.567882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:29.002953 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.435 seconds
[0m18:23:29.005562 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:23:29.163396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa61e0>]}
[0m18:23:29.164196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:23:29.164543 [info ] [MainThread]: 
[0m18:23:29.168326 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:23:29.168859 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:23:29.169270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:23:29.170004 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:23:29.176859 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:23:29.177684 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:23:29.199027 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:23:29.199860 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:23:29.200087 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:23:29.200292 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:29.900215 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.699 seconds
[0m18:23:29.927574 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:23:30.102951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0d3e30>]}
[0m18:23:30.104320 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.93s]
[0m18:23:30.105230 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:23:30.105864 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:23:30.106628 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listing .................................... [RUN]
[0m18:23:30.107235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:23:30.107659 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:23:30.110150 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:23:30.111176 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:23:30.114635 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:23:30.115775 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:23:30.116150 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:23:30.116688 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:30.820474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.704 seconds
[0m18:23:30.822092 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:23:30.972087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1cbe30>]}
[0m18:23:30.972985 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.86s]
[0m18:23:30.973689 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:23:30.974156 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:23:30.974753 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:23:30.975282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:23:30.975748 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:23:30.979350 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:23:30.980124 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:23:30.982876 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:23:30.983835 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:23:30.984177 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:23:30.984490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:31.641325 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.656 seconds
[0m18:23:31.647050 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:23:31.774798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d47d0>]}
[0m18:23:31.776911 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.80s]
[0m18:23:31.778106 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:23:31.778764 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:23:31.779552 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_lsitings_cleaned ........................... [RUN]
[0m18:23:31.780303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_lsitings_cleaned)
[0m18:23:31.780808 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:23:31.785393 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleaned"
[0m18:23:31.786713 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:23:31.790026 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleaned"
[0m18:23:31.791420 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleaned"
[0m18:23:31.791793 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleaned"} */
create or replace   view AIRBNB.DEV.dim_lsitings_cleaned
  
   as (
    WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        IF minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m18:23:31.792138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:32.276378 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7c8b3-0003-ecdc-0001-75d700035aae
[0m18:23:32.277101 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 13 at position 11 unexpected 'minimum_nights'.
syntax error line 13 at position 26 unexpected '='.
[0m18:23:32.277626 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleaned: Close
[0m18:23:32.416769 [debug] [Thread-1 (]: Database Error in model dim_lsitings_cleaned (models/dim/dim_lsitings_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 11 unexpected 'minimum_nights'.
  syntax error line 13 at position 26 unexpected '='.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_lsitings_cleaned.sql
[0m18:23:32.417383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf0d5a90-95ac-4bc2-af8e-ca942fb2fb1b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b4c80>]}
[0m18:23:32.418051 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model DEV.dim_lsitings_cleaned .................. [[31mERROR[0m in 0.64s]
[0m18:23:32.418591 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:23:32.420604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:32.420956 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleaned' was properly closed.
[0m18:23:32.421269 [info ] [MainThread]: 
[0m18:23:32.421546 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m18:23:32.422375 [debug] [MainThread]: Command end result
[0m18:23:32.441951 [info ] [MainThread]: 
[0m18:23:32.442253 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:23:32.442447 [info ] [MainThread]: 
[0m18:23:32.442683 [error] [MainThread]:   Database Error in model dim_lsitings_cleaned (models/dim/dim_lsitings_cleaned.sql)
  001003 (42000): SQL compilation error:
  syntax error line 13 at position 11 unexpected 'minimum_nights'.
  syntax error line 13 at position 26 unexpected '='.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_lsitings_cleaned.sql
[0m18:23:32.442870 [info ] [MainThread]: 
[0m18:23:32.443052 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m18:23:32.444499 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 5.1789274, "process_user_time": 1.346762, "process_kernel_time": 0.20144, "process_mem_max_rss": "134234112", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:23:32.445005 [debug] [MainThread]: Command `dbt run` failed at 18:23:32.444893 after 5.18 seconds
[0m18:23:32.445314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035cddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020b7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039f0410>]}
[0m18:23:32.445548 [debug] [MainThread]: Flushing usage events
[0m18:24:09.499998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10654c0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682ce90>]}


============================== 18:24:09.502555 | 9e02f448-1779-40f9-9f81-fc868be16278 ==============================
[0m18:24:09.502555 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:24:09.502868 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:09.710089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106840740>]}
[0m18:24:09.734285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105931e50>]}
[0m18:24:09.735869 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:24:09.746655 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:24:09.797801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:09.798060 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:09.809914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067d6a20>]}
[0m18:24:09.846692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076abd10>]}
[0m18:24:09.846946 [info ] [MainThread]: Found 4 models, 454 macros
[0m18:24:09.847114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076939b0>]}
[0m18:24:09.848082 [info ] [MainThread]: 
[0m18:24:09.848381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:09.850390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:24:09.857632 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:24:09.857859 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:24:09.858006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:10.506606 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.648 seconds
[0m18:24:10.511098 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:24:10.657667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:24:10.666964 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:24:10.667309 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:24:10.667561 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:24:11.170459 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.502 seconds
[0m18:24:11.174892 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:24:11.309787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743bfe0>]}
[0m18:24:11.310502 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:24:11.310885 [info ] [MainThread]: 
[0m18:24:11.313825 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:24:11.314414 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:24:11.314863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:24:11.315197 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:24:11.322111 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:24:11.323236 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:24:11.345505 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:24:11.346348 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:24:11.346588 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:24:11.346790 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:11.987443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m18:24:12.013650 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:24:12.150110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107345df0>]}
[0m18:24:12.152449 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.83s]
[0m18:24:12.153315 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:24:12.153856 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:24:12.154540 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listing .................................... [RUN]
[0m18:24:12.155181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:24:12.155597 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:24:12.157738 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:24:12.158710 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:24:12.162001 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:24:12.163398 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:24:12.163781 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:24:12.164117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:12.909445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.745 seconds
[0m18:24:12.914486 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:24:13.041193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107345df0>]}
[0m18:24:13.042094 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.89s]
[0m18:24:13.042812 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:24:13.043319 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:24:13.043939 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:24:13.044508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:24:13.044856 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:24:13.048352 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:24:13.049502 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:24:13.052235 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:24:13.053249 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:24:13.053571 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:24:13.053865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:13.678026 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m18:24:13.683829 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:24:13.814849 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077128d0>]}
[0m18:24:13.815911 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.77s]
[0m18:24:13.816922 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:24:13.817501 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:24:13.818158 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_lsitings_cleaned ........................... [RUN]
[0m18:24:13.818718 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_lsitings_cleaned)
[0m18:24:13.819081 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:24:13.822429 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleaned"
[0m18:24:13.823264 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:24:13.825766 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleaned"
[0m18:24:13.826730 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleaned"
[0m18:24:13.827056 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleaned: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleaned"} */
create or replace   view AIRBNB.DEV.dim_lsitings_cleaned
  
   as (
    WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m18:24:13.827350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:14.545948 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.718 seconds
[0m18:24:14.553274 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleaned: Close
[0m18:24:14.692783 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e02f448-1779-40f9-9f81-fc868be16278', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077127e0>]}
[0m18:24:14.694372 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_lsitings_cleaned ...................... [[32mSUCCESS 1[0m in 0.87s]
[0m18:24:14.695483 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleaned
[0m18:24:14.697349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:14.697815 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleaned' was properly closed.
[0m18:24:14.698325 [info ] [MainThread]: 
[0m18:24:14.698726 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 4.85 seconds (4.85s).
[0m18:24:14.700178 [debug] [MainThread]: Command end result
[0m18:24:14.727085 [info ] [MainThread]: 
[0m18:24:14.727505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:14.727738 [info ] [MainThread]: 
[0m18:24:14.727974 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:24:14.729503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.259773, "process_user_time": 1.343236, "process_kernel_time": 0.207677, "process_mem_max_rss": "132300800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:24:14.729967 [debug] [MainThread]: Command `dbt run` succeeded at 18:24:14.729890 after 5.26 seconds
[0m18:24:14.730254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105700dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062632f0>]}
[0m18:24:14.730494 [debug] [MainThread]: Flushing usage events
[0m18:30:39.778830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f7fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104642060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a50c20>]}


============================== 18:30:39.781472 | 77504b5e-9804-4050-bdd2-1b1b180b2411 ==============================
[0m18:30:39.781472 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:30:39.781921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:30:39.971185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105007d10>]}
[0m18:30:39.995718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a4b60>]}
[0m18:30:39.996212 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:30:40.005787 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:30:40.036540 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:30:40.036829 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m18:30:40.037051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bc4b00>]}
[0m18:30:40.527597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fee870>]}
[0m18:30:40.562024 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d4d370>]}
[0m18:30:40.562307 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:30:40.562476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab7bc0>]}
[0m18:30:40.563336 [info ] [MainThread]: 
[0m18:30:40.563774 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:30:40.564282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:30:40.571344 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:30:40.571554 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:30:40.571683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:41.230688 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.659 seconds
[0m18:30:41.232220 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:30:41.411666 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:30:41.422111 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:30:41.422576 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:30:41.422818 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:41.991085 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.568 seconds
[0m18:30:41.994235 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:30:42.137899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab7e90>]}
[0m18:30:42.138850 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:30:42.139474 [info ] [MainThread]: 
[0m18:30:42.143352 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:30:42.144074 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m18:30:42.144715 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:30:42.145199 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:30:42.152939 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:30:42.154049 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:30:42.175681 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:30:42.176512 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:30:42.176744 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous'),
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m18:30:42.176942 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:42.728636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7c8ba-0003-ecdc-0001-75d700035b0e
[0m18:30:42.729321 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m18:30:42.729829 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:30:42.879630 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_hosts_cleansed.sql
[0m18:30:42.881882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77504b5e-9804-4050-bdd2-1b1b180b2411', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a6990>]}
[0m18:30:42.882795 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model DEV.dim_hosts_cleansed .................... [[31mERROR[0m in 0.74s]
[0m18:30:42.883411 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:30:42.885520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:42.885926 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_hosts_cleansed' was properly closed.
[0m18:30:42.886253 [info ] [MainThread]: 
[0m18:30:42.886584 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m18:30:42.887495 [debug] [MainThread]: Command end result
[0m18:30:42.911100 [info ] [MainThread]: 
[0m18:30:42.911447 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:30:42.911656 [info ] [MainThread]: 
[0m18:30:42.911906 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_hosts_cleansed.sql
[0m18:30:42.912095 [info ] [MainThread]: 
[0m18:30:42.912292 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m18:30:42.914093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.1687262, "process_user_time": 1.59436, "process_kernel_time": 0.195106, "process_mem_max_rss": "137150464", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:30:42.914399 [debug] [MainThread]: Command `cli run` failed at 18:30:42.914344 after 3.17 seconds
[0m18:30:42.914627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104643440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b2240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105023500>]}
[0m18:30:42.914840 [debug] [MainThread]: Flushing usage events
[0m18:31:50.202377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105610ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105610c20>]}


============================== 18:31:50.204932 | f1d7f085-af30-47b8-8360-efc01f0110e6 ==============================
[0m18:31:50.204932 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:31:50.205241 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:31:50.412501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103941b50>]}
[0m18:31:50.435021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aecaa0>]}
[0m18:31:50.435659 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:31:50.444953 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:31:50.497481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:31:50.497744 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:31:50.510573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfee70>]}
[0m18:31:50.548245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de8230>]}
[0m18:31:50.548543 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:31:50.548717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3ef0>]}
[0m18:31:50.549730 [info ] [MainThread]: 
[0m18:31:50.550047 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:31:50.552152 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:31:50.559602 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:31:50.559847 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:31:50.559985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:31:51.258854 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.698 seconds
[0m18:31:51.263136 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:31:51.404488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:31:51.415484 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:31:51.415891 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:31:51.416187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:31:51.958751 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.542 seconds
[0m18:31:51.965710 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:31:52.105609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c69f0>]}
[0m18:31:52.106283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:31:52.106551 [info ] [MainThread]: 
[0m18:31:52.110234 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:31:52.110696 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:31:52.111044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:31:52.111295 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:31:52.117217 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:31:52.118092 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:31:52.136546 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:31:52.137188 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:31:52.137399 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:31:52.137581 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:52.895172 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m18:31:52.918936 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:31:53.049159 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f03e0>]}
[0m18:31:53.050160 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.94s]
[0m18:31:53.050870 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:31:53.051393 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:31:53.052039 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m18:31:53.052714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:31:53.053141 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:31:53.055347 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:31:53.056275 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:31:53.059583 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:31:53.060878 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:31:53.061262 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:31:53.061593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:53.918797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m18:31:53.920777 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:31:54.059651 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d0e90>]}
[0m18:31:54.060327 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.01s]
[0m18:31:54.060876 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:31:54.061263 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:31:54.061729 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:31:54.062232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:31:54.062507 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:31:54.065399 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:31:54.066230 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:31:54.068718 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:31:54.069722 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:31:54.069980 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:31:54.070195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:54.841140 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m18:31:54.847755 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:31:54.979889 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107142fc0>]}
[0m18:31:54.980888 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:31:54.981737 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:31:54.982326 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:31:54.983057 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m18:31:54.983681 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:31:54.984100 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:31:54.988291 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:31:54.990720 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:31:54.993632 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:31:54.994932 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:31:54.995368 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous'),
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m18:31:54.995686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:55.504648 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7c8bb-0004-039e-0001-75d7000361de
[0m18:31:55.505357 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m18:31:55.505952 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:31:55.646999 [debug] [Thread-1 (]: Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_hosts_cleansed.sql
[0m18:31:55.647684 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104563170>]}
[0m18:31:55.648483 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model DEV.dim_hosts_cleansed .................... [[31mERROR[0m in 0.66s]
[0m18:31:55.649165 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:31:55.649648 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:31:55.651010 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_lsitings_cleansed .......................... [RUN]
[0m18:31:55.651572 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m18:31:55.651972 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:31:55.655995 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:31:55.656938 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:31:55.659680 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:31:55.660747 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:31:55.661189 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_lsitings_cleansed
  
   as (
    WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m18:31:55.661498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:31:56.479161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.817 seconds
[0m18:31:56.486067 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m18:31:56.608204 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1d7f085-af30-47b8-8360-efc01f0110e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bffc20>]}
[0m18:31:56.609046 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_lsitings_cleansed ..................... [[32mSUCCESS 1[0m in 0.96s]
[0m18:31:56.609724 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:31:56.611257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:31:56.611667 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleansed' was properly closed.
[0m18:31:56.612140 [info ] [MainThread]: 
[0m18:31:56.612519 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m18:31:56.613691 [debug] [MainThread]: Command end result
[0m18:31:56.638802 [info ] [MainThread]: 
[0m18:31:56.639192 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:31:56.639414 [info ] [MainThread]: 
[0m18:31:56.639672 [error] [MainThread]:   Database Error in model dim_hosts_cleansed (models/dim/dim_hosts_cleansed.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_hosts_cleansed.sql
[0m18:31:56.639873 [info ] [MainThread]: 
[0m18:31:56.640086 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:31:56.641638 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 6.468731, "process_user_time": 1.428049, "process_kernel_time": 0.205217, "process_mem_max_rss": "135036928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:31:56.642084 [debug] [MainThread]: Command `dbt run` failed at 18:31:56.642016 after 6.47 seconds
[0m18:31:56.642374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104563170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7d010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516e360>]}
[0m18:31:56.642616 [debug] [MainThread]: Flushing usage events
[0m18:32:34.742765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ada480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d50fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d50c50>]}


============================== 18:32:34.745604 | 4a60f489-471e-48c7-9023-9ee7538618b6 ==============================
[0m18:32:34.745604 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:32:34.745937 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:32:34.963316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a982db0>]}
[0m18:32:34.987077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ef4a0>]}
[0m18:32:34.988510 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:32:34.997649 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m18:32:35.027889 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m18:32:35.028182 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m18:32:35.028397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b7260>]}
[0m18:32:35.512920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af794f0>]}
[0m18:32:35.550007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af7a450>]}
[0m18:32:35.550304 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:32:35.550475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b25edb0>]}
[0m18:32:35.551290 [info ] [MainThread]: 
[0m18:32:35.551631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:32:35.552091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:32:35.559129 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:32:35.559312 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:32:35.559442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:36.302148 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.743 seconds
[0m18:32:36.305093 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:32:36.466668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:32:36.476141 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:32:36.476542 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:32:36.476802 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:32:37.043303 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.566 seconds
[0m18:32:37.046510 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:32:37.187444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b243110>]}
[0m18:32:37.188428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:37.189188 [info ] [MainThread]: 
[0m18:32:37.193370 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:32:37.194122 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m18:32:37.194717 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:32:37.195167 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:32:37.203106 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:32:37.204255 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:32:37.225650 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:32:37.226484 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:32:37.226719 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m18:32:37.226929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:38.257768 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.031 seconds
[0m18:32:38.272824 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:32:38.401594 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a60f489-471e-48c7-9023-9ee7538618b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab7df70>]}
[0m18:32:38.402490 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.21s]
[0m18:32:38.403046 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:32:38.404442 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:38.404783 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_hosts_cleansed' was properly closed.
[0m18:32:38.405231 [info ] [MainThread]: 
[0m18:32:38.405661 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m18:32:38.406368 [debug] [MainThread]: Command end result
[0m18:32:38.426033 [info ] [MainThread]: 
[0m18:32:38.426425 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:32:38.426686 [info ] [MainThread]: 
[0m18:32:38.426884 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:32:38.428600 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.7183917, "process_user_time": 1.582947, "process_kernel_time": 0.195331, "process_mem_max_rss": "134905856", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:32:38.428969 [debug] [MainThread]: Command `cli run` succeeded at 18:32:38.428907 after 3.72 seconds
[0m18:32:38.429215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a96ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096871a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099a6960>]}
[0m18:32:38.429444 [debug] [MainThread]: Flushing usage events
[0m18:40:07.726204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086246b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889ccb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889c9b0>]}


============================== 18:40:07.729284 | 99148599-9e20-4bc4-9d92-ce6f3959496c ==============================
[0m18:40:07.729284 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:40:07.729630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt clean', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:40:07.803427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99148599-9e20-4bc4-9d92-ce6f3959496c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890bf50>]}
[0m18:40:07.815201 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12201746, "process_user_time": 0.621542, "process_kernel_time": 0.102727, "process_mem_max_rss": "93814784", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:07.815526 [debug] [MainThread]: Command `dbt clean` succeeded at 18:40:07.815466 after 0.12 seconds
[0m18:40:07.815726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ce180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108557410>]}
[0m18:40:07.815904 [debug] [MainThread]: Flushing usage events
[0m18:40:11.694096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100d04770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10490cf20>]}


============================== 18:40:11.696228 | 4f96b496-1771-47ce-9e1d-b9fd224444e4 ==============================
[0m18:40:11.696228 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:40:11.696538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:40:11.914968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103211b20>]}
[0m18:40:11.937525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d1ac0>]}
[0m18:40:11.938977 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:40:11.948855 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:40:11.949396 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:40:11.949595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a7620>]}
[0m18:40:12.432465 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dim
[0m18:40:12.435013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105820aa0>]}
[0m18:40:12.470630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056b0e30>]}
[0m18:40:12.470925 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:40:12.471088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103271250>]}
[0m18:40:12.472008 [info ] [MainThread]: 
[0m18:40:12.472299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:40:12.474564 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:40:12.481107 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:40:12.481293 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:40:12.481425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:40:13.172373 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.691 seconds
[0m18:40:13.175552 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:40:13.309869 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:40:13.322745 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:40:13.323148 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:40:13.323404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:40:13.838843 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.515 seconds
[0m18:40:13.841785 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:40:13.973220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e1e20>]}
[0m18:40:13.973636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:40:13.973813 [info ] [MainThread]: 
[0m18:40:13.975991 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:40:13.976289 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:40:13.976532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:40:13.976710 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:40:13.981311 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:40:13.982497 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:40:13.999095 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:40:14.000083 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:40:14.000281 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:40:14.000449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:14.934585 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.933 seconds
[0m18:40:14.960948 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:40:15.110662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105435dc0>]}
[0m18:40:15.111885 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.13s]
[0m18:40:15.113057 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:40:15.113645 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:40:15.114355 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m18:40:15.115239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:40:15.115908 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:40:15.118315 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:40:15.119324 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:40:15.122384 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:40:15.123563 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:40:15.123938 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:40:15.124276 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:15.785523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.660 seconds
[0m18:40:15.791030 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:40:15.947370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058682f0>]}
[0m18:40:15.949827 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.83s]
[0m18:40:15.951493 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:40:15.952187 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:40:15.953051 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:40:15.954116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:40:15.954759 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:40:15.959514 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:40:15.960815 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:40:15.964228 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:40:15.965706 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:40:15.966107 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:40:15.966449 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:16.603049 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m18:40:16.607225 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:40:16.732420 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b190a0>]}
[0m18:40:16.733493 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.78s]
[0m18:40:16.734351 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:40:16.734945 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:40:16.735647 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m18:40:16.736388 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:40:16.736895 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:40:16.741119 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:40:16.742490 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:40:16.745566 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:40:16.747348 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:40:16.747776 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m18:40:16.748107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:17.632341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.883 seconds
[0m18:40:17.637877 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:40:17.775734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b1be90>]}
[0m18:40:17.777297 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.04s]
[0m18:40:17.778351 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:40:17.778947 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:40:17.779608 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_lsitings_cleansed .......................... [RUN]
[0m18:40:17.780187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m18:40:17.780607 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:40:17.784927 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:40:17.786073 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:40:17.789032 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:40:17.790709 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:40:17.791095 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_lsitings_cleansed
  
   as (
    WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m18:40:17.791410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:40:18.557156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m18:40:18.561768 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m18:40:18.688300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f96b496-1771-47ce-9e1d-b9fd224444e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c6270>]}
[0m18:40:18.690414 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_lsitings_cleansed ..................... [[32mSUCCESS 1[0m in 0.91s]
[0m18:40:18.690980 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:40:18.692196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:40:18.692445 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleansed' was properly closed.
[0m18:40:18.692768 [info ] [MainThread]: 
[0m18:40:18.693028 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.22 seconds (6.22s).
[0m18:40:18.693864 [debug] [MainThread]: Command end result
[0m18:40:18.711691 [info ] [MainThread]: 
[0m18:40:18.712094 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:40:18.712334 [info ] [MainThread]: 
[0m18:40:18.712521 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:40:18.713554 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.0479074, "process_user_time": 1.830042, "process_kernel_time": 0.205458, "process_mem_max_rss": "135544832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:40:18.713876 [debug] [MainThread]: Command `dbt run` succeeded at 18:40:18.713827 after 7.05 seconds
[0m18:40:18.714091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104664bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b8acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058207d0>]}
[0m18:40:18.714287 [debug] [MainThread]: Flushing usage events
[0m18:41:15.250344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103676600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110414e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110414bc0>]}


============================== 18:41:15.252953 | b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780 ==============================
[0m18:41:15.252953 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:41:15.253256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:41:15.460686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f41b50>]}
[0m18:41:15.482870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1ba10>]}
[0m18:41:15.484271 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:41:15.493059 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:41:15.534453 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:41:15.534696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:41:15.537208 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dim
[0m18:41:15.546763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111287380>]}
[0m18:41:15.585871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111574320>]}
[0m18:41:15.586172 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:41:15.586337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11123a810>]}
[0m18:41:15.587370 [info ] [MainThread]: 
[0m18:41:15.587677 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:41:15.589794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:41:15.597054 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:41:15.597251 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:41:15.597383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:41:16.291168 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.694 seconds
[0m18:41:16.293663 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:41:16.418101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:41:16.423961 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:41:16.424188 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:41:16.424365 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:41:16.957670 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.533 seconds
[0m18:41:16.964844 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:41:17.132693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149da00>]}
[0m18:41:17.133501 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:41:17.133881 [info ] [MainThread]: 
[0m18:41:17.137979 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:41:17.138593 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:41:17.139051 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:41:17.139571 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:41:17.146840 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:41:17.147712 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:41:17.169174 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:41:17.169975 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:41:17.170211 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:41:17.170414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:17.839909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m18:41:17.857679 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:41:17.981306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111109d30>]}
[0m18:41:17.982199 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.84s]
[0m18:41:17.982919 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:41:17.983432 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:41:17.984065 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m18:41:17.984613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:41:17.985025 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:41:17.986896 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:41:17.987765 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:41:17.990914 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:41:17.992042 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:41:17.992367 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:41:17.992667 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:18.764775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m18:41:18.771037 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:41:18.901912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11248c4d0>]}
[0m18:41:18.902954 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:41:18.903794 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:41:18.904419 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:41:18.905156 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:41:18.905832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:41:18.906279 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:41:18.910321 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:41:18.911299 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:41:18.914162 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:41:18.915149 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:41:18.915494 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:41:18.916137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:19.789465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m18:41:19.794993 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:41:19.937803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aaefc0>]}
[0m18:41:19.939867 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.03s]
[0m18:41:19.940418 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:41:19.940765 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:41:19.941181 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m18:41:19.941593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:41:19.941848 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:41:19.944615 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:41:19.945387 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:41:19.947596 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:41:19.948380 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:41:19.948615 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m18:41:19.948826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:20.811389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.862 seconds
[0m18:41:20.818172 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:41:20.970321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11249be60>]}
[0m18:41:20.971225 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.03s]
[0m18:41:20.971893 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:41:20.972372 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:41:20.972960 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_lsitings_cleansed .......................... [RUN]
[0m18:41:20.973531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m18:41:20.973939 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:41:20.977763 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:41:20.978653 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:41:20.981465 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:41:20.982485 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:41:20.982951 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_lsitings_cleansed
  
   as (
    WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m18:41:20.983428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:41:21.834938 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m18:41:21.840056 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m18:41:21.994664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f2b076-cd4c-4ec8-9f2b-7cffeb0b7780', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112492630>]}
[0m18:41:21.996988 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_lsitings_cleansed ..................... [[32mSUCCESS 1[0m in 1.02s]
[0m18:41:21.998160 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:41:22.000400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:41:22.001033 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleansed' was properly closed.
[0m18:41:22.001619 [info ] [MainThread]: 
[0m18:41:22.002139 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.41 seconds (6.41s).
[0m18:41:22.003696 [debug] [MainThread]: Command end result
[0m18:41:22.032122 [info ] [MainThread]: 
[0m18:41:22.032672 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:41:22.032903 [info ] [MainThread]: 
[0m18:41:22.033148 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:41:22.035429 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.814388, "process_user_time": 1.38727, "process_kernel_time": 0.200754, "process_mem_max_rss": "133398528", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:41:22.035886 [debug] [MainThread]: Command `dbt run` succeeded at 18:41:22.035817 after 6.81 seconds
[0m18:41:22.036183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111fc500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103676600>]}
[0m18:41:22.036435 [debug] [MainThread]: Flushing usage events
[0m18:42:04.346049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041256a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc0c80>]}


============================== 18:42:04.348760 | 79b3181f-5edd-47d0-a6fe-0243161601d6 ==============================
[0m18:42:04.348760 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:42:04.349065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:42:04.593883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055926f0>]}
[0m18:42:04.618192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bef90>]}
[0m18:42:04.619763 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:42:04.628714 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:42:04.669785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:42:04.670049 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:42:04.682186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10500a3f0>]}
[0m18:42:04.719924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3fda0>]}
[0m18:42:04.720228 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:42:04.720405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105858560>]}
[0m18:42:04.721420 [info ] [MainThread]: 
[0m18:42:04.721731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:42:04.723821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:42:04.731665 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:42:04.731877 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:42:04.732016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:42:05.458930 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.727 seconds
[0m18:42:05.461708 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:42:05.610398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:42:05.618395 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:42:05.618682 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:42:05.618887 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:42:06.210340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.591 seconds
[0m18:42:06.215943 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:42:06.384116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3ffe0>]}
[0m18:42:06.384691 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:42:06.384986 [info ] [MainThread]: 
[0m18:42:06.388722 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:42:06.389223 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:42:06.389595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:42:06.389856 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:42:06.395946 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:42:06.396808 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:42:06.416435 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:42:06.417224 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:42:06.417438 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:42:06.417628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:07.060437 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m18:42:07.079572 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:42:07.213996 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d9fa0>]}
[0m18:42:07.214481 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.82s]
[0m18:42:07.214828 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:42:07.215080 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:42:07.215407 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m18:42:07.215728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:42:07.215916 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:42:07.216971 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:42:07.217421 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:42:07.219058 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:42:07.219635 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:42:07.219837 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:42:07.220017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:08.097576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.877 seconds
[0m18:42:08.101033 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:42:08.242822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da2b10>]}
[0m18:42:08.244121 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.03s]
[0m18:42:08.244976 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:42:08.245571 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:42:08.246297 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:42:08.246998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:42:08.247502 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:42:08.251559 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:42:08.252685 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:42:08.255610 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:42:08.256643 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:42:08.257239 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:42:08.258087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:09.044265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.786 seconds
[0m18:42:09.049323 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:42:09.177677 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c97c80>]}
[0m18:42:09.179693 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.93s]
[0m18:42:09.180458 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:42:09.180932 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:42:09.181455 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m18:42:09.181970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:42:09.182325 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:42:09.185646 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:42:09.186534 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:42:09.195387 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type view
[0m18:42:09.201023 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m18:42:09.206361 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:42:09.206807 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m18:42:09.207061 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:09.716028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m18:42:09.733028 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:42:09.734544 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:42:09.734893 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m18:42:11.218374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.483 seconds
[0m18:42:11.224127 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:42:11.362004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105da6ab0>]}
[0m18:42:11.362833 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.18s]
[0m18:42:11.363466 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:42:11.363926 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:42:11.364444 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_lsitings_cleansed ......................... [RUN]
[0m18:42:11.364947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m18:42:11.365264 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:42:11.368537 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:42:11.369455 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:42:11.371835 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LSITINGS_CLEANSED" because it is of type view
[0m18:42:11.373698 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LSITINGS_CLEANSED"
[0m18:42:11.374512 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:42:11.374931 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
drop view if exists "AIRBNB"."DEV"."DIM_LSITINGS_CLEANSED" cascade
[0m18:42:11.375213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:42:11.834033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.458 seconds
[0m18:42:11.839410 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:42:11.842135 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:42:11.842556 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_lsitings_cleansed
         as
        (WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
        );
[0m18:42:12.933239 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.090 seconds
[0m18:42:12.936927 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m18:42:13.099314 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79b3181f-5edd-47d0-a6fe-0243161601d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105deb200>]}
[0m18:42:13.099947 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_lsitings_cleansed .................... [[32mSUCCESS 1[0m in 1.73s]
[0m18:42:13.100410 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:42:13.101521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:42:13.101736 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleansed' was properly closed.
[0m18:42:13.102010 [info ] [MainThread]: 
[0m18:42:13.102220 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 8.38 seconds (8.38s).
[0m18:42:13.102937 [debug] [MainThread]: Command end result
[0m18:42:13.119352 [info ] [MainThread]: 
[0m18:42:13.119628 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:42:13.119808 [info ] [MainThread]: 
[0m18:42:13.119986 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:42:13.121461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.804952, "process_user_time": 1.450298, "process_kernel_time": 0.211949, "process_mem_max_rss": "134529024", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:42:13.121916 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:13.121859 after 8.81 seconds
[0m18:42:13.122152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc0c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055becc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f6a80>]}
[0m18:42:13.122369 [debug] [MainThread]: Flushing usage events
[0m18:27:03.090134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10252b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105110e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105110b90>]}


============================== 18:27:03.092958 | a85212d5-5793-413d-9ed1-915d147e48d4 ==============================
[0m18:27:03.092958 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:27:03.093285 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m18:27:03.164596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a85212d5-5793-413d-9ed1-915d147e48d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c6f7a0>]}
[0m18:27:03.190913 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.1338295, "process_user_time": 0.615085, "process_kernel_time": 0.111618, "process_mem_max_rss": "94371840", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:27:03.191340 [debug] [MainThread]: Command `dbt clean` succeeded at 18:27:03.191285 after 0.13 seconds
[0m18:27:03.191536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c3dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b44a0>]}
[0m18:27:03.191708 [debug] [MainThread]: Flushing usage events
[0m18:27:51.564151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bcd40>]}


============================== 18:27:51.566781 | 0bd22980-d618-47f6-b069-3f8683fe5c06 ==============================
[0m18:27:51.566781 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:27:51.567111 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:27:51.789018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050e36e0>]}
[0m18:27:51.812712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ebb3b0>]}
[0m18:27:51.813485 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:27:51.828654 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:27:51.829268 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:27:51.829513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053a53d0>]}
[0m18:27:52.317511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104554320>]}
[0m18:27:52.353617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546d7f0>]}
[0m18:27:52.353868 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:27:52.354031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105524950>]}
[0m18:27:52.354870 [info ] [MainThread]: 
[0m18:27:52.355134 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:27:52.357188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:27:52.363945 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:27:52.364161 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:27:52.364297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:53.315927 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.951 seconds
[0m18:27:53.318798 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:27:53.476827 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:27:53.487398 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:27:53.487762 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:27:53.488042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:54.051329 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.563 seconds
[0m18:27:54.055746 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:27:54.188283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105354380>]}
[0m18:27:54.189026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:27:54.189422 [info ] [MainThread]: 
[0m18:27:54.193507 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:27:54.194027 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:27:54.194448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:27:54.195330 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:27:54.202271 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:27:54.203682 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:27:54.225482 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:27:54.226498 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:27:54.226734 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:27:54.226931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:54.960511 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.733 seconds
[0m18:27:54.985168 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:27:55.119016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e5fd0>]}
[0m18:27:55.120058 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.92s]
[0m18:27:55.120755 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:27:55.121270 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:27:55.121966 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m18:27:55.122726 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:27:55.123260 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:27:55.125693 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:27:55.126944 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:27:55.130276 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:27:55.131564 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:27:55.131925 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:27:55.132256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:55.910827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.778 seconds
[0m18:27:55.916377 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:27:56.077004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a5e20>]}
[0m18:27:56.078028 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.95s]
[0m18:27:56.078874 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:27:56.079461 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:27:56.080050 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:27:56.080814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:27:56.081519 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:27:56.087915 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:27:56.088859 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:27:56.091950 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:27:56.092989 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:27:56.093338 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:27:56.093656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:56.804374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.710 seconds
[0m18:27:56.812046 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:27:56.944801 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a5c40>]}
[0m18:27:56.945827 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.86s]
[0m18:27:56.946525 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:27:56.946962 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:27:56.947479 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m18:27:56.948009 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:27:56.948369 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:27:56.951990 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:27:56.953223 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:27:56.971241 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:27:56.972476 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:27:56.972745 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m18:27:56.972974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:58.855644 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.882 seconds
[0m18:27:58.860443 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:27:58.993658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058a6b10>]}
[0m18:27:58.994799 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.05s]
[0m18:27:58.995610 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:27:58.996183 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:27:58.996910 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_lsitings_cleansed ......................... [RUN]
[0m18:27:58.997557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m18:27:58.997974 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:27:59.002047 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:27:59.002962 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:27:59.005591 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:27:59.006885 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:27:59.007467 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_lsitings_cleansed
         as
        (WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
        );
[0m18:27:59.008048 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:00.690017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.682 seconds
[0m18:28:00.691893 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m18:28:00.829625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bd22980-d618-47f6-b069-3f8683fe5c06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059cecf0>]}
[0m18:28:00.830359 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_lsitings_cleansed .................... [[32mSUCCESS 1[0m in 1.83s]
[0m18:28:00.830952 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:28:00.832302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:00.832592 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleansed' was properly closed.
[0m18:28:00.832963 [info ] [MainThread]: 
[0m18:28:00.833265 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m18:28:00.834331 [debug] [MainThread]: Command end result
[0m18:28:00.858153 [info ] [MainThread]: 
[0m18:28:00.858555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:00.858790 [info ] [MainThread]: 
[0m18:28:00.859000 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:28:00.860777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.327323, "process_user_time": 1.973621, "process_kernel_time": 0.2427, "process_mem_max_rss": "135856128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:28:00.861190 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:00.861130 after 9.33 seconds
[0m18:28:00.861424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bcfe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104774230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105613d70>]}
[0m18:28:00.861648 [debug] [MainThread]: Flushing usage events
[0m18:57:53.245795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027d87a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7cce0>]}


============================== 18:57:53.248827 | 72f7e7da-9afc-4266-9ae7-9a640330e2c5 ==============================
[0m18:57:53.248827 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:57:53.249157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:57:53.472577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044abec0>]}
[0m18:57:53.495643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10548fbf0>]}
[0m18:57:53.496250 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:57:53.505743 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:57:53.556587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:53.556861 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:53.568926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cf3e0>]}
[0m18:57:53.607165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059180e0>]}
[0m18:57:53.607449 [info ] [MainThread]: Found 5 models, 454 macros
[0m18:57:53.607617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ac230>]}
[0m18:57:53.608625 [info ] [MainThread]: 
[0m18:57:53.608927 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:57:53.611028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:57:53.618645 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:57:53.618849 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:57:53.618990 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:54.374456 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.755 seconds
[0m18:57:54.377700 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:57:54.521154 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m18:57:54.527117 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:57:54.527346 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m18:57:54.527520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:55.018632 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.491 seconds
[0m18:57:55.021731 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:57:55.161751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566aa80>]}
[0m18:57:55.162569 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:57:55.162970 [info ] [MainThread]: 
[0m18:57:55.166290 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m18:57:55.166923 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_hosts ...................................... [RUN]
[0m18:57:55.167580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m18:57:55.168185 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m18:57:55.176206 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m18:57:55.177387 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m18:57:55.199762 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m18:57:55.200568 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m18:57:55.200797 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m18:57:55.200994 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:55.870363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m18:57:55.895169 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m18:57:56.025565 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055aa150>]}
[0m18:57:56.026998 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.86s]
[0m18:57:56.027803 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m18:57:56.028346 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m18:57:56.029067 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m18:57:56.029779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m18:57:56.030172 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m18:57:56.032277 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m18:57:56.035005 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m18:57:56.038339 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m18:57:56.040119 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m18:57:56.040525 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m18:57:56.040899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:56.810970 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.769 seconds
[0m18:57:56.815218 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m18:57:56.949415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd08f0>]}
[0m18:57:56.949896 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:57:56.950227 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m18:57:56.950454 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m18:57:56.950732 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m18:57:56.951014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m18:57:56.951229 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m18:57:56.952954 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m18:57:56.953445 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m18:57:56.955005 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m18:57:56.955584 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m18:57:56.955767 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m18:57:56.955938 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:57.715824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.759 seconds
[0m18:57:57.722690 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m18:57:57.870583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fd2ba0>]}
[0m18:57:57.871607 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m18:57:57.872479 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m18:57:57.873069 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:57:57.873785 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m18:57:57.874470 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m18:57:57.874885 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:57:57.879068 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:57:57.880605 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:57:57.899955 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:57:57.901143 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m18:57:57.901574 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m18:57:57.901845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:57:59.802356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.900 seconds
[0m18:57:59.806679 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m18:57:59.939854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fdfd70>]}
[0m18:57:59.940870 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.07s]
[0m18:57:59.941691 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m18:57:59.942273 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:57:59.943005 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_lsitings_cleansed ......................... [RUN]
[0m18:57:59.943614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m18:57:59.944049 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:57:59.948241 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:57:59.949471 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:57:59.952309 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:57:59.953784 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m18:57:59.954320 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_lsitings_cleansed
         as
        (WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
        );
[0m18:57:59.954672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:01.651793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.697 seconds
[0m18:58:01.654635 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m18:58:01.797617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72f7e7da-9afc-4266-9ae7-9a640330e2c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c26b40>]}
[0m18:58:01.798926 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_lsitings_cleansed .................... [[32mSUCCESS 1[0m in 1.85s]
[0m18:58:01.799852 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m18:58:01.801517 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:01.802092 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_lsitings_cleansed' was properly closed.
[0m18:58:01.802565 [info ] [MainThread]: 
[0m18:58:01.803040 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 8.19 seconds (8.19s).
[0m18:58:01.804491 [debug] [MainThread]: Command end result
[0m18:58:01.829995 [info ] [MainThread]: 
[0m18:58:01.830345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:01.830551 [info ] [MainThread]: 
[0m18:58:01.830768 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:58:01.832671 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.621448, "process_user_time": 1.388666, "process_kernel_time": 0.207309, "process_mem_max_rss": "132612096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:58:01.833233 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:01.833159 after 8.62 seconds
[0m18:58:01.833531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a7cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10569c6e0>]}
[0m18:58:01.833785 [debug] [MainThread]: Flushing usage events
[0m19:41:34.290365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d8a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079815b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108814c20>]}


============================== 19:41:34.293698 | 857700fc-37e9-46d4-871d-929f4dd93c2d ==============================
[0m19:41:34.293698 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:34.294061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt ', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:41:34.529115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '857700fc-37e9-46d4-871d-929f4dd93c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091cb980>]}
[0m19:41:34.554334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '857700fc-37e9-46d4-871d-929f4dd93c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090824e0>]}
[0m19:41:34.555179 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:41:34.565124 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:41:34.597814 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:41:34.598103 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m19:41:34.598276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '857700fc-37e9-46d4-871d-929f4dd93c2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095f4e00>]}
[0m19:41:35.027568 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  invalid syntax for function call expression
    line 2
      config(
[0m19:41:35.029345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.77551126, "process_user_time": 1.216148, "process_kernel_time": 0.169552, "process_mem_max_rss": "123355136", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:35.029680 [debug] [MainThread]: Command `cli run` failed at 19:41:35.029626 after 0.78 seconds
[0m19:41:35.029926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108814f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109576030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10967d1c0>]}
[0m19:41:35.030131 [debug] [MainThread]: Flushing usage events
[0m19:41:57.358764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107337b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3ce00>]}


============================== 19:41:57.362419 | a5d434cf-b1bc-44b5-8c45-6fba7f10fbb5 ==============================
[0m19:41:57.362419 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:41:57.362988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m19:41:57.594563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5d434cf-b1bc-44b5-8c45-6fba7f10fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113430b0>]}
[0m19:41:57.619763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5d434cf-b1bc-44b5-8c45-6fba7f10fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e64830>]}
[0m19:41:57.621323 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:41:57.631795 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:41:57.663281 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:41:57.663577 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m19:41:57.663757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a5d434cf-b1bc-44b5-8c45-6fba7f10fbb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fc4e90>]}
[0m19:41:58.106257 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  Encountered unknown tag 'elseif'. Jinja was looking for the following tags: 'elif' or 'else' or 'endif'. The innermost block that needs to be closed is 'if'.
    line 16
      {% elseif %}
[0m19:41:58.108143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7839699, "process_user_time": 1.251755, "process_kernel_time": 0.178067, "process_mem_max_rss": "122830848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:41:58.108439 [debug] [MainThread]: Command `cli run` failed at 19:41:58.108389 after 0.78 seconds
[0m19:41:58.108667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e3c890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c3ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cfbe00>]}
[0m19:41:58.108851 [debug] [MainThread]: Flushing usage events
[0m19:42:30.719923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105243950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107441100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107440d70>]}


============================== 19:42:30.723174 | cd7672ca-a026-497b-8149-4247fd11b3d4 ==============================
[0m19:42:30.723174 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:42:30.723541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:42:30.946558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6fd10>]}
[0m19:42:30.971850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e79f40>]}
[0m19:42:30.972577 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:42:30.982147 [debug] [MainThread]: checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, vars: {}, profile: , target: dev, version: 1.8.7
[0m19:42:31.011836 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m19:42:31.012127 [debug] [MainThread]: previous checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25, current checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0
[0m19:42:31.012315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c4ec0>]}
[0m19:42:31.505444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579dd60>]}
[0m19:42:31.545668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11059e030>]}
[0m19:42:31.545989 [info ] [MainThread]: Found 6 models, 454 macros
[0m19:42:31.546175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110134ec0>]}
[0m19:42:31.547023 [info ] [MainThread]: 
[0m19:42:31.547393 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:42:31.547926 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:42:31.554559 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:42:31.554768 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:42:31.554899 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:42:32.558707 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.004 seconds
[0m19:42:32.560007 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:42:32.727895 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:42:32.738087 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:42:32.738358 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m19:42:32.738520 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:42:33.241116 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.502 seconds
[0m19:42:33.244332 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:42:33.390392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10741a7b0>]}
[0m19:42:33.391299 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:42:33.391710 [info ] [MainThread]: 
[0m19:42:33.395899 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m19:42:33.396652 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:42:33.397267 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.fct_reviews)
[0m19:42:33.397829 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m19:42:33.406717 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m19:42:33.408240 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m19:42:33.445622 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m19:42:33.446744 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m19:42:33.447052 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

        );
[0m19:42:33.447248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:42:37.519771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.072 seconds
[0m19:42:37.526461 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m19:42:37.531148 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m19:42:37.531427 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m19:42:37.831013 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.299 seconds
[0m19:42:37.854494 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m19:42:38.001086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd7672ca-a026-497b-8149-4247fd11b3d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110209d90>]}
[0m19:42:38.001903 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.60s]
[0m19:42:38.002442 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m19:42:38.003975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:42:38.004285 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fct_reviews' was properly closed.
[0m19:42:38.004528 [info ] [MainThread]: 
[0m19:42:38.004772 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m19:42:38.005631 [debug] [MainThread]: Command end result
[0m19:42:38.025464 [info ] [MainThread]: 
[0m19:42:38.025818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:42:38.026169 [info ] [MainThread]: 
[0m19:42:38.026400 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:42:38.028115 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.3411174, "process_user_time": 1.619698, "process_kernel_time": 0.201891, "process_mem_max_rss": "136855552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m19:42:38.028517 [debug] [MainThread]: Command `cli run` succeeded at 19:42:38.028436 after 7.34 seconds
[0m19:42:38.028862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074410d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111062e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2b620>]}
[0m19:42:38.029140 [debug] [MainThread]: Flushing usage events
[0m00:34:22.040249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fb8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070050a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107004dd0>]}


============================== 00:34:22.043310 | bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9 ==============================
[0m00:34:22.043310 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:34:22.043620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:22.268076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103d6bd0>]}
[0m00:34:22.290759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110617b60>]}
[0m00:34:22.291358 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:34:22.301052 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:34:22.331963 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m00:34:22.332262 [debug] [MainThread]: previous checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, current checksum: b72588a61004764de5b9a5a46159da2d5d1870e817a9a65ee379ab1be9083c25
[0m00:34:22.332443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109c0ef0>]}
[0m00:34:22.820302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b356d0>]}
[0m00:34:22.856314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11098ac60>]}
[0m00:34:22.856579 [info ] [MainThread]: Found 6 models, 454 macros
[0m00:34:22.856742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11091e5a0>]}
[0m00:34:22.857671 [info ] [MainThread]: 
[0m00:34:22.857964 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:22.860043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m00:34:22.866696 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m00:34:22.866931 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m00:34:22.867062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:23.748043 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.881 seconds
[0m00:34:23.750805 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m00:34:23.931545 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m00:34:23.938652 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m00:34:23.938935 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m00:34:23.939127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:24.417933 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.478 seconds
[0m00:34:24.422102 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m00:34:24.578738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b58bf0>]}
[0m00:34:24.579712 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:34:24.580205 [info ] [MainThread]: 
[0m00:34:24.584557 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m00:34:24.585264 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m00:34:24.585803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m00:34:24.586630 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m00:34:24.593466 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m00:34:24.594897 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m00:34:24.618686 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m00:34:24.619646 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m00:34:24.619914 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m00:34:24.620133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:25.299955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m00:34:25.322194 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m00:34:25.513091 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f8290>]}
[0m00:34:25.514305 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 0.93s]
[0m00:34:25.515263 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m00:34:25.515914 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m00:34:25.516727 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listing .................................... [RUN]
[0m00:34:25.517766 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m00:34:25.518361 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m00:34:25.520773 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m00:34:25.523167 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m00:34:25.526276 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m00:34:25.527343 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m00:34:25.527654 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m00:34:25.528114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:26.333143 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m00:34:26.335859 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m00:34:26.573924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158e2c30>]}
[0m00:34:26.574732 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.06s]
[0m00:34:26.575164 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m00:34:26.575481 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m00:34:26.575851 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m00:34:26.576237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m00:34:26.576831 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m00:34:26.581003 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m00:34:26.582019 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m00:34:26.585023 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m00:34:26.586001 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m00:34:26.586595 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m00:34:26.587059 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:27.242384 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m00:34:27.244134 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m00:34:27.396926 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1158d77a0>]}
[0m00:34:27.398157 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.82s]
[0m00:34:27.399027 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m00:34:27.399606 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:34:27.400148 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m00:34:27.401074 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m00:34:27.401894 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:34:27.406076 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m00:34:27.407079 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:34:27.426634 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m00:34:27.427671 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m00:34:27.427956 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m00:34:27.428211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:29.192014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.763 seconds
[0m00:34:29.195962 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m00:34:29.419893 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a2a3f0>]}
[0m00:34:29.421004 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.02s]
[0m00:34:29.421628 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:34:29.422065 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:34:29.422600 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_lsitings_cleansed ......................... [RUN]
[0m00:34:29.423211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m00:34:29.423636 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:34:29.430084 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m00:34:29.432712 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:34:29.435468 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m00:34:29.437764 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m00:34:29.438229 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_lsitings_cleansed
         as
        (WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
        );
[0m00:34:29.438587 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:30.942060 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m00:34:30.946899 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m00:34:31.108391 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115915e50>]}
[0m00:34:31.109473 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_lsitings_cleansed .................... [[32mSUCCESS 1[0m in 1.69s]
[0m00:34:31.110306 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:34:31.110865 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m00:34:31.111607 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m00:34:31.112228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_lsitings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m00:34:31.112659 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m00:34:31.119669 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m00:34:31.120712 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m00:34:31.148577 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:31.148908 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m00:34:31.149127 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:31.863490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m00:34:31.876137 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:31.876560 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m00:34:31.999749 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.122 seconds
[0m00:34:32.005550 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:32.006022 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m00:34:32.122227 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.115 seconds
[0m00:34:32.139547 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:32.139999 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m00:34:32.283793 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.143 seconds
[0m00:34:32.286938 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:32.287273 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m00:34:32.371752 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.084 seconds
[0m00:34:32.380420 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:34:32.395244 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m00:34:32.396240 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:32.396523 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m00:34:32.502526 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.106 seconds
[0m00:34:32.503126 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:32.503564 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m00:34:33.079859 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.576 seconds
[0m00:34:33.081463 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:33.082248 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m00:34:33.266025 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.183 seconds
[0m00:34:33.273462 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m00:34:33.278479 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:34:33.278799 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m00:34:33.417721 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m00:34:33.421056 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m00:34:33.576087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bfc5eb06-8aa6-4e15-93fc-bdf44ddb6de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a75220>]}
[0m00:34:33.577173 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.46s]
[0m00:34:33.577894 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m00:34:33.579500 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:33.579967 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fct_reviews' was properly closed.
[0m00:34:33.580359 [info ] [MainThread]: 
[0m00:34:33.580672 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 10.72 seconds (10.72s).
[0m00:34:33.581786 [debug] [MainThread]: Command end result
[0m00:34:33.607529 [info ] [MainThread]: 
[0m00:34:33.607931 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:33.608150 [info ] [MainThread]: 
[0m00:34:33.608384 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:34:33.610204 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.603194, "process_user_time": 2.065926, "process_kernel_time": 0.221534, "process_mem_max_rss": "137445376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:34:33.610562 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:33.610505 after 11.60 seconds
[0m00:34:33.610797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070051f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070050a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107005040>]}
[0m00:34:33.611016 [debug] [MainThread]: Flushing usage events
[0m00:44:39.560234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105838fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105838d10>]}


============================== 00:44:39.563113 | a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3 ==============================
[0m00:44:39.563113 [info ] [MainThread]: Running with dbt=1.8.7
[0m00:44:39.563439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:44:39.786165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ea6f0>]}
[0m00:44:39.808651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657b320>]}
[0m00:44:39.809234 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m00:44:39.819343 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m00:44:39.874555 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:44:39.874806 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:44:39.886627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106697200>]}
[0m00:44:39.924781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106694e30>]}
[0m00:44:39.925063 [info ] [MainThread]: Found 6 models, 454 macros
[0m00:44:39.925244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106638530>]}
[0m00:44:39.926320 [info ] [MainThread]: 
[0m00:44:39.926650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:44:39.928857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m00:44:39.936408 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m00:44:39.936659 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m00:44:39.936805 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:40.762396 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.825 seconds
[0m00:44:40.766280 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m00:44:40.927063 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m00:44:40.938806 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m00:44:40.939210 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m00:44:40.939502 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:44:41.454638 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.515 seconds
[0m00:44:41.456493 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m00:44:41.585444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ca9f0>]}
[0m00:44:41.586201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:44:41.586591 [info ] [MainThread]: 
[0m00:44:41.590673 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m00:44:41.591205 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.src_hosts ...................................... [RUN]
[0m00:44:41.591621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m00:44:41.592308 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m00:44:41.598967 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m00:44:41.600354 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_hosts
[0m00:44:41.622212 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_hosts"
[0m00:44:41.623018 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_hosts"
[0m00:44:41.623259 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_hosts"} */
create or replace   view AIRBNB.DEV.src_hosts
  
   as (
    WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
  );
[0m00:44:41.623463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:42.480944 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m00:44:42.508610 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_hosts: Close
[0m00:44:42.658519 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065caa50>]}
[0m00:44:42.659599 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.src_hosts ................................. [[32mSUCCESS 1[0m in 1.07s]
[0m00:44:42.660339 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m00:44:42.660869 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m00:44:42.661516 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listing .................................... [RUN]
[0m00:44:42.662162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m00:44:42.662587 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m00:44:42.664696 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m00:44:42.665656 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_listing
[0m00:44:42.668739 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_listing"
[0m00:44:42.670015 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_listing"
[0m00:44:42.670350 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
  );
[0m00:44:42.670647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:43.402150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.731 seconds
[0m00:44:43.409559 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_listing: Close
[0m00:44:43.573196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141c7380>]}
[0m00:44:43.574901 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m00:44:43.576586 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m00:44:43.577269 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m00:44:43.577970 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m00:44:43.578673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m00:44:43.579084 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m00:44:43.583286 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m00:44:43.584263 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m00:44:43.587170 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m00:44:43.588893 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m00:44:43.589270 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m00:44:43.589555 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:44.219488 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m00:44:44.226824 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m00:44:44.370132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140ddfd0>]}
[0m00:44:44.371180 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.79s]
[0m00:44:44.372011 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m00:44:44.372543 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:44:44.373106 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m00:44:44.373786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m00:44:44.374332 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:44:44.378125 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m00:44:44.379083 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:44:44.398382 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m00:44:44.399558 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m00:44:44.399855 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH src_hosts AS(
    SELECT * FROM AIRBNB.DEV.src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m00:44:44.400121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:45.777175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.377 seconds
[0m00:44:45.781576 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m00:44:45.930266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11407bd40>]}
[0m00:44:45.931165 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 1.56s]
[0m00:44:45.931867 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m00:44:45.932358 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:44:45.932921 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_lsitings_cleansed ......................... [RUN]
[0m00:44:45.933424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_lsitings_cleansed)
[0m00:44:45.933776 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:44:45.937495 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m00:44:45.938315 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:44:45.940957 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m00:44:45.941961 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_lsitings_cleansed"
[0m00:44:45.942271 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_lsitings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_lsitings_cleansed
         as
        (WITH dim_listings AS(
    SELECT * FROM AIRBNB.DEV.src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
        );
[0m00:44:45.942552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:47.294531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.351 seconds
[0m00:44:47.297791 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_lsitings_cleansed: Close
[0m00:44:47.450274 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140bd9a0>]}
[0m00:44:47.451955 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_lsitings_cleansed .................... [[32mSUCCESS 1[0m in 1.52s]
[0m00:44:47.452596 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_lsitings_cleansed
[0m00:44:47.452981 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m00:44:47.453417 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m00:44:47.453829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_lsitings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m00:44:47.454092 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m00:44:47.461402 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m00:44:47.461996 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m00:44:47.483454 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:47.483792 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m00:44:47.483979 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:44:48.155730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m00:44:48.168989 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.169436 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m00:44:48.253671 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.084 seconds
[0m00:44:48.257855 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.258290 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m00:44:48.350470 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.091 seconds
[0m00:44:48.366121 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.366583 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m00:44:48.489199 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.121 seconds
[0m00:44:48.494932 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.495581 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m00:44:48.582693 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.086 seconds
[0m00:44:48.594882 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m00:44:48.608724 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.609832 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.610126 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m00:44:48.750368 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.139 seconds
[0m00:44:48.752052 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:48.753142 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m00:44:49.238598 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.484 seconds
[0m00:44:49.240627 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:49.241580 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m00:44:49.565740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.323 seconds
[0m00:44:49.577919 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m00:44:49.584934 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m00:44:49.585309 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m00:44:49.743742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.158 seconds
[0m00:44:49.746967 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m00:44:49.880242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7497e2c-21c7-4ee2-a203-6d3c0f21a4a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1140b37a0>]}
[0m00:44:49.880763 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.43s]
[0m00:44:49.881115 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m00:44:49.882142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:49.882317 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fct_reviews' was properly closed.
[0m00:44:49.882519 [info ] [MainThread]: 
[0m00:44:49.882681 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 9.96 seconds (9.96s).
[0m00:44:49.883287 [debug] [MainThread]: Command end result
[0m00:44:49.932204 [info ] [MainThread]: 
[0m00:44:49.932500 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:49.932667 [info ] [MainThread]: 
[0m00:44:49.932839 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:44:49.934294 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.406895, "process_user_time": 1.676864, "process_kernel_time": 0.210124, "process_mem_max_rss": "134627328", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:44:49.934596 [debug] [MainThread]: Command `dbt run` succeeded at 00:44:49.934544 after 10.41 seconds
[0m00:44:49.934816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105642c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a7020>]}
[0m00:44:49.935008 [debug] [MainThread]: Flushing usage events
[0m01:11:00.784411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10607c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e10f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e10c80>]}


============================== 01:11:00.787382 | fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f ==============================
[0m01:11:00.787382 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:11:00.787718 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:11:01.012589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105853590>]}
[0m01:11:01.035278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c45730>]}
[0m01:11:01.035898 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:11:01.046035 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:11:01.097320 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m01:11:01.097639 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://models/dim/dim_listings_cleansed.sql
[0m01:11:01.097784 [debug] [MainThread]: Partial parsing: deleted file: AIRBNB_DBT://models/dim/dim_lsitings_cleansed.sql
[0m01:11:01.186308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b1910>]}
[0m01:11:01.233633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b3980>]}
[0m01:11:01.233943 [info ] [MainThread]: Found 6 models, 454 macros
[0m01:11:01.234121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11051e690>]}
[0m01:11:01.235296 [info ] [MainThread]: 
[0m01:11:01.235696 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:11:01.238574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:11:01.245681 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:11:01.245893 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:11:01.246029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:11:02.084145 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.838 seconds
[0m01:11:02.086927 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:11:02.239674 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:11:02.247519 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:11:02.247838 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:11:02.248056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:11:02.826130 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.578 seconds
[0m01:11:02.829743 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:11:02.970679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11077d7c0>]}
[0m01:11:02.971626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:11:02.972202 [info ] [MainThread]: 
[0m01:11:02.976715 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:11:02.977346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:11:02.977728 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:11:02.985264 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:11:02.986870 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:11:02.987234 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:11:02.987699 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:11:02.988174 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:11:02.991444 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:11:02.992326 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:11:02.992662 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:11:02.993278 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m01:11:02.993850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:11:02.994102 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:11:02.996209 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:11:02.996659 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m01:11:03.016340 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m01:11:03.017474 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m01:11:03.017816 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m01:11:03.018036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:03.875656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.858 seconds
[0m01:11:03.894827 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m01:11:04.042182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11017de50>]}
[0m01:11:04.043406 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.05s]
[0m01:11:04.044152 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:11:04.044652 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:11:04.045339 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_hosts_cleansed ............................ [RUN]
[0m01:11:04.045822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:11:04.046187 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:11:04.052043 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:11:04.053119 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:11:04.072088 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:11:04.073125 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:11:04.073393 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_hosts_cleansed
         as
        (WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
        );
[0m01:11:04.073628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:06.017760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.944 seconds
[0m01:11:06.020827 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:11:06.177423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405d700>]}
[0m01:11:06.178396 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_hosts_cleansed ....................... [[32mSUCCESS 1[0m in 2.13s]
[0m01:11:06.179585 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:11:06.180277 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:11:06.180931 [info ] [Thread-1 (]: 3 of 4 START sql table model DEV.dim_listings_cleansed ......................... [RUN]
[0m01:11:06.181670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:11:06.182145 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:11:06.188291 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:11:06.189239 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:11:06.191777 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:11:06.193576 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:11:06.193935 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace transient table AIRBNB.DEV.dim_listings_cleansed
         as
        (WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
        );
[0m01:11:06.194249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:07.783297 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m01:11:07.788582 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:11:07.943329 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b4530>]}
[0m01:11:07.944686 [info ] [Thread-1 (]: 3 of 4 OK created sql table model DEV.dim_listings_cleansed .................... [[32mSUCCESS 1[0m in 1.76s]
[0m01:11:07.945511 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:11:07.946082 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:11:07.946929 [info ] [Thread-1 (]: 4 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:11:07.947757 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:11:07.948191 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:11:07.961448 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:11:07.963686 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:11:08.040003 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:08.040303 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:11:08.040472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:11:08.793039 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m01:11:08.806893 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:08.807388 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:11:08.927683 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.120 seconds
[0m01:11:08.936599 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:08.937216 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:11:09.054205 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.116 seconds
[0m01:11:09.070986 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:09.071477 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:11:09.158826 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.087 seconds
[0m01:11:09.164347 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:09.164971 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:11:09.258540 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.093 seconds
[0m01:11:09.265485 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:11:09.274390 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:11:09.274973 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:09.275151 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:11:09.450718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m01:11:09.451405 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:09.451969 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:11:09.818731 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.366 seconds
[0m01:11:09.820008 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:09.820604 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:11:10.124805 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.303 seconds
[0m01:11:10.138534 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:11:10.145238 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:11:10.145571 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:11:10.282285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m01:11:10.287535 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:11:10.477814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfa7b30-04f2-4254-bb4b-13cd5c9f4c4f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100bcede0>]}
[0m01:11:10.478454 [info ] [Thread-1 (]: 4 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.53s]
[0m01:11:10.478911 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:11:10.479780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:11:10.479998 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fct_reviews' was properly closed.
[0m01:11:10.480261 [info ] [MainThread]: 
[0m01:11:10.480485 [info ] [MainThread]: Finished running 1 view model, 2 table models, 1 incremental model in 0 hours 0 minutes and 9.24 seconds (9.24s).
[0m01:11:10.481310 [debug] [MainThread]: Command end result
[0m01:11:10.507591 [info ] [MainThread]: 
[0m01:11:10.507952 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:11:10.508168 [info ] [MainThread]: 
[0m01:11:10.508444 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:11:10.510483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.759421, "process_user_time": 1.599427, "process_kernel_time": 0.239811, "process_mem_max_rss": "137969664", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:11:10.511004 [debug] [MainThread]: Command `dbt run` succeeded at 01:11:10.510932 after 9.76 seconds
[0m01:11:10.511274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e13b30>]}
[0m01:11:10.511529 [debug] [MainThread]: Flushing usage events
[0m01:25:48.763580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a007a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4bc0>]}


============================== 01:25:48.766588 | d0bc7025-6b76-487c-8fe0-026ccba618b9 ==============================
[0m01:25:48.766588 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:25:48.766901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:25:48.991922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4d40>]}
[0m01:25:49.015014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059c97f0>]}
[0m01:25:49.015631 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:25:49.024555 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:25:49.064608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:49.064889 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:49.076935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703aa80>]}
[0m01:25:49.117126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107280320>]}
[0m01:25:49.117429 [info ] [MainThread]: Found 7 models, 454 macros
[0m01:25:49.117598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725a030>]}
[0m01:25:49.118556 [info ] [MainThread]: 
[0m01:25:49.118859 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:49.120929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:25:49.128849 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:25:49.129050 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:25:49.129190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:49.994605 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.865 seconds
[0m01:25:49.995987 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:25:50.147706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:25:50.157814 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:25:50.158161 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:25:50.158404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:25:50.717835 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.559 seconds
[0m01:25:50.720994 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:25:50.905281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e2720>]}
[0m01:25:50.906159 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:25:50.906541 [info ] [MainThread]: 
[0m01:25:50.910820 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:25:50.911336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:25:50.911723 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:25:50.919623 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:25:50.921684 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:25:50.922118 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:25:50.922439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:25:50.922764 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:25:50.924542 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:25:50.925783 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:25:50.926165 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:25:50.926732 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m01:25:50.927292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:25:50.927600 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:25:50.930131 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:25:50.931061 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m01:25:50.951109 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m01:25:50.952186 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m01:25:50.952497 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m01:25:50.952709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:51.708627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m01:25:51.740336 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m01:25:51.901723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059983b0>]}
[0m01:25:51.902249 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.97s]
[0m01:25:51.902624 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:25:51.902876 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:25:51.903203 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m01:25:51.903551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:25:51.903756 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:25:51.906795 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:25:51.908364 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:25:51.913348 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" because it is of type table
[0m01:25:51.917002 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED"
[0m01:25:51.921123 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:25:51.921425 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_HOSTS_CLEANSED" cascade
[0m01:25:51.921607 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:52.404629 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.482 seconds
[0m01:25:52.408198 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:25:52.410335 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:25:52.410803 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m01:25:52.832448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.421 seconds
[0m01:25:52.835309 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:25:52.970876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dfd490>]}
[0m01:25:52.971866 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.07s]
[0m01:25:52.972563 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:25:52.973039 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:25:52.973640 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m01:25:52.974193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:25:52.974599 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:25:52.982060 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:25:52.983187 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:25:52.986109 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" because it is of type table
[0m01:25:52.988219 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED"
[0m01:25:52.989097 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:25:52.989389 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
drop table if exists "AIRBNB"."DEV"."DIM_LISTINGS_CLEANSED" cascade
[0m01:25:52.989668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:53.652742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.662 seconds
[0m01:25:53.655979 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:25:53.658056 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:25:53.658473 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m01:25:54.164687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m01:25:54.176785 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:25:54.321989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3380>]}
[0m01:25:54.322971 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.35s]
[0m01:25:54.323694 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:25:54.324195 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:25:54.324684 [info ] [Thread-1 (]: 4 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:25:54.325190 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:25:54.325582 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:25:54.334024 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:25:54.335828 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:25:54.362041 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:54.362346 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:25:54.362559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:55.006491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m01:25:55.019821 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.020399 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:25:55.135534 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.114 seconds
[0m01:25:55.144423 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.144902 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:25:55.236336 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.091 seconds
[0m01:25:55.251678 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.251989 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:25:55.376823 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.124 seconds
[0m01:25:55.381606 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.382042 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:25:55.488053 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.105 seconds
[0m01:25:55.500110 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:25:55.513784 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.516199 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.516467 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:25:55.699858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.182 seconds
[0m01:25:55.701684 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.702763 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:25:55.921283 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.218 seconds
[0m01:25:55.923178 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:55.924125 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:25:56.095139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m01:25:56.106888 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:25:56.110541 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:25:56.110925 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:25:56.218367 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.107 seconds
[0m01:25:56.225137 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:25:56.359087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10838fe60>]}
[0m01:25:56.360224 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.03s]
[0m01:25:56.361100 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:25:56.361733 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:25:56.362486 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_with_hosts ........................ [RUN]
[0m01:25:56.363135 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m01:25:56.363558 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:25:56.367650 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:25:56.368855 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:25:56.371814 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:25:56.373496 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:25:56.374039 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace   view AIRBNB.DEV.dim_listings_with_hosts
  
   as (
    WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
)
WITH h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)

SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON l.host_id = h.host_id
  );
[0m01:25:56.374411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:25:56.863424 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7cff9-0004-039e-0001-75d700036786
[0m01:25:56.863723 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'WITH'.
syntax error line 11 at position 0 unexpected 'SELECT'.
[0m01:25:56.863971 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m01:25:57.008236 [debug] [Thread-1 (]: Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'WITH'.
  syntax error line 11 at position 0 unexpected 'SELECT'.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_listings_with_hosts.sql
[0m01:25:57.008777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0bc7025-6b76-487c-8fe0-026ccba618b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072de3c0>]}
[0m01:25:57.009394 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model DEV.dim_listings_with_hosts ............... [[31mERROR[0m in 0.65s]
[0m01:25:57.009920 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:25:57.011748 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:57.012030 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m01:25:57.012351 [info ] [MainThread]: 
[0m01:25:57.012629 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.89 seconds (7.89s).
[0m01:25:57.013539 [debug] [MainThread]: Command end result
[0m01:25:57.074707 [info ] [MainThread]: 
[0m01:25:57.074961 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:25:57.075105 [info ] [MainThread]: 
[0m01:25:57.075282 [error] [MainThread]:   Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'WITH'.
  syntax error line 11 at position 0 unexpected 'SELECT'.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_listings_with_hosts.sql
[0m01:25:57.075417 [info ] [MainThread]: 
[0m01:25:57.075559 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m01:25:57.076846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.343718, "process_user_time": 1.638246, "process_kernel_time": 0.215506, "process_mem_max_rss": "135020544", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:25:57.077193 [debug] [MainThread]: Command `dbt run` failed at 01:25:57.077142 after 8.34 seconds
[0m01:25:57.077391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103687410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f86360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f878f0>]}
[0m01:25:57.077562 [debug] [MainThread]: Flushing usage events
[0m01:28:06.515668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106110f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106110cb0>]}


============================== 01:28:06.518273 | 7bda3b35-2761-46c1-a061-ff35535b25ba ==============================
[0m01:28:06.518273 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:28:06.518600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:28:06.726263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060db590>]}
[0m01:28:06.749461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106110b90>]}
[0m01:28:06.750283 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:28:06.759134 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:28:06.802519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:28:06.802792 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:28:06.814920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6f680>]}
[0m01:28:06.852845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107775220>]}
[0m01:28:06.853152 [info ] [MainThread]: Found 7 models, 454 macros
[0m01:28:06.853337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b77e30>]}
[0m01:28:06.854297 [info ] [MainThread]: 
[0m01:28:06.854596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:28:06.856681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:28:06.864009 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:28:06.864207 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:28:06.864352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:07.693669 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.829 seconds
[0m01:28:07.696257 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:28:07.870290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:28:07.879042 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:28:07.879351 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:28:07.879577 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:08.407048 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.527 seconds
[0m01:28:08.414117 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:28:08.557946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076eda90>]}
[0m01:28:08.558831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:28:08.559296 [info ] [MainThread]: 
[0m01:28:08.563553 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:28:08.564087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:28:08.564502 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:28:08.572483 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:28:08.574328 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:28:08.574793 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:28:08.575444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:28:08.576016 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:28:08.578011 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:28:08.579200 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:28:08.579596 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:28:08.580160 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m01:28:08.580736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:28:08.581009 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:28:08.583456 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:28:08.584035 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m01:28:08.604389 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m01:28:08.605144 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m01:28:08.605375 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m01:28:08.605578 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:09.336245 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.730 seconds
[0m01:28:09.362085 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m01:28:09.548591 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107681d00>]}
[0m01:28:09.549325 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.97s]
[0m01:28:09.549879 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:28:09.550269 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:28:09.550785 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m01:28:09.551360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:28:09.551758 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:28:09.558254 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:28:09.559108 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:28:09.562766 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:28:09.563837 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:28:09.564110 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m01:28:09.564335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:10.870490 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m01:28:10.877203 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:28:11.018112 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081152e0>]}
[0m01:28:11.019543 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.47s]
[0m01:28:11.020442 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:28:11.021067 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:28:11.021869 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m01:28:11.022593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:28:11.023097 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:28:11.030906 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:28:11.031876 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:28:11.034778 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:28:11.036235 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:28:11.036575 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m01:28:11.036874 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:11.896745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.859 seconds
[0m01:28:11.901627 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:28:12.034517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080f4710>]}
[0m01:28:12.036920 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.01s]
[0m01:28:12.038048 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:28:12.038669 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:28:12.039422 [info ] [Thread-1 (]: 4 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:28:12.040162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:28:12.040619 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:28:12.051239 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:28:12.052422 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:28:12.078846 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:12.079212 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:28:12.079438 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:12.782395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.702 seconds
[0m01:28:12.796003 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:12.796516 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:28:12.970981 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.174 seconds
[0m01:28:12.978703 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:12.979200 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:28:13.192805 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.213 seconds
[0m01:28:13.208789 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:13.209174 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:28:13.299157 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.090 seconds
[0m01:28:13.303946 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:13.304377 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:28:13.439861 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.135 seconds
[0m01:28:13.451897 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:28:13.461585 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:28:13.462217 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:13.462432 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:28:13.717632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.254 seconds
[0m01:28:13.719419 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:13.720448 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:28:14.148828 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.427 seconds
[0m01:28:14.150858 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:14.151829 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:28:14.289728 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.137 seconds
[0m01:28:14.303153 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:28:14.307772 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:28:14.308043 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:28:14.453302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.145 seconds
[0m01:28:14.460076 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:28:14.598560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b5670>]}
[0m01:28:14.599572 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.56s]
[0m01:28:14.600402 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:28:14.600994 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:28:14.601626 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_with_hosts ........................ [RUN]
[0m01:28:14.602230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m01:28:14.602667 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:28:14.606722 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:28:14.607964 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:28:14.610945 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:28:14.612581 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:28:14.613054 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace   view AIRBNB.DEV.dim_listings_with_hosts
  
   as (
    WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
)
WITH h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON l.host_id = h.host_id
  );
[0m01:28:14.613352 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:15.049164 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7cffc-0003-ecdc-0001-75d700039352
[0m01:28:15.049847 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'WITH'.
syntax error line 10 at position 0 unexpected 'SELECT'.
[0m01:28:15.050459 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m01:28:15.212899 [debug] [Thread-1 (]: Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'WITH'.
  syntax error line 10 at position 0 unexpected 'SELECT'.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_listings_with_hosts.sql
[0m01:28:15.213509 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7bda3b35-2761-46c1-a061-ff35535b25ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f13d0>]}
[0m01:28:15.214226 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model DEV.dim_listings_with_hosts ............... [[31mERROR[0m in 0.61s]
[0m01:28:15.214829 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:28:15.216830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:15.217105 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m01:28:15.217433 [info ] [MainThread]: 
[0m01:28:15.217708 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 8.36 seconds (8.36s).
[0m01:28:15.218672 [debug] [MainThread]: Command end result
[0m01:28:15.273074 [info ] [MainThread]: 
[0m01:28:15.273360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:28:15.273517 [info ] [MainThread]: 
[0m01:28:15.273851 [error] [MainThread]:   Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'WITH'.
  syntax error line 10 at position 0 unexpected 'SELECT'.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_listings_with_hosts.sql
[0m01:28:15.274030 [info ] [MainThread]: 
[0m01:28:15.274190 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m01:28:15.275599 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 8.789491, "process_user_time": 1.645278, "process_kernel_time": 0.221073, "process_mem_max_rss": "135168000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:28:15.275961 [debug] [MainThread]: Command `dbt run` failed at 01:28:15.275908 after 8.79 seconds
[0m01:28:15.276182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101f8eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c05fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108117fb0>]}
[0m01:28:15.276376 [debug] [MainThread]: Flushing usage events
[0m01:30:59.523841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe2000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119350ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119350c50>]}


============================== 01:30:59.526479 | 631a3df6-274a-4b15-b2ef-adadf881b4b4 ==============================
[0m01:30:59.526479 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:30:59.526781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:30:59.735926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119f30f80>]}
[0m01:30:59.759552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119ca0260>]}
[0m01:30:59.760294 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:30:59.770240 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:30:59.811504 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:59.811760 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:59.823814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a13ca10>]}
[0m01:30:59.862257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3f4cb0>]}
[0m01:30:59.862575 [info ] [MainThread]: Found 7 models, 454 macros
[0m01:30:59.862751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a227170>]}
[0m01:30:59.863705 [info ] [MainThread]: 
[0m01:30:59.863995 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:30:59.866082 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:30:59.873764 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:30:59.873962 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:30:59.874102 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:31:00.657644 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.783 seconds
[0m01:31:00.663727 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:31:00.817739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:31:00.826984 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:31:00.827281 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:31:00.827512 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:31:01.316171 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.488 seconds
[0m01:31:01.320206 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:31:01.487046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a0ca630>]}
[0m01:31:01.487719 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:31:01.488060 [info ] [MainThread]: 
[0m01:31:01.492009 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:31:01.492459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:31:01.492757 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:31:01.499473 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:31:01.500754 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:31:01.501084 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:31:01.501508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:31:01.501945 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:31:01.503494 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:31:01.504199 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:31:01.504494 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:31:01.505031 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m01:31:01.505445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:31:01.505693 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:31:01.507802 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:31:01.508270 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m01:31:01.527108 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m01:31:01.527877 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m01:31:01.528103 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m01:31:01.528285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:02.264525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m01:31:02.291297 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m01:31:02.419720 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a07e0f0>]}
[0m01:31:02.420837 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m01:31:02.421652 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:31:02.422151 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:31:02.422763 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m01:31:02.423385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:31:02.423888 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:31:02.431501 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:31:02.432488 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:31:02.436927 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:31:02.438045 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:31:02.438377 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m01:31:02.438671 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:03.214196 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.775 seconds
[0m01:31:03.220337 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:31:03.382725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106759460>]}
[0m01:31:03.383989 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.96s]
[0m01:31:03.384868 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:31:03.385479 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:31:03.386144 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m01:31:03.386745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:31:03.387167 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:31:03.394707 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:31:03.395500 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:31:03.398493 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:31:03.399849 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:31:03.400201 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m01:31:03.400512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:04.136432 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.735 seconds
[0m01:31:04.142455 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:31:04.283266 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3de210>]}
[0m01:31:04.284073 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.90s]
[0m01:31:04.284719 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:31:04.285166 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:31:04.285702 [info ] [Thread-1 (]: 4 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:31:04.286281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:31:04.286651 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:31:04.295523 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:31:04.296609 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:31:04.319963 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:04.320267 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:31:04.320482 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:05.164994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.844 seconds
[0m01:31:05.177379 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.177809 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:31:05.267410 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.089 seconds
[0m01:31:05.271338 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.271713 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:31:05.385058 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.112 seconds
[0m01:31:05.404401 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.404857 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:31:05.529902 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.124 seconds
[0m01:31:05.539586 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.540420 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:31:05.661130 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.120 seconds
[0m01:31:05.675243 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:31:05.691174 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.692381 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.692665 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:31:05.854071 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.161 seconds
[0m01:31:05.854893 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:05.855379 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:31:06.213441 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.357 seconds
[0m01:31:06.214237 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:06.214709 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:31:06.368966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m01:31:06.382444 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:31:06.388969 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:31:06.389306 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:31:06.513410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.123 seconds
[0m01:31:06.520516 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:31:06.666104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b3bc770>]}
[0m01:31:06.667602 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.38s]
[0m01:31:06.668487 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:31:06.669016 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:31:06.669642 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_with_hosts ........................ [RUN]
[0m01:31:06.670287 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m01:31:06.670736 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:31:06.674738 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:31:06.675965 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:31:06.678941 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:31:06.680479 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:31:06.680970 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace   view AIRBNB.DEV.dim_listings_with_hosts
  
   as (
    WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
)
WITH h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
  );
[0m01:31:06.681285 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:31:07.126559 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b7cfff-0003-ecdc-0001-75d70003936a
[0m01:31:07.127203 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 0 unexpected 'WITH'.
syntax error line 10 at position 0 unexpected 'SELECT'.
[0m01:31:07.127785 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m01:31:07.277736 [debug] [Thread-1 (]: Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'WITH'.
  syntax error line 10 at position 0 unexpected 'SELECT'.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_listings_with_hosts.sql
[0m01:31:07.278398 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '631a3df6-274a-4b15-b2ef-adadf881b4b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a1f8050>]}
[0m01:31:07.279187 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model DEV.dim_listings_with_hosts ............... [[31mERROR[0m in 0.61s]
[0m01:31:07.279876 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:31:07.282201 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:31:07.282568 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m01:31:07.282961 [info ] [MainThread]: 
[0m01:31:07.283277 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 7.42 seconds (7.42s).
[0m01:31:07.284372 [debug] [MainThread]: Command end result
[0m01:31:07.365933 [info ] [MainThread]: 
[0m01:31:07.366206 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:31:07.366357 [info ] [MainThread]: 
[0m01:31:07.366577 [error] [MainThread]:   Database Error in model dim_listings_with_hosts (models/dim/dim_listings_with_hosts.sql)
  001003 (42000): SQL compilation error:
  syntax error line 7 at position 0 unexpected 'WITH'.
  syntax error line 10 at position 0 unexpected 'SELECT'.
  compiled code at target/run/AIRBNB_DBT/models/dim/dim_listings_with_hosts.sql
[0m01:31:07.366768 [info ] [MainThread]: 
[0m01:31:07.366938 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m01:31:07.368160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.8735285, "process_user_time": 1.658481, "process_kernel_time": 0.218789, "process_mem_max_rss": "135053312", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:31:07.368424 [debug] [MainThread]: Command `dbt run` failed at 01:31:07.368380 after 7.87 seconds
[0m01:31:07.368602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10767f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107658f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b66bec0>]}
[0m01:31:07.368767 [debug] [MainThread]: Flushing usage events
[0m01:32:21.567507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f154c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030b56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e4e00>]}


============================== 01:32:21.570166 | 01476c27-d87e-4389-ad20-2f7912aec283 ==============================
[0m01:32:21.570166 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:32:21.570468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:32:21.777942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044088f0>]}
[0m01:32:21.801948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fce9f0>]}
[0m01:32:21.802780 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:32:21.812174 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:32:21.854726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:32:21.854988 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:32:21.867250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df3ec0>]}
[0m01:32:21.905503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052846e0>]}
[0m01:32:21.905811 [info ] [MainThread]: Found 7 models, 454 macros
[0m01:32:21.905984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527b920>]}
[0m01:32:21.906942 [info ] [MainThread]: 
[0m01:32:21.907235 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:32:21.909293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:32:21.916556 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:32:21.916746 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:32:21.916877 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:32:22.703433 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.786 seconds
[0m01:32:22.706264 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:32:22.857642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:32:22.868651 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:32:22.869039 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:32:22.869330 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:32:23.383762 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.514 seconds
[0m01:32:23.388102 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:32:23.529548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508a7e0>]}
[0m01:32:23.530365 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:32:23.530832 [info ] [MainThread]: 
[0m01:32:23.535517 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:32:23.536060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:32:23.536464 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:32:23.544631 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:32:23.546517 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:32:23.547002 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:32:23.547515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:32:23.547974 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:32:23.549861 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:32:23.550824 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:32:23.551154 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:32:23.551602 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m01:32:23.552182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:32:23.552546 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:32:23.555162 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:32:23.555755 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m01:32:23.575639 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m01:32:23.576662 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m01:32:23.576946 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m01:32:23.577167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:24.315739 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m01:32:24.339274 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m01:32:24.472692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103998410>]}
[0m01:32:24.473315 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m01:32:24.473796 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:32:24.474157 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:32:24.474611 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m01:32:24.475154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:32:24.475422 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:32:24.481129 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:32:24.481913 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:32:24.484454 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:32:24.485341 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:32:24.485900 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m01:32:24.486265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:25.342645 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m01:32:25.347051 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:32:25.482717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e05610>]}
[0m01:32:25.484373 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m01:32:25.485573 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:32:25.486239 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:32:25.486947 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m01:32:25.487527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:32:25.487923 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:32:25.495534 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:32:25.496531 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:32:25.499831 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:32:25.501501 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:32:25.501842 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m01:32:25.502277 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:26.269885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.767 seconds
[0m01:32:26.277003 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:32:26.420390 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f9910>]}
[0m01:32:26.421354 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.93s]
[0m01:32:26.422168 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:32:26.422746 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:32:26.423493 [info ] [Thread-1 (]: 4 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:32:26.424265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:32:26.424726 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:32:26.436104 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:32:26.437674 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:32:26.463512 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:26.463841 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:32:26.464050 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:27.388694 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m01:32:27.401194 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:27.401679 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:32:27.503841 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.101 seconds
[0m01:32:27.512588 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:27.512995 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:32:27.607293 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.094 seconds
[0m01:32:27.624897 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:27.625340 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:32:27.766300 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.140 seconds
[0m01:32:27.772090 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:27.772564 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:32:27.865850 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.093 seconds
[0m01:32:27.879530 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:32:27.893488 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:32:27.894652 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:27.894937 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:32:28.025207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.130 seconds
[0m01:32:28.026504 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:28.027228 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:32:28.311799 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.283 seconds
[0m01:32:28.313901 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:28.314901 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:32:28.722819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.407 seconds
[0m01:32:28.734484 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:32:28.740991 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:32:28.741316 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:32:28.897182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.155 seconds
[0m01:32:28.901096 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:32:29.046520 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fdcd0>]}
[0m01:32:29.048187 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.62s]
[0m01:32:29.048712 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:32:29.049058 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:32:29.049445 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listings_with_hosts ........................ [RUN]
[0m01:32:29.049839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m01:32:29.050089 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:32:29.052659 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:32:29.053364 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:32:29.055395 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:32:29.056340 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:32:29.056575 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace   view AIRBNB.DEV.dim_listings_with_hosts
  
   as (
    WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
  );
[0m01:32:29.056782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:32:30.291443 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.234 seconds
[0m01:32:30.298781 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m01:32:30.534962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01476c27-d87e-4389-ad20-2f7912aec283', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101b8b980>]}
[0m01:32:30.535663 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listings_with_hosts ................... [[32mSUCCESS 1[0m in 1.48s]
[0m01:32:30.536129 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:32:30.537275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:32:30.537465 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m01:32:30.537746 [info ] [MainThread]: 
[0m01:32:30.537952 [info ] [MainThread]: Finished running 4 view models, 1 incremental model in 0 hours 0 minutes and 8.63 seconds (8.63s).
[0m01:32:30.538687 [debug] [MainThread]: Command end result
[0m01:32:30.587745 [info ] [MainThread]: 
[0m01:32:30.588043 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:32:30.588211 [info ] [MainThread]: 
[0m01:32:30.588370 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:32:30.589675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.052042, "process_user_time": 1.628788, "process_kernel_time": 0.219259, "process_mem_max_rss": "133332992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:32:30.589953 [debug] [MainThread]: Command `dbt run` succeeded at 01:32:30.589905 after 9.05 seconds
[0m01:32:30.590145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049391f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105166b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e2a900>]}
[0m01:32:30.590325 [debug] [MainThread]: Flushing usage events
[0m01:36:27.571479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ef350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ead1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eacef0>]}


============================== 01:36:27.574380 | 44522efe-8b01-412e-b9c0-b516b5a7c52b ==============================
[0m01:36:27.574380 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:36:27.574692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:36:27.798375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d6b10>]}
[0m01:36:27.821224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046e49b0>]}
[0m01:36:27.821860 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:36:27.831143 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:36:27.883805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:36:27.884078 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:36:27.895969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b51910>]}
[0m01:36:27.935798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d4c8f0>]}
[0m01:36:27.936075 [info ] [MainThread]: Found 7 models, 454 macros
[0m01:36:27.936246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1f080>]}
[0m01:36:27.937192 [info ] [MainThread]: 
[0m01:36:27.937511 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:36:27.939597 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:36:27.946828 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:36:27.947051 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:36:27.947193 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:29.000840 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.053 seconds
[0m01:36:29.003622 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:36:29.139820 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:36:29.151360 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:36:29.151772 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:36:29.152058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:29.833334 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.681 seconds
[0m01:36:29.837925 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:36:29.971703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423eff0>]}
[0m01:36:29.972535 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:36:29.973006 [info ] [MainThread]: 
[0m01:36:29.977134 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:36:29.977683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:36:29.978100 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:36:29.985905 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:36:29.987655 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:36:29.988036 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:36:29.988610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:36:29.988908 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:36:29.990438 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:36:29.991555 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:36:29.991870 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:36:29.992495 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m01:36:29.993172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:36:29.993454 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:36:29.995821 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:36:29.996365 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.src_reviews
[0m01:36:30.016382 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.src_reviews"
[0m01:36:30.017494 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.src_reviews"
[0m01:36:30.017817 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    

WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
  );
[0m01:36:30.018034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:30.698697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m01:36:30.720303 [debug] [Thread-1 (]: On model.AIRBNB_DBT.src_reviews: Close
[0m01:36:30.873855 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049d5e80>]}
[0m01:36:30.874922 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.88s]
[0m01:36:30.875725 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:36:30.876234 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:36:30.876819 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m01:36:30.877445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:36:30.877941 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:36:30.883715 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:36:30.884564 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:36:30.889856 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:36:30.891132 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:36:30.891469 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m01:36:30.891782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:31.820979 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.929 seconds
[0m01:36:31.822373 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:36:31.951869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbc860>]}
[0m01:36:31.952749 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.07s]
[0m01:36:31.953436 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:36:31.953874 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:36:31.954410 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m01:36:31.954900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:36:31.955265 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:36:31.961732 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:36:31.963819 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:36:31.966415 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:36:31.967679 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:36:31.967984 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m01:36:31.968253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:32.745975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.777 seconds
[0m01:36:32.748969 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:36:32.908709 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fbe060>]}
[0m01:36:32.909697 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 0.95s]
[0m01:36:32.910477 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:36:32.910960 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:36:32.911529 [info ] [Thread-1 (]: 4 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:36:32.912086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:36:32.912484 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:36:32.923005 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:36:32.925447 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:36:32.951075 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:32.951430 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH src_reviews AS(
    SELECT * FROM AIRBNB.DEV.src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:36:32.951658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:33.892237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m01:36:33.905252 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:33.905776 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:36:34.080292 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.174 seconds
[0m01:36:34.086113 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.086667 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:36:34.186298 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.099 seconds
[0m01:36:34.204768 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.205239 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:36:34.307534 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.102 seconds
[0m01:36:34.314780 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.315383 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:36:34.452143 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.136 seconds
[0m01:36:34.463468 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:36:34.477189 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.478207 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.478472 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:36:34.603095 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m01:36:34.604444 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.604930 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:36:34.922187 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.316 seconds
[0m01:36:34.923209 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:34.923747 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:36:35.098537 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.174 seconds
[0m01:36:35.107927 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:36:35.115267 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:36:35.115649 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:36:35.303148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.187 seconds
[0m01:36:35.307344 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:36:35.495886 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050ef260>]}
[0m01:36:35.497143 [info ] [Thread-1 (]: 4 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.58s]
[0m01:36:35.498056 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:36:35.498682 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:36:35.499415 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m01:36:35.500077 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m01:36:35.500509 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:36:35.504881 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:36:35.506157 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:36:35.525731 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:36:35.526585 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:36:35.526775 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m01:36:35.526940 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:37.150184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.622 seconds
[0m01:36:37.154877 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m01:36:37.309435 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44522efe-8b01-412e-b9c0-b516b5a7c52b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fb1310>]}
[0m01:36:37.310432 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 1.81s]
[0m01:36:37.311325 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:36:37.313141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:37.313632 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m01:36:37.314122 [info ] [MainThread]: 
[0m01:36:37.314510 [info ] [MainThread]: Finished running 3 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 9.38 seconds (9.38s).
[0m01:36:37.315758 [debug] [MainThread]: Command end result
[0m01:36:37.397414 [info ] [MainThread]: 
[0m01:36:37.397682 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:36:37.397843 [info ] [MainThread]: 
[0m01:36:37.398038 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m01:36:37.399276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.86064, "process_user_time": 1.648848, "process_kernel_time": 0.228286, "process_mem_max_rss": "133890048", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:36:37.399544 [debug] [MainThread]: Command `dbt run` succeeded at 01:36:37.399499 after 9.86 seconds
[0m01:36:37.399746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ef350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e6b830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513e810>]}
[0m01:36:37.399906 [debug] [MainThread]: Flushing usage events
[0m01:49:35.131395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b3abd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100050d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110004e30>]}


============================== 01:49:35.134252 | 5ea419f8-2ba8-46c6-b2be-f61ec96b44f6 ==============================
[0m01:49:35.134252 [info ] [MainThread]: Running with dbt=1.8.7
[0m01:49:35.134577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:49:35.357689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11034a120>]}
[0m01:49:35.380828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fd9760>]}
[0m01:49:35.381481 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m01:49:35.391106 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m01:49:35.433046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:49:35.433304 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:49:35.445417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d01ca0>]}
[0m01:49:35.484983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f803e0>]}
[0m01:49:35.485302 [info ] [MainThread]: Found 7 models, 454 macros
[0m01:49:35.485483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c5b110>]}
[0m01:49:35.486417 [info ] [MainThread]: 
[0m01:49:35.486718 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:49:35.488751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m01:49:35.496545 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m01:49:35.496744 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m01:49:35.496881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:49:36.437891 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.941 seconds
[0m01:49:36.441401 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m01:49:36.572406 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m01:49:36.583755 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m01:49:36.584157 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m01:49:36.584451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:49:37.103532 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.519 seconds
[0m01:49:37.110669 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m01:49:37.249277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110392e40>]}
[0m01:49:37.250325 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m01:49:37.250803 [info ] [MainThread]: 
[0m01:49:37.255365 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m01:49:37.255932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m01:49:37.256341 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m01:49:37.264355 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m01:49:37.265925 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m01:49:37.266311 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m01:49:37.266975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m01:49:37.267604 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m01:49:37.269512 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m01:49:37.270659 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m01:49:37.271174 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m01:49:37.271812 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m01:49:37.272258 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m01:49:37.274025 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m01:49:37.274835 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m01:49:37.275119 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:49:37.275650 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m01:49:37.276164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m01:49:37.276441 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:49:37.280549 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:49:37.281372 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:49:37.301446 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:49:37.302310 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m01:49:37.302531 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.RAW.RAW_HOSTS
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m01:49:37.302879 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:37.968476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m01:49:37.998602 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m01:49:38.146448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e41a0>]}
[0m01:49:38.147565 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.87s]
[0m01:49:38.148424 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m01:49:38.149020 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:49:38.149670 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m01:49:38.150241 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m01:49:38.150650 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:49:38.158026 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:49:38.160578 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:49:38.163527 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:49:38.165049 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m01:49:38.165404 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.RAW.RAW_LISTINGS
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT 
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m01:49:38.165720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:38.992727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.827 seconds
[0m01:49:38.995566 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m01:49:39.154372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fdf860>]}
[0m01:49:39.156837 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m01:49:39.157451 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m01:49:39.157843 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m01:49:39.158355 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m01:49:39.158873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m01:49:39.159140 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m01:49:39.168474 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m01:49:39.169512 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m01:49:39.190000 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:39.190329 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.RAW.RAW_REVIEWS
)
SELECT 
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m01:49:39.190545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:39.811066 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m01:49:39.824249 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:39.824689 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:49:39.928345 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.103 seconds
[0m01:49:39.932704 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:39.933137 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m01:49:40.038527 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.105 seconds
[0m01:49:40.055737 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:40.056115 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:49:40.317281 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.260 seconds
[0m01:49:40.326451 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:40.327057 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m01:49:40.419328 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.091 seconds
[0m01:49:40.432572 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m01:49:40.448000 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m01:49:40.448987 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:40.449281 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m01:49:40.584392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.134 seconds
[0m01:49:40.585713 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:40.586992 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m01:49:41.347786 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.759 seconds
[0m01:49:41.349891 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:41.350846 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m01:49:41.522560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m01:49:41.535689 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m01:49:41.540154 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m01:49:41.540395 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m01:49:41.760396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.219 seconds
[0m01:49:41.764640 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m01:49:41.929716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f36600>]}
[0m01:49:41.930675 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 2.77s]
[0m01:49:41.931195 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m01:49:41.931692 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:49:41.932117 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m01:49:41.932483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m01:49:41.932759 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:49:41.936182 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:49:41.937084 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:49:41.952379 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:49:41.953433 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m01:49:41.953673 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m01:49:41.953892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:49:43.550765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.596 seconds
[0m01:49:43.555267 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m01:49:43.693410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ea419f8-2ba8-46c6-b2be-f61ec96b44f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f3500>]}
[0m01:49:43.695106 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 1.76s]
[0m01:49:43.695938 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m01:49:43.697558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:49:43.698034 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m01:49:43.698550 [info ] [MainThread]: 
[0m01:49:43.698961 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m01:49:43.700157 [debug] [MainThread]: Command end result
[0m01:49:43.772065 [info ] [MainThread]: 
[0m01:49:43.772346 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:49:43.772506 [info ] [MainThread]: 
[0m01:49:43.772675 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:49:43.774202 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.674626, "process_user_time": 1.591316, "process_kernel_time": 0.217643, "process_mem_max_rss": "134987776", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:49:43.774479 [debug] [MainThread]: Command `dbt run` succeeded at 01:49:43.774435 after 8.67 seconds
[0m01:49:43.774659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d2cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b07920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116920140>]}
[0m01:49:43.774813 [debug] [MainThread]: Flushing usage events
[0m15:10:29.132662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bfeff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105eb4b90>]}


============================== 15:10:29.135729 | 0b083ee9-8392-4ee1-8d20-b66371f3e14f ==============================
[0m15:10:29.135729 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:10:29.136071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:10:29.386728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1f710>]}
[0m15:10:29.409452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec8560>]}
[0m15:10:29.410074 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:10:29.420625 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:10:29.478246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:10:29.478619 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://seeds/seed_full_moon_dates.csv
[0m15:10:29.572241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e58a40>]}
[0m15:10:29.614225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e32810>]}
[0m15:10:29.614499 [info ] [MainThread]: Found 7 models, 1 seed, 454 macros
[0m15:10:29.614674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a3ca40>]}
[0m15:10:29.615554 [info ] [MainThread]: 
[0m15:10:29.615830 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:29.616419 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:10:29.622874 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:10:29.623091 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:10:29.623243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:31.008156 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.385 seconds
[0m15:10:31.011418 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:10:31.180182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:10:31.190378 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:10:31.190712 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m15:10:31.190968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:10:31.836009 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.645 seconds
[0m15:10:31.838011 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:10:31.987354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b76990>]}
[0m15:10:31.988169 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:10:31.988532 [info ] [MainThread]: 
[0m15:10:31.992582 [debug] [Thread-1 (]: Began running node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:10:31.993247 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m15:10:31.994001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now seed.AIRBNB_DBT.seed_full_moon_dates)
[0m15:10:31.994467 [debug] [Thread-1 (]: Began compiling node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:10:31.994857 [debug] [Thread-1 (]: Began executing node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:10:32.027054 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:10:32.027372 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (full_moon_date date)
[0m15:10:32.027580 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:10:32.767189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m15:10:32.779156 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:10:32.779501 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
BEGIN
[0m15:10:32.950884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.171 seconds
[0m15:10:32.954411 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:10:32.954770 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s)...
[0m15:10:34.883498 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.928 seconds
[0m15:10:34.884567 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:10:34.885075 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
COMMIT
[0m15:10:35.416991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m15:10:35.427097 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:10:35.451734 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: Close
[0m15:10:35.632632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b083ee9-8392-4ee1-8d20-b66371f3e14f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047b0aa0>]}
[0m15:10:35.633772 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 3.64s]
[0m15:10:35.634681 [debug] [Thread-1 (]: Finished running node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:10:35.636646 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:10:35.637071 [debug] [MainThread]: Connection 'seed.AIRBNB_DBT.seed_full_moon_dates' was properly closed.
[0m15:10:35.637457 [info ] [MainThread]: 
[0m15:10:35.637836 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 6.02 seconds (6.02s).
[0m15:10:35.638611 [debug] [MainThread]: Command end result
[0m15:10:35.717333 [info ] [MainThread]: 
[0m15:10:35.717624 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:10:35.717786 [info ] [MainThread]: 
[0m15:10:35.717937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:10:35.722748 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 6.6253214, "process_user_time": 1.425763, "process_kernel_time": 0.264173, "process_mem_max_rss": "140804096", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:10:35.723027 [debug] [MainThread]: Command `dbt seed` succeeded at 15:10:35.722980 after 6.63 seconds
[0m15:10:35.723213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106190c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bff6b0>]}
[0m15:10:35.723584 [debug] [MainThread]: Flushing usage events
[0m16:35:47.890407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072df440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c109b0>]}


============================== 16:35:47.893419 | 560b68b1-ef18-49f6-9358-31188a020849 ==============================
[0m16:35:47.893419 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:35:47.893739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:47.904575 [info ] [MainThread]: dbt version: 1.8.7
[0m16:35:47.904821 [info ] [MainThread]: python version: 3.12.7
[0m16:35:47.904964 [info ] [MainThread]: python path: /Users/JELB/dbtCourse/venv/bin/python
[0m16:35:47.905095 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m16:35:48.082805 [info ] [MainThread]: Using profiles dir at /Users/JELB/.dbt
[0m16:35:48.083109 [info ] [MainThread]: Using profiles.yml file at /Users/JELB/.dbt/profiles.yml
[0m16:35:48.083262 [info ] [MainThread]: Using dbt_project.yml file at /Users/JELB/dbtCourse/AIRBNB_DBT/dbt_project.yml
[0m16:35:48.083840 [info ] [MainThread]: adapter type: snowflake
[0m16:35:48.084024 [info ] [MainThread]: adapter version: 1.8.3
[0m16:35:48.121378 [info ] [MainThread]: Configuration:
[0m16:35:48.121653 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:35:48.121797 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:35:48.121927 [info ] [MainThread]: Required dependencies:
[0m16:35:48.122110 [debug] [MainThread]: Executing "git --help"
[0m16:35:48.130037 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:35:48.130589 [debug] [MainThread]: STDERR: "b''"
[0m16:35:48.130773 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:35:48.130929 [info ] [MainThread]: Connection:
[0m16:35:48.131086 [info ] [MainThread]:   account: poqdnsp-veb67537
[0m16:35:48.131215 [info ] [MainThread]:   user: dbt
[0m16:35:48.131333 [info ] [MainThread]:   database: AIRBNB
[0m16:35:48.131448 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m16:35:48.131563 [info ] [MainThread]:   role: transform
[0m16:35:48.131671 [info ] [MainThread]:   schema: DEV
[0m16:35:48.131781 [info ] [MainThread]:   authenticator: None
[0m16:35:48.131884 [info ] [MainThread]:   oauth_client_id: None
[0m16:35:48.131987 [info ] [MainThread]:   query_tag: None
[0m16:35:48.132090 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:35:48.132196 [info ] [MainThread]:   host: None
[0m16:35:48.132300 [info ] [MainThread]:   port: None
[0m16:35:48.132404 [info ] [MainThread]:   proxy_host: None
[0m16:35:48.132509 [info ] [MainThread]:   proxy_port: None
[0m16:35:48.132613 [info ] [MainThread]:   protocol: None
[0m16:35:48.132717 [info ] [MainThread]:   connect_retries: 1
[0m16:35:48.132825 [info ] [MainThread]:   connect_timeout: None
[0m16:35:48.132938 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:35:48.133053 [info ] [MainThread]:   retry_all: False
[0m16:35:48.133159 [info ] [MainThread]:   insecure_mode: False
[0m16:35:48.133266 [info ] [MainThread]:   reuse_connections: None
[0m16:35:48.133642 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:35:48.137734 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:35:48.138577 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:35:48.138727 [debug] [MainThread]: On debug: select 1 as id
[0m16:35:48.138852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:35:48.977600 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.838 seconds
[0m16:35:48.981953 [debug] [MainThread]: On debug: Close
[0m16:35:49.144966 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:35:49.145698 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:35:49.149927 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2921929, "process_user_time": 0.808096, "process_kernel_time": 0.152011, "process_mem_max_rss": "126844928", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:49.150702 [debug] [MainThread]: Command `dbt debug` succeeded at 16:35:49.150566 after 1.29 seconds
[0m16:35:49.151112 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:35:49.151828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072df440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca6690>]}
[0m16:35:49.152402 [debug] [MainThread]: Flushing usage events
[0m16:35:56.752682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063eaa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106955160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106954ec0>]}


============================== 16:35:56.754754 | a16be4a1-4c10-4ec0-823d-0ef5f85ef633 ==============================
[0m16:35:56.754754 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:35:56.755061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:35:56.936896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a16be4a1-4c10-4ec0-823d-0ef5f85ef633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751b770>]}
[0m16:35:56.961339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a16be4a1-4c10-4ec0-823d-0ef5f85ef633', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b99d0>]}
[0m16:35:56.961800 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:35:56.971124 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:35:57.009694 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading AIRBNB_DBT: sources.yml - Runtime Error
    Syntax error near line 3
    ------------------------------
    1  | version:2
    2  | 
    3  | sources:
    4  |     - name: AIRBNB
    5  |       schema: raw
    6  |       tables:
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 3, column 8
[0m16:35:57.010749 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28639767, "process_user_time": 0.76207, "process_kernel_time": 0.121067, "process_mem_max_rss": "118882304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:35:57.011091 [debug] [MainThread]: Command `dbt run` failed at 16:35:57.011039 after 0.29 seconds
[0m16:35:57.011317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069083e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107719bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107719c70>]}
[0m16:35:57.011495 [debug] [MainThread]: Flushing usage events
[0m16:38:02.862455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118666fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d50b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d50860>]}


============================== 16:38:02.864693 | f9138a94-3237-4f9c-a88f-8eeecc5c856a ==============================
[0m16:38:02.864693 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:38:02.865002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:38:02.870255 [info ] [MainThread]: dbt version: 1.8.7
[0m16:38:02.870567 [info ] [MainThread]: python version: 3.12.7
[0m16:38:02.870740 [info ] [MainThread]: python path: /Users/JELB/dbtCourse/venv/bin/python
[0m16:38:02.870868 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m16:38:03.006950 [info ] [MainThread]: Using profiles dir at /Users/JELB/.dbt
[0m16:38:03.007209 [info ] [MainThread]: Using profiles.yml file at /Users/JELB/.dbt/profiles.yml
[0m16:38:03.007364 [info ] [MainThread]: Using dbt_project.yml file at /Users/JELB/dbtCourse/AIRBNB_DBT/dbt_project.yml
[0m16:38:03.007644 [info ] [MainThread]: adapter type: snowflake
[0m16:38:03.007836 [info ] [MainThread]: adapter version: 1.8.3
[0m16:38:03.046721 [info ] [MainThread]: Configuration:
[0m16:38:03.047018 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:38:03.047160 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:38:03.047286 [info ] [MainThread]: Required dependencies:
[0m16:38:03.047499 [debug] [MainThread]: Executing "git --help"
[0m16:38:03.054850 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:38:03.055452 [debug] [MainThread]: STDERR: "b''"
[0m16:38:03.055678 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:38:03.055943 [info ] [MainThread]: Connection:
[0m16:38:03.056135 [info ] [MainThread]:   account: poqdnsp-veb67537
[0m16:38:03.056273 [info ] [MainThread]:   user: dbt
[0m16:38:03.056395 [info ] [MainThread]:   database: AIRBNB
[0m16:38:03.056510 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m16:38:03.056620 [info ] [MainThread]:   role: transform
[0m16:38:03.056735 [info ] [MainThread]:   schema: DEV
[0m16:38:03.056847 [info ] [MainThread]:   authenticator: None
[0m16:38:03.056955 [info ] [MainThread]:   oauth_client_id: None
[0m16:38:03.057066 [info ] [MainThread]:   query_tag: None
[0m16:38:03.057174 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:38:03.057280 [info ] [MainThread]:   host: None
[0m16:38:03.057390 [info ] [MainThread]:   port: None
[0m16:38:03.057496 [info ] [MainThread]:   proxy_host: None
[0m16:38:03.057602 [info ] [MainThread]:   proxy_port: None
[0m16:38:03.057710 [info ] [MainThread]:   protocol: None
[0m16:38:03.057817 [info ] [MainThread]:   connect_retries: 1
[0m16:38:03.057921 [info ] [MainThread]:   connect_timeout: None
[0m16:38:03.058023 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:38:03.058128 [info ] [MainThread]:   retry_all: False
[0m16:38:03.058232 [info ] [MainThread]:   insecure_mode: False
[0m16:38:03.058334 [info ] [MainThread]:   reuse_connections: None
[0m16:38:03.058691 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:38:03.061745 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:38:03.062830 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:38:03.062975 [debug] [MainThread]: On debug: select 1 as id
[0m16:38:03.063093 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:38:03.908080 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.845 seconds
[0m16:38:03.909075 [debug] [MainThread]: On debug: Close
[0m16:38:04.054310 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:38:04.054884 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:38:04.056533 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2231289, "process_user_time": 0.793955, "process_kernel_time": 0.133577, "process_mem_max_rss": "126943232", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:04.057080 [debug] [MainThread]: Command `dbt debug` succeeded at 16:38:04.056999 after 1.22 seconds
[0m16:38:04.057363 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:38:04.057632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11977afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197c67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a309df0>]}
[0m16:38:04.057979 [debug] [MainThread]: Flushing usage events
[0m16:38:12.499559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a601d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106530ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106530c20>]}


============================== 16:38:12.501628 | 0c7ded7e-9bff-434b-b8e8-3285dcf70ff5 ==============================
[0m16:38:12.501628 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:38:12.501927 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:12.682050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c7ded7e-9bff-434b-b8e8-3285dcf70ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106121f70>]}
[0m16:38:12.705012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c7ded7e-9bff-434b-b8e8-3285dcf70ff5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f089b0>]}
[0m16:38:12.705426 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:38:12.714373 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:38:12.762089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 3 files changed.
[0m16:38:12.762429 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://models/sources.yml
[0m16:38:12.762628 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/src/src_listing.sql
[0m16:38:12.762796 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/src/src_reviews.sql
[0m16:38:12.762959 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/src/src_hosts.sql
[0m16:38:12.879253 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.AIRBNB_DBT.src_listing' (models/src/src_listing.sql) depends on a source named 'AIRBNB.listings' which was not found
[0m16:38:12.880367 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40920845, "process_user_time": 0.874943, "process_kernel_time": 0.125346, "process_mem_max_rss": "124452864", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:12.880706 [debug] [MainThread]: Command `dbt run` failed at 16:38:12.880651 after 0.41 seconds
[0m16:38:12.880916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106530ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073bd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bf560>]}
[0m16:38:12.881090 [debug] [MainThread]: Flushing usage events
[0m16:38:27.309926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11033ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110510ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110510c50>]}


============================== 16:38:27.312149 | 1dccb62c-078c-494c-9e00-fddde3c189e7 ==============================
[0m16:38:27.312149 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:38:27.312462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:38:27.499831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b59d0>]}
[0m16:38:27.524859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11195b4a0>]}
[0m16:38:27.525392 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:38:27.533747 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:38:27.588944 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:38:27.589209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:38:27.609059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111516fc0>]}
[0m16:38:27.656569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eac890>]}
[0m16:38:27.656872 [info ] [MainThread]: Found 7 models, 1 seed, 3 sources, 454 macros
[0m16:38:27.657050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b8ee70>]}
[0m16:38:27.658030 [info ] [MainThread]: 
[0m16:38:27.658322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:38:27.660552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:38:27.668058 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:38:27.668261 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:38:27.668401 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:38:28.561957 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.893 seconds
[0m16:38:28.568271 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:38:28.691655 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:38:28.701604 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:38:28.701929 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:38:28.702179 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:38:29.213900 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.511 seconds
[0m16:38:29.219363 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:38:29.377979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f1fa0>]}
[0m16:38:29.378847 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:38:29.379338 [info ] [MainThread]: 
[0m16:38:29.383572 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m16:38:29.384092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m16:38:29.384462 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m16:38:29.394276 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m16:38:29.396269 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m16:38:29.396638 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m16:38:29.396970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m16:38:29.397320 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m16:38:29.399877 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m16:38:29.400899 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m16:38:29.401229 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m16:38:29.401811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m16:38:29.402314 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m16:38:29.405042 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m16:38:29.405982 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m16:38:29.406287 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:38:29.406692 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m16:38:29.407040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m16:38:29.407280 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:38:29.410766 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:38:29.411476 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:38:29.431989 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:38:29.433017 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:38:29.433331 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.raw.raw_hosts
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m16:38:29.433617 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:30.204549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.770 seconds
[0m16:38:30.225635 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m16:38:30.399114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cef260>]}
[0m16:38:30.400185 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m16:38:30.401055 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:38:30.401644 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:38:30.402341 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m16:38:30.402947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m16:38:30.403362 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:38:30.410835 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:38:30.411938 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:38:30.414863 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:38:30.416279 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:38:30.416616 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m16:38:30.416925 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:31.239296 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m16:38:31.243269 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m16:38:31.398725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f241d0>]}
[0m16:38:31.399750 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.00s]
[0m16:38:31.400536 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:38:31.401029 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m16:38:31.401655 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:38:31.402292 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m16:38:31.402687 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m16:38:31.414828 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m16:38:31.417358 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m16:38:31.441980 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:31.442274 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m16:38:31.442484 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:32.247349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m16:38:32.254606 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.254894 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:38:32.367490 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.112 seconds
[0m16:38:32.373365 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.373864 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m16:38:32.489398 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.115 seconds
[0m16:38:32.500568 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.500886 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:38:32.590464 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.089 seconds
[0m16:38:32.594040 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.594477 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:38:32.714637 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.120 seconds
[0m16:38:32.724911 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:38:32.738983 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.739789 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.740037 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:38:32.880047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.140 seconds
[0m16:38:32.880424 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:32.880659 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m16:38:34.014063 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.133 seconds
[0m16:38:34.014824 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:34.015179 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m16:38:34.304227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.288 seconds
[0m16:38:34.316922 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:38:34.323937 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:38:34.324387 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:38:34.492827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.168 seconds
[0m16:38:34.500525 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m16:38:34.639725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e2e330>]}
[0m16:38:34.641133 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.24s]
[0m16:38:34.641876 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m16:38:34.642392 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:38:34.643016 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m16:38:34.643646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m16:38:34.644084 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:38:34.648848 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:38:34.649937 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:38:34.669533 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:38:34.670950 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:38:34.671223 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m16:38:34.671455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:38:37.372821 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.701 seconds
[0m16:38:37.379030 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m16:38:37.525980 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dccb62c-078c-494c-9e00-fddde3c189e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414fbc0>]}
[0m16:38:37.527135 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.88s]
[0m16:38:37.527876 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:38:37.529457 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:38:37.529871 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m16:38:37.530351 [info ] [MainThread]: 
[0m16:38:37.530757 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 9.87 seconds (9.87s).
[0m16:38:37.532319 [debug] [MainThread]: Command end result
[0m16:38:37.608898 [info ] [MainThread]: 
[0m16:38:37.609190 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:38:37.609350 [info ] [MainThread]: 
[0m16:38:37.609512 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:38:37.610366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.329704, "process_user_time": 1.596878, "process_kernel_time": 0.201697, "process_mem_max_rss": "136118272", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:38:37.610633 [debug] [MainThread]: Command `dbt run` succeeded at 16:38:37.610587 after 10.33 seconds
[0m16:38:37.610819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0e990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e60650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e609e0>]}
[0m16:38:37.610980 [debug] [MainThread]: Flushing usage events
[0m16:52:11.350626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d7bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11173d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f4cc50>]}


============================== 16:52:11.353804 | e9406ba1-8cf7-4d5d-9803-93f2b315e335 ==============================
[0m16:52:11.353804 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:52:11.354117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:52:11.576738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d70d40>]}
[0m16:52:11.599477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f60410>]}
[0m16:52:11.600080 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:52:11.609666 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:52:11.680974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:11.681229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:11.699969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e24170>]}
[0m16:52:11.750064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11415e480>]}
[0m16:52:11.750442 [info ] [MainThread]: Found 7 models, 1 seed, 3 sources, 454 macros
[0m16:52:11.750619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113df85f0>]}
[0m16:52:11.751844 [info ] [MainThread]: 
[0m16:52:11.752304 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:11.754636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:52:11.762207 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:52:11.762394 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:52:11.762525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:12.780934 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.018 seconds
[0m16:52:12.783641 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:52:12.918212 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:52:12.930077 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:52:12.930446 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:52:12.930733 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:13.556879 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.626 seconds
[0m16:52:13.562244 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:52:13.712819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba1940>]}
[0m16:52:13.713690 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:13.714150 [info ] [MainThread]: 
[0m16:52:13.718237 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m16:52:13.718786 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m16:52:13.719198 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m16:52:13.728161 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m16:52:13.730335 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m16:52:13.730819 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m16:52:13.731169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m16:52:13.731564 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m16:52:13.734427 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m16:52:13.735405 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m16:52:13.735913 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m16:52:13.736573 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m16:52:13.736934 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m16:52:13.739280 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m16:52:13.740155 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m16:52:13.740452 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:52:13.740965 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m16:52:13.741454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m16:52:13.741714 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:52:13.745334 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:52:13.746204 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:52:13.766516 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:52:13.767346 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:52:13.767561 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.raw.raw_hosts
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m16:52:13.767749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:14.582793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.814 seconds
[0m16:52:14.610404 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m16:52:14.750226 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af0410>]}
[0m16:52:14.751324 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.01s]
[0m16:52:14.752185 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:52:14.752724 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:52:14.753492 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m16:52:14.754134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m16:52:14.754550 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:52:14.761842 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:52:14.762700 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:52:14.765963 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:52:14.767611 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:52:14.767959 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m16:52:14.768271 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:15.667677 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m16:52:15.674233 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m16:52:15.821094 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113da9b80>]}
[0m16:52:15.821561 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.07s]
[0m16:52:15.821895 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:52:15.822123 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m16:52:15.822423 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:52:15.822637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m16:52:15.822800 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m16:52:15.828675 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m16:52:15.830431 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m16:52:15.847074 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:15.847301 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m16:52:15.847474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:16.794504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m16:52:16.807738 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:16.808334 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:52:16.932342 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.123 seconds
[0m16:52:16.940934 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:16.941499 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m16:52:17.057042 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.115 seconds
[0m16:52:17.072240 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:17.072599 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:52:17.198864 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.126 seconds
[0m16:52:17.206560 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:17.206913 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:52:17.360429 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.153 seconds
[0m16:52:17.374115 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:52:17.388976 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m16:52:17.390077 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:17.390358 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:52:17.599924 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.209 seconds
[0m16:52:17.601258 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:17.601833 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m16:52:18.331197 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.728 seconds
[0m16:52:18.332835 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:18.333537 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m16:52:18.535426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.201 seconds
[0m16:52:18.548798 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:52:18.556627 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:52:18.557077 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:52:18.698535 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.141 seconds
[0m16:52:18.700234 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m16:52:18.826110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1163ed250>]}
[0m16:52:18.826801 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.00s]
[0m16:52:18.827245 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m16:52:18.827531 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:52:18.827925 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m16:52:18.828301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m16:52:18.828577 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:52:18.832342 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:52:18.833027 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:52:18.851975 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:52:18.853103 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:52:18.853408 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m16:52:18.853672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:20.993421 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.139 seconds
[0m16:52:20.997118 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m16:52:21.155083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9406ba1-8cf7-4d5d-9803-93f2b315e335', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643b4a0>]}
[0m16:52:21.155983 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.33s]
[0m16:52:21.156685 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:52:21.158283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:21.158742 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m16:52:21.159186 [info ] [MainThread]: 
[0m16:52:21.159547 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m16:52:21.160543 [debug] [MainThread]: Command end result
[0m16:52:21.236437 [info ] [MainThread]: 
[0m16:52:21.236691 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:21.236854 [info ] [MainThread]: 
[0m16:52:21.237034 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m16:52:21.238470 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.9230175, "process_user_time": 1.582327, "process_kernel_time": 0.216658, "process_mem_max_rss": "134348800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:52:21.238734 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:21.238694 after 9.92 seconds
[0m16:52:21.238912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ddc9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142aca40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643b4a0>]}
[0m16:52:21.239070 [debug] [MainThread]: Flushing usage events
[0m16:55:19.924406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105083260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ad6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10573cec0>]}


============================== 16:55:19.927315 | c0e50a22-1f15-44bf-a773-09211feed6d5 ==============================
[0m16:55:19.927315 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:55:19.927629 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt source freshness', 'send_anonymous_usage_stats': 'True'}
[0m16:55:20.150445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0e50a22-1f15-44bf-a773-09211feed6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105760890>]}
[0m16:55:20.173709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0e50a22-1f15-44bf-a773-09211feed6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064cfbf0>]}
[0m16:55:20.174338 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:55:20.184445 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:55:20.254896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:55:20.255157 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:55:20.274066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0e50a22-1f15-44bf-a773-09211feed6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f8f50>]}
[0m16:55:20.322836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0e50a22-1f15-44bf-a773-09211feed6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106821760>]}
[0m16:55:20.323132 [info ] [MainThread]: Found 7 models, 1 seed, 3 sources, 454 macros
[0m16:55:20.323316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e50a22-1f15-44bf-a773-09211feed6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628260>]}
[0m16:55:20.324236 [info ] [MainThread]: 
[0m16:55:20.324532 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:55:20.326589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m16:55:20.335554 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:55:20.335787 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:55:20.335930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:21.147471 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.811 seconds
[0m16:55:21.150167 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:55:21.296601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0e50a22-1f15-44bf-a773-09211feed6d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032a17f0>]}
[0m16:55:21.297221 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m16:55:21.297572 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:55:21.297834 [info ] [MainThread]: 
[0m16:55:21.300663 [debug] [Thread-1 (]: Began running node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:55:21.301006 [info ] [Thread-1 (]: 1 of 1 START freshness of AIRBNB.reviews ....................................... [RUN]
[0m16:55:21.301367 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now source.AIRBNB_DBT.AIRBNB.reviews)
[0m16:55:21.301638 [debug] [Thread-1 (]: Began compiling node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:55:21.301898 [debug] [Thread-1 (]: Began executing node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:55:21.309243 [debug] [Thread-1 (]: Using snowflake connection "source.AIRBNB_DBT.AIRBNB.reviews"
[0m16:55:21.309616 [debug] [Thread-1 (]: On source.AIRBNB_DBT.AIRBNB.reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "source.AIRBNB_DBT.AIRBNB.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m16:55:21.309881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:55:21.841590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.531 seconds
[0m16:55:21.847663 [debug] [Thread-1 (]: On source.AIRBNB_DBT.AIRBNB.reviews: Close
[0m16:55:22.003048 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of AIRBNB.reviews ................................. [[31mERROR STALE[0m in 0.70s]
[0m16:55:22.004280 [debug] [Thread-1 (]: Finished running node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:55:22.006671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:22.007090 [debug] [MainThread]: Connection 'source.AIRBNB_DBT.AIRBNB.reviews' was properly closed.
[0m16:55:22.007460 [info ] [MainThread]: 
[0m16:55:22.007839 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m16:55:22.034003 [info ] [MainThread]: 
[0m16:55:22.034354 [info ] [MainThread]: Done.
[0m16:55:22.036046 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 2.143914, "process_user_time": 1.038279, "process_kernel_time": 0.172647, "process_mem_max_rss": "131350528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:55:22.036524 [debug] [MainThread]: Command `dbt source freshness` failed at 16:55:22.036455 after 2.14 seconds
[0m16:55:22.036815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043ad6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d7e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d0350>]}
[0m16:55:22.037046 [debug] [MainThread]: Flushing usage events
[0m17:01:41.394439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071413d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107141130>]}


============================== 17:01:41.397481 | 6e6ed19f-ff22-4e46-81dc-305482cc1e4a ==============================
[0m17:01:41.397481 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:01:41.397836 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:01:41.625843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6e6ed19f-ff22-4e46-81dc-305482cc1e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110166a20>]}
[0m17:01:41.648869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6e6ed19f-ff22-4e46-81dc-305482cc1e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110337e30>]}
[0m17:01:41.649512 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:01:41.658925 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:01:41.715122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:01:41.715374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:01:41.734722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e6ed19f-ff22-4e46-81dc-305482cc1e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108240b0>]}
[0m17:01:41.786006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e6ed19f-ff22-4e46-81dc-305482cc1e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bb2150>]}
[0m17:01:41.786308 [info ] [MainThread]: Found 1 seed, 7 models, 3 sources, 454 macros
[0m17:01:41.786485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e6ed19f-ff22-4e46-81dc-305482cc1e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b979e0>]}
[0m17:01:41.787428 [info ] [MainThread]: 
[0m17:01:41.787749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:01:41.789911 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:01:41.798824 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:01:41.799031 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:01:41.799165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:01:42.981232 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.182 seconds
[0m17:01:42.984993 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:01:43.126635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e6ed19f-ff22-4e46-81dc-305482cc1e4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c7290>]}
[0m17:01:43.127321 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m17:01:43.127687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:01:43.127914 [info ] [MainThread]: 
[0m17:01:43.131368 [debug] [Thread-1 (]: Began running node source.AIRBNB_DBT.AIRBNB.reviews
[0m17:01:43.131685 [info ] [Thread-1 (]: 1 of 1 START freshness of AIRBNB.reviews ....................................... [RUN]
[0m17:01:43.132012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now source.AIRBNB_DBT.AIRBNB.reviews)
[0m17:01:43.132263 [debug] [Thread-1 (]: Began compiling node source.AIRBNB_DBT.AIRBNB.reviews
[0m17:01:43.132506 [debug] [Thread-1 (]: Began executing node source.AIRBNB_DBT.AIRBNB.reviews
[0m17:01:43.140103 [debug] [Thread-1 (]: Using snowflake connection "source.AIRBNB_DBT.AIRBNB.reviews"
[0m17:01:43.140500 [debug] [Thread-1 (]: On source.AIRBNB_DBT.AIRBNB.reviews: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "source.AIRBNB_DBT.AIRBNB.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m17:01:43.140713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:01:43.754211 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m17:01:43.756192 [debug] [Thread-1 (]: On source.AIRBNB_DBT.AIRBNB.reviews: Close
[0m17:01:43.907657 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of AIRBNB.reviews ........................................ [[33mWARN[0m in 0.78s]
[0m17:01:43.908596 [debug] [Thread-1 (]: Finished running node source.AIRBNB_DBT.AIRBNB.reviews
[0m17:01:43.910197 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:01:43.910675 [debug] [MainThread]: Connection 'source.AIRBNB_DBT.AIRBNB.reviews' was properly closed.
[0m17:01:43.910975 [info ] [MainThread]: 
[0m17:01:43.911294 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m17:01:43.934713 [info ] [MainThread]: Done.
[0m17:01:43.936591 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 2.57975, "process_user_time": 1.045229, "process_kernel_time": 0.18633, "process_mem_max_rss": "131088384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:01:43.937115 [debug] [MainThread]: Command `dbt source freshness` succeeded at 17:01:43.937048 after 2.58 seconds
[0m17:01:43.937360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bb1c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071413a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107141520>]}
[0m17:01:43.937573 [debug] [MainThread]: Flushing usage events
[0m17:38:03.231944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107526a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f87680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f873e0>]}


============================== 17:38:03.234861 | 3addff58-7842-46dd-885c-0354bf31ddbf ==============================
[0m17:38:03.234861 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:38:03.235201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:38:03.305566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3addff58-7842-46dd-885c-0354bf31ddbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a0dd0>]}
[0m17:38:03.645508 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.44310254, "process_user_time": 0.636855, "process_kernel_time": 0.100826, "process_mem_max_rss": "95305728", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:03.646646 [debug] [MainThread]: Command `dbt clean` succeeded at 17:38:03.646524 after 0.44 seconds
[0m17:38:03.647145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107464920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108052ab0>]}
[0m17:38:03.647656 [debug] [MainThread]: Flushing usage events
[0m17:38:08.728337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11255ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122961b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11283f3e0>]}


============================== 17:38:08.730748 | 8177f465-d16b-4582-8b5e-cddcf038d8f1 ==============================
[0m17:38:08.730748 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:38:08.731052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:38:08.737011 [info ] [MainThread]: dbt version: 1.8.0
[0m17:38:08.737221 [info ] [MainThread]: python version: 3.12.2
[0m17:38:08.737571 [info ] [MainThread]: python path: /usr/local/bin/python3
[0m17:38:08.737853 [info ] [MainThread]: os info: macOS-15.0.1-arm64-arm-64bit
[0m17:38:08.907801 [info ] [MainThread]: Using profiles dir at /Users/JELB/.dbt
[0m17:38:08.908100 [info ] [MainThread]: Using profiles.yml file at /Users/JELB/.dbt/profiles.yml
[0m17:38:08.908251 [info ] [MainThread]: Using dbt_project.yml file at /Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/dbt_project.yml
[0m17:38:08.908684 [info ] [MainThread]: adapter type: snowflake
[0m17:38:08.908873 [info ] [MainThread]: adapter version: 1.8.4
[0m17:38:08.947911 [info ] [MainThread]: Configuration:
[0m17:38:08.948250 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:38:08.948403 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:38:08.948543 [info ] [MainThread]: Required dependencies:
[0m17:38:08.948735 [debug] [MainThread]: Executing "git --help"
[0m17:38:08.956364 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:38:08.956914 [debug] [MainThread]: STDERR: "b''"
[0m17:38:08.957094 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:38:08.957265 [info ] [MainThread]: Connection:
[0m17:38:08.957607 [info ] [MainThread]:   account: buzdqxk-zzb74534
[0m17:38:08.957736 [info ] [MainThread]:   user: dbt
[0m17:38:08.957858 [info ] [MainThread]:   database: AIRBNB
[0m17:38:08.957977 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:38:08.958094 [info ] [MainThread]:   role: transform
[0m17:38:08.958216 [info ] [MainThread]:   schema: DEV
[0m17:38:08.958336 [info ] [MainThread]:   authenticator: None
[0m17:38:08.958450 [info ] [MainThread]:   oauth_client_id: None
[0m17:38:08.958564 [info ] [MainThread]:   query_tag: None
[0m17:38:08.958676 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:38:08.958792 [info ] [MainThread]:   host: None
[0m17:38:08.958915 [info ] [MainThread]:   port: None
[0m17:38:08.959031 [info ] [MainThread]:   proxy_host: None
[0m17:38:08.959144 [info ] [MainThread]:   proxy_port: None
[0m17:38:08.959260 [info ] [MainThread]:   protocol: None
[0m17:38:08.959376 [info ] [MainThread]:   connect_retries: 1
[0m17:38:08.959494 [info ] [MainThread]:   connect_timeout: None
[0m17:38:08.959608 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:38:08.959724 [info ] [MainThread]:   retry_all: False
[0m17:38:08.959837 [info ] [MainThread]:   insecure_mode: False
[0m17:38:08.959950 [info ] [MainThread]:   reuse_connections: None
[0m17:38:08.960326 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:08.964189 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:38:08.965102 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:38:08.965285 [debug] [MainThread]: On debug: select 1 as id
[0m17:38:08.965427 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:10.171215 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.206 seconds
[0m17:38:10.172803 [debug] [MainThread]: On debug: Close
[0m17:38:10.373499 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:38:10.374481 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:38:10.377065 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6769943, "process_user_time": 0.888894, "process_kernel_time": 0.157712, "process_mem_max_rss": "128008192", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:10.377965 [debug] [MainThread]: Command `dbt debug` succeeded at 17:38:10.377814 after 1.68 seconds
[0m17:38:10.378443 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:38:10.378914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113862240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108af500>]}
[0m17:38:10.379423 [debug] [MainThread]: Flushing usage events
[0m17:38:17.190566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10285de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a438c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a43650>]}


============================== 17:38:17.192958 | 12e41d1e-9144-4be7-b352-14a5e3578406 ==============================
[0m17:38:17.192958 [info ] [MainThread]: Running with dbt=1.8.0
[0m17:38:17.193271 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:38:17.378753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c7470>]}
[0m17:38:17.401095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11841bfb0>]}
[0m17:38:17.401507 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m17:38:17.410413 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m17:38:17.410940 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:38:17.411156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ceae0>]}
[0m17:38:18.019819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189171d0>]}
[0m17:38:18.062397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118b31730>]}
[0m17:38:18.062682 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 459 macros
[0m17:38:18.062868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11891c6b0>]}
[0m17:38:18.063804 [info ] [MainThread]: 
[0m17:38:18.064090 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:38:18.066064 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:38:18.072948 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:38:18.073173 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:38:18.073316 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:18.836134 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.763 seconds
[0m17:38:18.839095 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:38:19.037243 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m17:38:19.038207 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m17:38:19.046262 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m17:38:19.046674 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m17:38:19.046990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:19.601920 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.555 seconds
[0m17:38:19.604150 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m17:38:19.763345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m17:38:19.775211 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:38:19.775637 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m17:38:19.775954 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:20.515051 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.739 seconds
[0m17:38:20.518766 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:38:20.676922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118485370>]}
[0m17:38:20.677831 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:20.678347 [info ] [MainThread]: 
[0m17:38:20.682709 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m17:38:20.683281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m17:38:20.683718 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m17:38:20.692904 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m17:38:20.695043 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m17:38:20.695504 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m17:38:20.696106 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m17:38:20.696543 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m17:38:20.699508 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m17:38:20.700388 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m17:38:20.700701 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m17:38:20.701127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m17:38:20.701596 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m17:38:20.704118 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m17:38:20.705145 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m17:38:20.705529 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m17:38:20.706097 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m17:38:20.706459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m17:38:20.706730 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m17:38:20.710247 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m17:38:20.710780 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m17:38:20.730456 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m17:38:20.731633 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m17:38:20.731892 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.raw.raw_hosts
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m17:38:20.732111 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:21.681593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.949 seconds
[0m17:38:21.706269 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m17:38:21.891072 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118448ec0>]}
[0m17:38:21.892270 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.18s]
[0m17:38:21.893220 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m17:38:21.893975 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m17:38:21.894549 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m17:38:21.895237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m17:38:21.895623 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m17:38:21.903450 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m17:38:21.904340 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m17:38:21.907359 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m17:38:21.908895 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m17:38:21.909309 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m17:38:21.909785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:22.840681 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.931 seconds
[0m17:38:22.845235 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m17:38:23.013543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fc1340>]}
[0m17:38:23.014831 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.12s]
[0m17:38:23.015919 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m17:38:23.016580 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m17:38:23.017419 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:38:23.018092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m17:38:23.018627 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m17:38:23.025036 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m17:38:23.026226 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m17:38:23.061837 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m17:38:23.062894 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m17:38:23.063137 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

        );
[0m17:38:23.063354 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:26.602579 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.539 seconds
[0m17:38:26.614970 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:38:26.621526 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m17:38:26.621896 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:38:26.789213 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.167 seconds
[0m17:38:26.792726 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m17:38:26.948268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118eb2510>]}
[0m17:38:26.949088 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 3.93s]
[0m17:38:26.949527 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m17:38:26.949828 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m17:38:26.950214 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m17:38:26.950577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m17:38:26.950833 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m17:38:26.953612 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m17:38:26.954399 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m17:38:26.961166 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m17:38:26.962274 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m17:38:26.962565 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m17:38:26.962827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:28.850457 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.887 seconds
[0m17:38:28.854407 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m17:38:29.003613 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12e41d1e-9144-4be7-b352-14a5e3578406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1199100e0>]}
[0m17:38:29.004918 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.05s]
[0m17:38:29.005849 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m17:38:29.007471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:29.007946 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.dim_listings_with_hosts' was properly closed.
[0m17:38:29.008679 [info ] [MainThread]: 
[0m17:38:29.009110 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 1 table model in 0 hours 0 minutes and 10.94 seconds (10.94s).
[0m17:38:29.010305 [debug] [MainThread]: Command end result
[0m17:38:29.037890 [info ] [MainThread]: 
[0m17:38:29.038399 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:29.038777 [info ] [MainThread]: 
[0m17:38:29.039033 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:38:29.040192 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.878365, "process_user_time": 2.040735, "process_kernel_time": 0.21654, "process_mem_max_rss": "142327808", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:38:29.040585 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:29.040522 after 11.88 seconds
[0m17:38:29.040863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10589d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11821af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a43800>]}
[0m17:38:29.041118 [debug] [MainThread]: Flushing usage events
[0m15:54:24.413491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0e780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10591fc80>]}


============================== 15:54:24.416330 | 794a2190-e6fd-48de-b9cc-99c13f9ce5d6 ==============================
[0m15:54:24.416330 [info ] [MainThread]: Running with dbt=1.8.0
[0m15:54:24.416645 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:54:24.668128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053545c0>]}
[0m15:54:24.690466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746fb30>]}
[0m15:54:24.691061 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m15:54:24.701721 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m15:54:24.770890 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m15:54:24.771212 [debug] [MainThread]: Partial parsing: deleted file: AIRBNB_DBT://models/dataConversion.py
[0m15:54:24.810221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b7c20>]}
[0m15:54:24.859581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a192b0>]}
[0m15:54:24.859888 [info ] [MainThread]: Found 7 models, 1 seed, 3 sources, 459 macros
[0m15:54:24.860076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077bed50>]}
[0m15:54:24.860990 [info ] [MainThread]: 
[0m15:54:24.861290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:24.861741 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m15:54:24.869450 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m15:54:24.869738 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m15:54:24.869898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:26.491800 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.621 seconds
[0m15:54:26.495462 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m15:54:26.747118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m15:54:26.757552 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m15:54:26.757922 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m15:54:26.758191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:54:27.384600 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.626 seconds
[0m15:54:27.389059 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m15:54:27.568541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107839430>]}
[0m15:54:27.569456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:54:27.569891 [info ] [MainThread]: 
[0m15:54:27.574510 [debug] [Thread-1 (]: Began running node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:54:27.575175 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m15:54:27.575646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now seed.AIRBNB_DBT.seed_full_moon_dates)
[0m15:54:27.576419 [debug] [Thread-1 (]: Began compiling node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:54:27.576827 [debug] [Thread-1 (]: Began executing node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:54:27.608605 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:54:27.608963 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (full_moon_date date)
[0m15:54:27.609187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:54:28.454643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.845 seconds
[0m15:54:28.467970 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:54:28.468426 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
BEGIN
[0m15:54:28.602539 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.133 seconds
[0m15:54:28.606977 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:54:28.607733 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s)...
[0m15:54:29.537984 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 0.929 seconds
[0m15:54:29.539533 [debug] [Thread-1 (]: Using snowflake connection "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:54:29.540202 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "seed.AIRBNB_DBT.seed_full_moon_dates"} */
COMMIT
[0m15:54:29.914436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.373 seconds
[0m15:54:29.925648 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.AIRBNB_DBT.seed_full_moon_dates"
[0m15:54:29.950084 [debug] [Thread-1 (]: On seed.AIRBNB_DBT.seed_full_moon_dates: Close
[0m15:54:30.106731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '794a2190-e6fd-48de-b9cc-99c13f9ce5d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105333530>]}
[0m15:54:30.107578 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 2.53s]
[0m15:54:30.108081 [debug] [Thread-1 (]: Finished running node seed.AIRBNB_DBT.seed_full_moon_dates
[0m15:54:30.109209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:30.109491 [debug] [MainThread]: Connection 'seed.AIRBNB_DBT.seed_full_moon_dates' was properly closed.
[0m15:54:30.109737 [info ] [MainThread]: 
[0m15:54:30.110005 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 5.25 seconds (5.25s).
[0m15:54:30.110489 [debug] [MainThread]: Command end result
[0m15:54:30.130701 [info ] [MainThread]: 
[0m15:54:30.131042 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:30.131248 [info ] [MainThread]: 
[0m15:54:30.131448 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:54:30.133318 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.7552214, "process_user_time": 1.252295, "process_kernel_time": 0.206083, "process_mem_max_rss": "135659520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m15:54:30.133709 [debug] [MainThread]: Command `dbt seed` succeeded at 15:54:30.133653 after 5.76 seconds
[0m15:54:30.133974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d52b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107490680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fc9b0>]}
[0m15:54:30.134202 [debug] [MainThread]: Flushing usage events
[0m16:34:32.930744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10396fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10396cbc0>]}


============================== 16:34:32.933636 | 4540a34c-ef84-4ed8-9e19-3e749ba01a65 ==============================
[0m16:34:32.933636 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:34:32.933955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt source freshness', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:34:33.144294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4540a34c-ef84-4ed8-9e19-3e749ba01a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bbc320>]}
[0m16:34:33.166562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4540a34c-ef84-4ed8-9e19-3e749ba01a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c4b00>]}
[0m16:34:33.168033 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:34:33.177672 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:34:33.242612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:33.242874 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:33.261536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4540a34c-ef84-4ed8-9e19-3e749ba01a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43260>]}
[0m16:34:33.311159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4540a34c-ef84-4ed8-9e19-3e749ba01a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3e840>]}
[0m16:34:33.311489 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 459 macros
[0m16:34:33.311683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4540a34c-ef84-4ed8-9e19-3e749ba01a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a1d340>]}
[0m16:34:33.312684 [info ] [MainThread]: 
[0m16:34:33.312993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:34:33.315193 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m16:34:33.324253 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:34:33.324531 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:34:33.324680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:34.165525 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.841 seconds
[0m16:34:34.169081 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:34:34.368581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4540a34c-ef84-4ed8-9e19-3e749ba01a65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580cc80>]}
[0m16:34:34.369607 [info ] [MainThread]: Pulling freshness from warehouse metadata tables for 0 sources
[0m16:34:34.370203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:34:34.370634 [info ] [MainThread]: 
[0m16:34:34.375114 [debug] [Thread-1 (]: Began running node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:34:34.375643 [info ] [Thread-1 (]: 1 of 1 START freshness of AIRBNB.reviews ....................................... [RUN]
[0m16:34:34.376143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now source.AIRBNB_DBT.AIRBNB.reviews)
[0m16:34:34.376966 [debug] [Thread-1 (]: Began compiling node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:34:34.377381 [debug] [Thread-1 (]: Began executing node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:34:34.386835 [debug] [Thread-1 (]: Using snowflake connection "source.AIRBNB_DBT.AIRBNB.reviews"
[0m16:34:34.387283 [debug] [Thread-1 (]: On source.AIRBNB_DBT.AIRBNB.reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "source.AIRBNB_DBT.AIRBNB.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m16:34:34.387588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:35.516543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.128 seconds
[0m16:34:35.522203 [debug] [Thread-1 (]: On source.AIRBNB_DBT.AIRBNB.reviews: Close
[0m16:34:35.674124 [error] [Thread-1 (]: 1 of 1 ERROR STALE freshness of AIRBNB.reviews ................................. [[31mERROR STALE[0m in 1.30s]
[0m16:34:35.674837 [debug] [Thread-1 (]: Finished running node source.AIRBNB_DBT.AIRBNB.reviews
[0m16:34:35.677084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:35.677624 [debug] [MainThread]: Connection 'source.AIRBNB_DBT.AIRBNB.reviews' was properly closed.
[0m16:34:35.678070 [info ] [MainThread]: 
[0m16:34:35.678472 [info ] [MainThread]: Finished running 1 source in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m16:34:35.705860 [info ] [MainThread]: 
[0m16:34:35.706204 [info ] [MainThread]: Done.
[0m16:34:35.943921 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_wall_clock_time": 3.0438902, "process_user_time": 1.089117, "process_kernel_time": 0.177112, "process_mem_max_rss": "134070272", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:34:35.946500 [debug] [MainThread]: Command `dbt source freshness` failed at 16:34:35.946180 after 3.05 seconds
[0m16:34:35.947436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b837d0>]}
[0m16:34:35.948063 [debug] [MainThread]: Flushing usage events
[0m16:36:47.392383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104655bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fb980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fb6e0>]}


============================== 16:36:47.395668 | 379c033d-656c-4ef0-a1a0-110567339833 ==============================
[0m16:36:47.395668 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:36:47.396061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:47.466909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '379c033d-656c-4ef0-a1a0-110567339833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069294f0>]}
[0m16:36:47.478326 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12080404, "process_user_time": 0.637417, "process_kernel_time": 0.107755, "process_mem_max_rss": "95846400", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:36:47.478611 [debug] [MainThread]: Command `dbt clean` succeeded at 16:36:47.478567 after 0.12 seconds
[0m16:36:47.478806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104655bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a212e0>]}
[0m16:36:47.478973 [debug] [MainThread]: Flushing usage events
[0m16:36:52.761757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb0bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540b5f0>]}


============================== 16:36:52.764187 | b65df5f7-f2ef-42ce-8a85-5cf497e4eee6 ==============================
[0m16:36:52.764187 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:36:52.764515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:36:53.003870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ccbc0>]}
[0m16:36:53.028685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072cc6b0>]}
[0m16:36:53.030165 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:36:53.040495 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:36:53.041085 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:36:53.041291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ae990>]}
[0m16:36:53.690801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ba600>]}
[0m16:36:53.746667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108230950>]}
[0m16:36:53.747011 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 459 macros
[0m16:36:53.747221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076da720>]}
[0m16:36:53.748282 [info ] [MainThread]: 
[0m16:36:53.748614 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:36:53.750923 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:36:53.758096 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:36:53.758366 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:36:53.758525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:54.674777 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.916 seconds
[0m16:36:54.677776 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:36:54.855718 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:36:54.866767 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:36:54.867257 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:36:54.867554 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:55.450565 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.583 seconds
[0m16:36:55.454469 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:36:55.626528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103683fb0>]}
[0m16:36:55.627579 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:36:55.628004 [info ] [MainThread]: 
[0m16:36:55.632184 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m16:36:55.632835 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m16:36:55.633198 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m16:36:55.642056 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m16:36:55.643820 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m16:36:55.644291 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m16:36:55.644915 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m16:36:55.645350 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m16:36:55.648106 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m16:36:55.649077 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m16:36:55.649403 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m16:36:55.649879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m16:36:55.650370 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m16:36:55.653101 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m16:36:55.653856 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m16:36:55.654183 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:36:55.654810 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m16:36:55.655668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m16:36:55.656094 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:36:55.660091 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:36:55.660815 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:36:55.680713 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:36:55.681751 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m16:36:55.681991 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.raw.raw_hosts
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m16:36:55.682199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:56.628754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.946 seconds
[0m16:36:56.654938 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m16:36:56.800887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107249040>]}
[0m16:36:56.801746 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 1.14s]
[0m16:36:56.802371 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m16:36:56.802792 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:36:56.803368 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m16:36:56.803894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m16:36:56.804295 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:36:56.812778 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:36:56.813785 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:36:56.816681 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:36:56.818059 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m16:36:56.818422 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m16:36:56.818763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:57.649610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.830 seconds
[0m16:36:57.652879 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m16:36:57.812263 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087205f0>]}
[0m16:36:57.813767 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.01s]
[0m16:36:57.814674 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m16:36:57.815306 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m16:36:57.816496 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m16:36:57.817133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m16:36:57.817575 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m16:36:57.826622 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m16:36:57.827747 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m16:36:57.854274 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:57.854710 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m16:36:57.854960 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:58.775498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.920 seconds
[0m16:36:58.784031 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:58.784476 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:36:58.921925 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.137 seconds
[0m16:36:58.927009 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:58.927530 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m16:36:59.032132 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.104 seconds
[0m16:36:59.049864 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:59.050502 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:36:59.285872 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.235 seconds
[0m16:36:59.290528 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:59.290810 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m16:36:59.423657 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.132 seconds
[0m16:36:59.432322 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:36:59.442695 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m16:36:59.443413 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:59.443602 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m16:36:59.608788 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.165 seconds
[0m16:36:59.609931 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:36:59.610487 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m16:37:00.415446 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.804 seconds
[0m16:37:00.417319 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:37:00.417877 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m16:37:00.706699 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m16:37:00.719918 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m16:37:00.726761 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m16:37:00.727153 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m16:37:00.923285 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m16:37:00.926456 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m16:37:01.078991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b0500>]}
[0m16:37:01.079962 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.26s]
[0m16:37:01.080399 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m16:37:01.080635 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:37:01.080874 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m16:37:01.081289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m16:37:01.081615 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:37:01.083468 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:37:01.083951 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:37:01.097259 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:37:01.098035 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m16:37:01.098241 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m16:37:01.098420 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:03.196730 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.098 seconds
[0m16:37:03.201727 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m16:37:03.357851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10839aed0>]}
[0m16:37:03.359300 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.28s]
[0m16:37:03.360071 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m16:37:03.360611 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fool_moon_reviews
[0m16:37:03.361300 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.fool_moon_reviews ............................. [RUN]
[0m16:37:03.362067 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_with_hosts, now model.AIRBNB_DBT.fool_moon_reviews)
[0m16:37:03.362591 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fool_moon_reviews
[0m16:37:03.367732 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fool_moon_reviews"
[0m16:37:03.368821 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fool_moon_reviews
[0m16:37:03.372084 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fool_moon_reviews"
[0m16:37:03.373874 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fool_moon_reviews"
[0m16:37:03.374300 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fool_moon_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fool_moon_reviews"} */
create or replace transient table AIRBNB.DEV.fool_moon_reviews
         as
        (

WITH fct_reviews AS(
    SELECT * FROM AIRBNB.DEV.fct_reviews
),

full_moon_dates AS(
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)

SELECT r.*,
  CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
  END AS is_full_moon
FROM
  fct_reviews
  r
  LEFT JOIN full_moon_dates
  fm
  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m16:37:03.374669 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:09.961896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.587 seconds
[0m16:37:09.966403 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fool_moon_reviews: Close
[0m16:37:10.110132 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b65df5f7-f2ef-42ce-8a85-5cf497e4eee6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087ce720>]}
[0m16:37:10.111581 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.fool_moon_reviews ........................ [[32mSUCCESS 1[0m in 6.75s]
[0m16:37:10.112483 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fool_moon_reviews
[0m16:37:10.114298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:10.114866 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fool_moon_reviews' was properly closed.
[0m16:37:10.115397 [info ] [MainThread]: 
[0m16:37:10.115820 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 16.37 seconds (16.37s).
[0m16:37:10.117170 [debug] [MainThread]: Command end result
[0m16:37:10.145534 [info ] [MainThread]: 
[0m16:37:10.145898 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:10.146126 [info ] [MainThread]: 
[0m16:37:10.146353 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:37:10.148363 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.41772, "process_user_time": 2.189642, "process_kernel_time": 0.254634, "process_mem_max_rss": "141148160", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:37:10.148736 [debug] [MainThread]: Command `dbt run` succeeded at 16:37:10.148676 after 17.42 seconds
[0m16:37:10.148998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077318e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077304a0>]}
[0m16:37:10.149248 [debug] [MainThread]: Flushing usage events
[0m16:48:56.713307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e8ec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b29d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10416f440>]}


============================== 16:48:56.716197 | ea58ff29-69c1-423d-b43e-79edc99b3dd5 ==============================
[0m16:48:56.716197 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:48:56.716549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:48:56.944909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea58ff29-69c1-423d-b43e-79edc99b3dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bbef30>]}
[0m16:48:56.967763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea58ff29-69c1-423d-b43e-79edc99b3dd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b83dd0>]}
[0m16:48:56.968400 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:48:56.978064 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:48:57.044787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:48:57.045133 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://snapshots/scd_raw_listings.sql
[0m16:48:57.129183 [error] [MainThread]: Encountered an error:
Compilation Error
  Snapshot 'snapshot.AIRBNB_DBT.scd_raw_listings' (snapshots/scd_raw_listings.sql) depends on a source named 'airbnb.listings' which was not found
[0m16:48:57.131898 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_wall_clock_time": 0.4499471, "process_user_time": 0.869509, "process_kernel_time": 0.147933, "process_mem_max_rss": "123650048", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:48:57.132236 [debug] [MainThread]: Command `dbt snapshot` failed at 16:48:57.132182 after 0.45 seconds
[0m16:48:57.132474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c5f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf1fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a80dd0>]}
[0m16:48:57.132665 [debug] [MainThread]: Flushing usage events
[0m16:49:12.656619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a77920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a776e0>]}


============================== 16:49:12.658894 | e0076969-cd5a-45d1-8a98-d3aa1fc4bc22 ==============================
[0m16:49:12.658894 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:49:12.659200 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:49:12.840728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090deae0>]}
[0m16:49:12.862937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a77800>]}
[0m16:49:12.863331 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:49:12.871683 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:49:12.929124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:49:12.929490 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://snapshots/scd_raw_listings.sql
[0m16:49:13.052331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4eb10>]}
[0m16:49:13.105039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a6a930>]}
[0m16:49:13.105328 [info ] [MainThread]: Found 8 models, 1 seed, 1 snapshot, 3 sources, 459 macros
[0m16:49:13.105518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109701c70>]}
[0m16:49:13.106463 [info ] [MainThread]: 
[0m16:49:13.106763 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:49:13.107190 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:49:13.113700 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:49:13.113931 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:49:13.114083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:14.107954 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.993 seconds
[0m16:49:14.114819 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:49:14.295143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:49:14.306630 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:49:14.307076 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:49:14.307362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:15.150850 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.843 seconds
[0m16:49:15.157626 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:49:15.289634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f52e0>]}
[0m16:49:15.290796 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:49:15.291318 [info ] [MainThread]: 
[0m16:49:15.295877 [debug] [Thread-1 (]: Began running node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:49:15.296578 [info ] [Thread-1 (]: 1 of 1 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m16:49:15.297114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.AIRBNB_DBT.scd_raw_listings)
[0m16:49:15.297774 [debug] [Thread-1 (]: Began compiling node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:49:15.307826 [debug] [Thread-1 (]: Began executing node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:49:15.357549 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:49:15.357926 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        

select * FROM AIRBNB.raw.raw_listings
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m16:49:15.358148 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:16.416977 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.058 seconds
[0m16:49:16.432228 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:49:16.432938 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m16:49:16.634498 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.201 seconds
[0m16:49:16.636972 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:49:16.641214 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:49:16.641927 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
create or replace transient table AIRBNB.DEV.scd_raw_listings
         as
        (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        

select * FROM AIRBNB.raw.raw_listings
    ) sbq



        );
[0m16:49:17.959207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.316 seconds
[0m16:49:17.982837 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: Close
[0m16:49:18.121777 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0076969-cd5a-45d1-8a98-d3aa1fc4bc22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094b8e30>]}
[0m16:49:18.123034 [info ] [Thread-1 (]: 1 of 1 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 2.82s]
[0m16:49:18.123825 [debug] [Thread-1 (]: Finished running node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:49:18.125290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:18.125659 [debug] [MainThread]: Connection 'snapshot.AIRBNB_DBT.scd_raw_listings' was properly closed.
[0m16:49:18.126019 [info ] [MainThread]: 
[0m16:49:18.126391 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m16:49:18.127089 [debug] [MainThread]: Command end result
[0m16:49:18.200018 [info ] [MainThread]: 
[0m16:49:18.200305 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:18.200466 [info ] [MainThread]: 
[0m16:49:18.200628 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:49:18.201483 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.5726047, "process_user_time": 1.38428, "process_kernel_time": 0.185288, "process_mem_max_rss": "138903552", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:49:18.201762 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:49:18.201719 after 5.57 seconds
[0m16:49:18.201942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd6db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd7ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fd6d50>]}
[0m16:49:18.202117 [debug] [MainThread]: Flushing usage events
[0m16:51:30.483777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12269ec30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122843a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1228437a0>]}


============================== 16:51:30.486080 | c7ac8e34-fa82-43ce-a4c3-c69cc3591f43 ==============================
[0m16:51:30.486080 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:51:30.486613 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt snapshot', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:51:30.670431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123109970>]}
[0m16:51:30.692822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12354b9e0>]}
[0m16:51:30.693223 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m16:51:30.702303 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m16:51:30.767039 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:51:30.767402 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://snapshots/scd_raw_hosts.sql
[0m16:51:30.878629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123bdb110>]}
[0m16:51:30.925453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123c16a80>]}
[0m16:51:30.925724 [info ] [MainThread]: Found 8 models, 1 seed, 2 snapshots, 3 sources, 459 macros
[0m16:51:30.925914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123959dc0>]}
[0m16:51:30.926858 [info ] [MainThread]: 
[0m16:51:30.927160 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:51:30.929137 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m16:51:30.936430 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m16:51:30.936707 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m16:51:30.936871 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:31.860643 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.923 seconds
[0m16:51:31.865797 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m16:51:32.080186 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m16:51:32.093232 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m16:51:32.093694 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m16:51:32.094008 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:32.689027 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.595 seconds
[0m16:51:32.693060 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m16:51:32.835172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074effe0>]}
[0m16:51:32.835922 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:51:32.836336 [info ] [MainThread]: 
[0m16:51:32.839137 [debug] [Thread-1 (]: Began running node snapshot.AIRBNB_DBT.scd_raw_hosts
[0m16:51:32.839779 [info ] [Thread-1 (]: 1 of 2 START snapshot DEV.scd_raw_hosts ........................................ [RUN]
[0m16:51:32.840277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.AIRBNB_DBT.scd_raw_hosts)
[0m16:51:32.840667 [debug] [Thread-1 (]: Began compiling node snapshot.AIRBNB_DBT.scd_raw_hosts
[0m16:51:32.850255 [debug] [Thread-1 (]: Began executing node snapshot.AIRBNB_DBT.scd_raw_hosts
[0m16:51:32.899089 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_hosts"
[0m16:51:32.899460 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_hosts"} */
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_hosts"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        


select * FROM AIRBNB.raw.raw_hosts
    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m16:51:32.899675 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:33.711440 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.811 seconds
[0m16:51:33.720226 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_hosts"
[0m16:51:33.720782 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_hosts"} */
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_hosts"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m16:51:34.001341 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.280 seconds
[0m16:51:34.002903 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.AIRBNB_DBT.scd_raw_hosts"
[0m16:51:34.004904 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_hosts"
[0m16:51:34.005271 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_hosts: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_hosts"} */
create or replace transient table AIRBNB.DEV.scd_raw_hosts
         as
        (
    

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to

    from (
        


select * FROM AIRBNB.raw.raw_hosts
    ) sbq



        );
[0m16:51:35.419958 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.414 seconds
[0m16:51:35.448287 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_hosts: Close
[0m16:51:35.615265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123548da0>]}
[0m16:51:35.616194 [info ] [Thread-1 (]: 1 of 2 OK snapshotted DEV.scd_raw_hosts ........................................ [[32mSUCCESS 1[0m in 2.77s]
[0m16:51:35.616691 [debug] [Thread-1 (]: Finished running node snapshot.AIRBNB_DBT.scd_raw_hosts
[0m16:51:35.617060 [debug] [Thread-1 (]: Began running node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:51:35.617549 [info ] [Thread-1 (]: 2 of 2 START snapshot DEV.scd_raw_listings ..................................... [RUN]
[0m16:51:35.617940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.AIRBNB_DBT.scd_raw_hosts, now snapshot.AIRBNB_DBT.scd_raw_listings)
[0m16:51:35.618228 [debug] [Thread-1 (]: Began compiling node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:51:35.621029 [debug] [Thread-1 (]: Began executing node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:51:35.628729 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:35.629128 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m16:51:35.629363 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:51:36.270323 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.640 seconds
[0m16:51:36.295985 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:36.296436 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (

    with snapshot_query as (

        

select * FROM AIRBNB.raw.raw_listings

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m16:51:37.760674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.463 seconds
[0m16:51:37.767598 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:37.768212 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m16:51:37.907548 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.139 seconds
[0m16:51:37.912958 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:37.913437 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m16:51:38.040132 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.126 seconds
[0m16:51:38.048220 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:38.048603 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m16:51:38.170978 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.122 seconds
[0m16:51:38.178362 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:38.179162 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m16:51:38.296847 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.117 seconds
[0m16:51:38.308245 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:38.308612 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m16:51:38.432772 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.124 seconds
[0m16:51:38.450205 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:38.450952 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
select * from (
        

    with snapshot_query as (

        

select * FROM AIRBNB.raw.raw_listings

    ),

    snapshotted_data as (

        select *, 
    
        id as dbt_unique_key
    

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where
            
                dbt_valid_to is null
            

    ),

    insertions_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            
  
  coalesce(nullif(updated_at, updated_at), null)
  as dbt_valid_to
,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select *, 
    
        id as dbt_unique_key
    
,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select *, 
    
        id as dbt_unique_key
    

        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        snapshotted_data.dbt_unique_key is null
    

            or (
    
        snapshotted_data.dbt_unique_key is not null
    
 and ((snapshotted_data.dbt_valid_from < source_data.updated_at))

        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data
            on 
    
        snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
    

            where 
    
        source_data.dbt_unique_key is null
    

    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

    ) as __dbt_sbq
    where false
    limit 0
[0m16:51:39.026649 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.575 seconds
[0m16:51:39.031488 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:39.032623 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
/* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m16:51:39.230501 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.197 seconds
[0m16:51:39.232884 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:39.235276 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:39.235778 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
BEGIN
[0m16:51:39.597148 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.360 seconds
[0m16:51:39.599118 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:39.600295 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     
       and DBT_INTERNAL_DEST.dbt_valid_to is null
     
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m16:51:40.255042 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.653 seconds
[0m16:51:40.257196 [debug] [Thread-1 (]: Using snowflake connection "snapshot.AIRBNB_DBT.scd_raw_listings"
[0m16:51:40.258219 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "snapshot.AIRBNB_DBT.scd_raw_listings"} */
COMMIT
[0m16:51:40.563189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.304 seconds
[0m16:51:40.571881 [debug] [Thread-1 (]: On snapshot.AIRBNB_DBT.scd_raw_listings: Close
[0m16:51:40.730087 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7ac8e34-fa82-43ce-a4c3-c69cc3591f43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126805e20>]}
[0m16:51:40.732222 [info ] [Thread-1 (]: 2 of 2 OK snapshotted DEV.scd_raw_listings ..................................... [[32mSUCCESS 0[0m in 5.11s]
[0m16:51:40.733200 [debug] [Thread-1 (]: Finished running node snapshot.AIRBNB_DBT.scd_raw_listings
[0m16:51:40.735005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:40.735397 [debug] [MainThread]: Connection 'snapshot.AIRBNB_DBT.scd_raw_listings' was properly closed.
[0m16:51:40.735743 [info ] [MainThread]: 
[0m16:51:40.736072 [info ] [MainThread]: Finished running 2 snapshots in 0 hours 0 minutes and 9.81 seconds (9.81s).
[0m16:51:40.736856 [debug] [MainThread]: Command end result
[0m16:51:40.764614 [info ] [MainThread]: 
[0m16:51:40.765039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:51:40.765283 [info ] [MainThread]: 
[0m16:51:40.765503 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:51:40.766717 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 10.311154, "process_user_time": 1.604275, "process_kernel_time": 0.196083, "process_mem_max_rss": "137691136", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:51:40.767137 [debug] [MainThread]: Command `dbt snapshot` succeeded at 16:51:40.767075 after 10.31 seconds
[0m16:51:40.767398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b47da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12281d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12281dee0>]}
[0m16:51:40.767640 [debug] [MainThread]: Flushing usage events
[0m20:12:44.876467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eda540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124039b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112403740>]}


============================== 20:12:44.879327 | 4a65f3fa-5138-49bb-9e1e-4d8f8f1e7d57 ==============================
[0m20:12:44.879327 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:12:44.879680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt clean', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:12:44.958488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a65f3fa-5138-49bb-9e1e-4d8f8f1e7d57', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124037a0>]}
[0m20:12:44.971096 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.12519959, "process_user_time": 0.632683, "process_kernel_time": 0.109808, "process_mem_max_rss": "95404032", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:12:44.971470 [debug] [MainThread]: Command `dbt clean` succeeded at 20:12:44.971403 after 0.13 seconds
[0m20:12:44.971717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b96240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112436ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104986b70>]}
[0m20:12:44.971983 [debug] [MainThread]: Flushing usage events
[0m20:12:48.008332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10337a060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e979b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e97620>]}


============================== 20:12:48.010688 | 355b410c-1f7a-46b9-a369-0dfe52cc4ce2 ==============================
[0m20:12:48.010688 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:12:48.011005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:48.229499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '355b410c-1f7a-46b9-a369-0dfe52cc4ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7590>]}
[0m20:12:48.251696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '355b410c-1f7a-46b9-a369-0dfe52cc4ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055dac60>]}
[0m20:12:48.253094 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:12:48.262025 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:12:48.262643 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m20:12:48.262897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '355b410c-1f7a-46b9-a369-0dfe52cc4ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593ec30>]}
[0m20:12:48.265908 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading AIRBNB_DBT: schema.yml - Runtime Error
    Syntax error near line 11
    ------------------------------
    8  |             - unique
    9  |             - not_null
    10 |     - name: host_id
    11 |         tests:
    12 |             - not_null
    13 |             - relationships:
    14 |                 to: ref('dim_hosts_cleansed')
    
    Raw Error:
    ------------------------------
    mapping values are not allowed in this context
      in "<unicode string>", line 11, column 14
[0m20:12:48.266884 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.28718644, "process_user_time": 0.740297, "process_kernel_time": 0.128728, "process_mem_max_rss": "116162560", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:12:48.267230 [debug] [MainThread]: Command `dbt run` failed at 20:12:48.267178 after 0.29 seconds
[0m20:12:48.267463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e97980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b21d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f5e3f0>]}
[0m20:12:48.267719 [debug] [MainThread]: Flushing usage events
[0m20:19:35.576455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a849e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aab800>]}


============================== 20:19:35.579276 | dff9b6d5-cfc2-4d36-b855-070b04a6fe0f ==============================
[0m20:19:35.579276 [info ] [MainThread]: Running with dbt=1.8.0
[0m20:19:35.579625 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m20:19:35.796979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffbd70>]}
[0m20:19:35.820770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105551130>]}
[0m20:19:35.821538 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m20:19:35.830465 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m20:19:35.899764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:19:35.900052 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:19:35.923545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030b1640>]}
[0m20:19:35.986571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cd790>]}
[0m20:19:35.986861 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 seed, 3 sources, 459 macros
[0m20:19:35.987051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105978560>]}
[0m20:19:35.988099 [info ] [MainThread]: 
[0m20:19:35.988410 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:19:35.990484 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m20:19:35.998358 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m20:19:35.998614 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m20:19:35.998762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:19:36.823488 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.824 seconds
[0m20:19:36.827506 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m20:19:37.062120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m20:19:37.073979 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m20:19:37.074416 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m20:19:37.074749 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:19:37.676544 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.601 seconds
[0m20:19:37.681837 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m20:19:37.841408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5a1e0>]}
[0m20:19:37.842203 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m20:19:37.842513 [info ] [MainThread]: 
[0m20:19:37.846039 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_hosts
[0m20:19:37.846424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.src_hosts)
[0m20:19:37.846682 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_hosts
[0m20:19:37.853220 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_hosts"
[0m20:19:37.854381 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_hosts
[0m20:19:37.854659 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_listing
[0m20:19:37.855259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_hosts, now model.AIRBNB_DBT.src_listing)
[0m20:19:37.855606 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_listing
[0m20:19:37.858294 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_listing"
[0m20:19:37.859062 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_listing
[0m20:19:37.859316 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.src_reviews
[0m20:19:37.859754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_listing, now model.AIRBNB_DBT.src_reviews)
[0m20:19:37.860084 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.src_reviews
[0m20:19:37.862007 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.src_reviews"
[0m20:19:37.862594 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.src_reviews
[0m20:19:37.862822 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m20:19:37.863166 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.dim_hosts_cleansed ............................. [RUN]
[0m20:19:37.863428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.src_reviews, now model.AIRBNB_DBT.dim_hosts_cleansed)
[0m20:19:37.863624 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_hosts_cleansed
[0m20:19:37.866349 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m20:19:37.866806 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_hosts_cleansed
[0m20:19:37.883254 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m20:19:37.884412 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_hosts_cleansed"
[0m20:19:37.884658 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_hosts_cleansed"} */
create or replace   view AIRBNB.DEV.dim_hosts_cleansed
  
   as (
    WITH  __dbt__cte__src_hosts as (
WITH raw_hosts AS(
    SELECT * FROM AIRBNB.raw.raw_hosts
)
SELECT 
    id AS host_id,
    name AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM 
    raw_hosts
), src_hosts AS(
    SELECT * FROM __dbt__cte__src_hosts
)
SELECT
    host_id,
    NVL(host_name, 'Anonymous') AS host_name,
    is_superhost,
    created_at,
    updated_at
FROM
    src_hosts
  );
[0m20:19:37.884854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:38.678503 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.793 seconds
[0m20:19:38.702024 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_hosts_cleansed: Close
[0m20:19:38.855195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ece00>]}
[0m20:19:38.855814 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.dim_hosts_cleansed ........................ [[32mSUCCESS 1[0m in 0.99s]
[0m20:19:38.856271 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_hosts_cleansed
[0m20:19:38.856597 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_cleansed
[0m20:19:38.856925 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.dim_listings_cleansed .......................... [RUN]
[0m20:19:38.857259 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_hosts_cleansed, now model.AIRBNB_DBT.dim_listings_cleansed)
[0m20:19:38.857771 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_cleansed
[0m20:19:38.862029 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m20:19:38.862558 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_cleansed
[0m20:19:38.864222 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_cleansed"
[0m20:19:38.865110 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_cleansed"
[0m20:19:38.865354 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_cleansed"} */
create or replace   view AIRBNB.DEV.dim_listings_cleansed
  
   as (
    WITH  __dbt__cte__src_listing as (
WITH raw_listings AS(
    SELECT * FROM AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    listing_url,
    name AS listing_name,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), dim_listings AS(
    SELECT * FROM __dbt__cte__src_listing
)
SELECT
    listing_id,
    listing_url,
    listing_name,
    room_type,
    CASE
        WHEN minimum_nights = 0 THEN 1
        ELSE minimum_nights
    END AS minimum_nights,
    host_id,
    REPLACE(price_str, '$') :: NUMBER(10,2) AS price,
    created_at,
    updated_at
FROM
    dim_listings
  );
[0m20:19:38.865596 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:39.905281 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.039 seconds
[0m20:19:39.908606 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_cleansed: Close
[0m20:19:40.052941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054bdaf0>]}
[0m20:19:40.053476 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.dim_listings_cleansed ..................... [[32mSUCCESS 1[0m in 1.20s]
[0m20:19:40.053827 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_cleansed
[0m20:19:40.054068 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m20:19:40.054505 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m20:19:40.055062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_cleansed, now model.AIRBNB_DBT.fct_reviews)
[0m20:19:40.055331 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m20:19:40.062038 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m20:19:40.062818 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m20:19:40.082375 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:40.082721 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT * FROM src_reviews as r
WHERE r.review_text IS NOT NULL

  AND r.review_date > (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m20:19:40.083040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:41.031342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m20:19:41.042311 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.042796 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m20:19:41.139554 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.096 seconds
[0m20:19:41.143761 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.144254 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m20:19:41.251723 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.107 seconds
[0m20:19:41.267357 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.267846 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m20:19:41.370148 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.102 seconds
[0m20:19:41.374546 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.374926 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m20:19:41.502365 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.127 seconds
[0m20:19:41.510358 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m20:19:41.523349 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.524325 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.524636 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m20:19:41.742692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.218 seconds
[0m20:19:41.743058 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:41.743250 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m20:19:42.569307 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.825 seconds
[0m20:19:42.572742 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:42.573609 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
COMMIT
[0m20:19:42.731090 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.156 seconds
[0m20:19:42.742795 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m20:19:42.747995 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m20:19:42.748292 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m20:19:42.928292 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.179 seconds
[0m20:19:42.933687 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m20:19:43.084517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fbca70>]}
[0m20:19:43.085615 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 0[0m in 3.03s]
[0m20:19:43.086139 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m20:19:43.086506 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m20:19:43.087178 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_with_hosts ....................... [RUN]
[0m20:19:43.088069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.fct_reviews, now model.AIRBNB_DBT.dim_listings_with_hosts)
[0m20:19:43.088478 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.dim_listings_with_hosts
[0m20:19:43.092023 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m20:19:43.092905 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.dim_listings_with_hosts
[0m20:19:43.161518 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m20:19:43.162406 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.dim_listings_with_hosts"
[0m20:19:43.162613 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.dim_listings_with_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_with_hosts
         as
        (

WITH l AS (
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed
),
h AS (
    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed
)
SELECT 
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost AS host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) AS updated_at
FROM l 
LEFT JOIN h
ON (l.host_id = h.host_id)
        );
[0m20:19:43.162797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:45.644839 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.481 seconds
[0m20:19:45.653118 [debug] [Thread-1 (]: On model.AIRBNB_DBT.dim_listings_with_hosts: Close
[0m20:19:45.801637 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10572d130>]}
[0m20:19:45.802893 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_with_hosts .................. [[32mSUCCESS 1[0m in 2.71s]
[0m20:19:45.803815 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.dim_listings_with_hosts
[0m20:19:45.804368 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fool_moon_reviews
[0m20:19:45.805022 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.fool_moon_reviews ............................. [RUN]
[0m20:19:45.805679 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.AIRBNB_DBT.dim_listings_with_hosts, now model.AIRBNB_DBT.fool_moon_reviews)
[0m20:19:45.806154 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fool_moon_reviews
[0m20:19:45.811337 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fool_moon_reviews"
[0m20:19:45.812699 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fool_moon_reviews
[0m20:19:45.816050 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fool_moon_reviews"
[0m20:19:45.817879 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fool_moon_reviews"
[0m20:19:45.818388 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fool_moon_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fool_moon_reviews"} */
create or replace transient table AIRBNB.DEV.fool_moon_reviews
         as
        (

WITH fct_reviews AS(
    SELECT * FROM AIRBNB.DEV.fct_reviews
),

full_moon_dates AS(
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)

SELECT r.*,
  CASE
    WHEN fm.full_moon_date IS NULL THEN 'not full moon'
    ELSE 'full moon'
  END AS is_full_moon
FROM
  fct_reviews
  r
  LEFT JOIN full_moon_dates
  fm
  ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m20:19:45.818774 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:19:49.813494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.994 seconds
[0m20:19:49.818324 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fool_moon_reviews: Close
[0m20:19:49.966960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dff9b6d5-cfc2-4d36-b855-070b04a6fe0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105928320>]}
[0m20:19:49.967852 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.fool_moon_reviews ........................ [[32mSUCCESS 1[0m in 4.16s]
[0m20:19:49.968454 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fool_moon_reviews
[0m20:19:49.969697 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:19:49.969978 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fool_moon_reviews' was properly closed.
[0m20:19:49.970351 [info ] [MainThread]: 
[0m20:19:49.970639 [info ] [MainThread]: Finished running 2 view models, 1 incremental model, 2 table models in 0 hours 0 minutes and 13.98 seconds (13.98s).
[0m20:19:49.971642 [debug] [MainThread]: Command end result
[0m20:19:49.997801 [info ] [MainThread]: 
[0m20:19:49.998150 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:19:49.998356 [info ] [MainThread]: 
[0m20:19:49.998556 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m20:19:50.000482 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.453621, "process_user_time": 1.661595, "process_kernel_time": 0.260586, "process_mem_max_rss": "137805824", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:19:50.000860 [debug] [MainThread]: Command `dbt run` succeeded at 20:19:50.000801 after 14.45 seconds
[0m20:19:50.001109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff0e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff0a10>]}
[0m20:19:50.001343 [debug] [MainThread]: Flushing usage events
[0m21:49:39.358755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d48770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6f950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6f6e0>]}


============================== 21:49:39.361755 | 85d0335d-07f6-4899-bd40-7b8761df1c76 ==============================
[0m21:49:39.361755 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:49:39.362083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:49:39.596952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85d0335d-07f6-4899-bd40-7b8761df1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4b2c0>]}
[0m21:49:39.620169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85d0335d-07f6-4899-bd40-7b8761df1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762a8d0>]}
[0m21:49:39.620787 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:49:39.631031 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:49:39.714307 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:49:39.714610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:49:39.738339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85d0335d-07f6-4899-bd40-7b8761df1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107980d70>]}
[0m21:49:39.811182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85d0335d-07f6-4899-bd40-7b8761df1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e33740>]}
[0m21:49:39.811492 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 seed, 3 sources, 459 macros
[0m21:49:39.811685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85d0335d-07f6-4899-bd40-7b8761df1c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f3740>]}
[0m21:49:39.812605 [info ] [MainThread]: 
[0m21:49:39.812797 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m21:49:39.813656 [debug] [MainThread]: Command end result
[0m21:49:39.828285 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.5005295, "process_user_time": 0.919797, "process_kernel_time": 0.162427, "process_mem_max_rss": "127205376", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:49:39.828719 [debug] [MainThread]: Command `dbt test` succeeded at 21:49:39.828670 after 0.50 seconds
[0m21:49:39.828958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107850260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d2f230>]}
[0m21:49:39.829141 [debug] [MainThread]: Flushing usage events
[0m21:51:37.326136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e36e0>]}


============================== 21:51:37.328857 | 1030b132-4d88-42b7-b8c0-314e582182d5 ==============================
[0m21:51:37.328857 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:51:37.329174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:51:37.542544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1030b132-4d88-42b7-b8c0-314e582182d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105294da0>]}
[0m21:51:37.566726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1030b132-4d88-42b7-b8c0-314e582182d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10521fbf0>]}
[0m21:51:37.568329 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:51:37.577821 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:51:37.650426 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:37.650694 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:37.679247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1030b132-4d88-42b7-b8c0-314e582182d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c0530>]}
[0m21:51:37.743726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1030b132-4d88-42b7-b8c0-314e582182d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ccd40>]}
[0m21:51:37.744015 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 seed, 4 data tests, 3 sources, 459 macros
[0m21:51:37.744205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1030b132-4d88-42b7-b8c0-314e582182d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104571bb0>]}
[0m21:51:37.745239 [info ] [MainThread]: 
[0m21:51:37.745547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:37.747772 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m21:51:37.756169 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m21:51:37.756424 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m21:51:37.756573 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:38.569030 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.812 seconds
[0m21:51:38.576841 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m21:51:38.710435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1030b132-4d88-42b7-b8c0-314e582182d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10314be90>]}
[0m21:51:38.711143 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:51:38.711460 [info ] [MainThread]: 
[0m21:51:38.715282 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:51:38.715707 [info ] [Thread-1 (]: 1 of 4 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m21:51:38.716100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m21:51:38.716765 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:51:38.732609 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:51:38.733679 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:51:38.747605 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:51:38.748525 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:51:38.748804 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m21:51:38.749073 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:40.081129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.332 seconds
[0m21:51:40.094363 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m21:51:40.248240 [info ] [Thread-1 (]: 1 of 4 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.53s]
[0m21:51:40.249465 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:51:40.250182 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:51:40.250933 [info ] [Thread-1 (]: 2 of 4 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m21:51:40.251701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m21:51:40.252253 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:51:40.261887 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:51:40.263253 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:51:40.266007 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:51:40.267007 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:51:40.267370 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m21:51:40.267697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:41.019763 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m21:51:41.022611 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m21:51:41.184938 [info ] [Thread-1 (]: 2 of 4 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.93s]
[0m21:51:41.185385 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:51:41.185616 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:51:41.185853 [info ] [Thread-1 (]: 3 of 4 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m21:51:41.186133 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m21:51:41.186326 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:51:41.191748 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:51:41.192756 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:51:41.196061 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:51:41.197041 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:51:41.197513 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m21:51:41.197891 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:41.669189 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m21:51:41.673807 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m21:51:41.870775 [info ] [Thread-1 (]: 3 of 4 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.68s]
[0m21:51:41.871752 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:51:41.872284 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:51:41.872868 [info ] [Thread-1 (]: 4 of 4 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m21:51:41.873494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m21:51:41.873965 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:51:41.882433 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:51:41.883865 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:51:41.886416 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:51:41.887584 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:51:41.887994 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:51:41.888317 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:51:42.454569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m21:51:42.461637 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m21:51:42.642180 [info ] [Thread-1 (]: 4 of 4 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.77s]
[0m21:51:42.643245 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:51:42.645017 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:42.645560 [debug] [MainThread]: Connection 'test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m21:51:42.646052 [info ] [MainThread]: 
[0m21:51:42.646529 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m21:51:42.647889 [debug] [MainThread]: Command end result
[0m21:51:42.678822 [info ] [MainThread]: 
[0m21:51:42.679280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:51:42.679530 [info ] [MainThread]: 
[0m21:51:42.679793 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m21:51:42.681876 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 5.384689, "process_user_time": 1.370918, "process_kernel_time": 0.208094, "process_mem_max_rss": "138641408", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:51:42.682328 [debug] [MainThread]: Command `dbt test` succeeded at 21:51:42.682263 after 5.39 seconds
[0m21:51:42.682621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048e3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ff860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10519b470>]}
[0m21:51:42.682880 [debug] [MainThread]: Flushing usage events
[0m22:44:28.442427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112853b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149fe930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e07650>]}


============================== 22:44:28.445298 | 3dca32c4-4848-458c-8889-518a68fe17f9 ==============================
[0m22:44:28.445298 [info ] [MainThread]: Running with dbt=1.8.0
[0m22:44:28.445641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:44:28.675779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dca32c4-4848-458c-8889-518a68fe17f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157fa8d0>]}
[0m22:44:28.698786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dca32c4-4848-458c-8889-518a68fe17f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11566b980>]}
[0m22:44:28.699402 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m22:44:28.709555 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m22:44:28.791435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m22:44:28.791801 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://tests/dim_listings_minumum_nights.sql
[0m22:44:28.791971 [debug] [MainThread]: Partial parsing: added file: AIRBNB_DBT://tests/consistent_created_at.sql
[0m22:44:28.888704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dca32c4-4848-458c-8889-518a68fe17f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115eb68d0>]}
[0m22:44:28.959694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dca32c4-4848-458c-8889-518a68fe17f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116404a40>]}
[0m22:44:28.960002 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 seed, 6 data tests, 3 sources, 459 macros
[0m22:44:28.960197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dca32c4-4848-458c-8889-518a68fe17f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115fb68a0>]}
[0m22:44:28.961304 [info ] [MainThread]: 
[0m22:44:28.961618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:44:28.963865 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m22:44:28.971907 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m22:44:28.972187 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m22:44:28.972346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:44:29.845914 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.873 seconds
[0m22:44:29.849782 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m22:44:30.036524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dca32c4-4848-458c-8889-518a68fe17f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115ba6fc0>]}
[0m22:44:30.037367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:44:30.037773 [info ] [MainThread]: 
[0m22:44:30.041814 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m22:44:30.042348 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m22:44:30.042860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m22:44:30.043692 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m22:44:30.060792 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m22:44:30.061939 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m22:44:30.077623 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m22:44:30.078574 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m22:44:30.078900 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m22:44:30.079156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:30.839587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.760 seconds
[0m22:44:30.850538 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m22:44:31.007298 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.96s]
[0m22:44:31.008398 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m22:44:31.009063 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.consistent_created_at
[0m22:44:31.009594 [info ] [Thread-1 (]: 2 of 6 START test consistent_created_at ........................................ [RUN]
[0m22:44:31.010495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.AIRBNB_DBT.consistent_created_at)
[0m22:44:31.011338 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.consistent_created_at
[0m22:44:31.015538 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.consistent_created_at"
[0m22:44:31.016724 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.consistent_created_at
[0m22:44:31.019239 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.consistent_created_at"
[0m22:44:31.021714 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.consistent_created_at"
[0m22:44:31.022512 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM AIRBNB.DEV.dim_listings_cleansed l
INNER JOIN AIRBNB.DEV.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m22:44:31.023009 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:32.681020 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.658 seconds
[0m22:44:32.682462 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: Close
[0m22:44:32.890298 [info ] [Thread-1 (]: 2 of 6 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.88s]
[0m22:44:32.891528 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.consistent_created_at
[0m22:44:32.892079 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m22:44:32.892660 [info ] [Thread-1 (]: 3 of 6 START test dim_listings_minumum_nights .................................. [RUN]
[0m22:44:32.893253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.consistent_created_at, now test.AIRBNB_DBT.dim_listings_minumum_nights)
[0m22:44:32.893683 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m22:44:32.897751 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m22:44:32.898970 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m22:44:32.966235 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m22:44:32.966994 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m22:44:32.967200 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.dim_listings_minumum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m22:44:32.967377 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:34.013580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.045 seconds
[0m22:44:34.020191 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: Close
[0m22:44:34.181689 [info ] [Thread-1 (]: 3 of 6 PASS dim_listings_minumum_nights ........................................ [[32mPASS[0m in 1.29s]
[0m22:44:34.182573 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m22:44:34.183084 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:44:34.183588 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m22:44:34.184213 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.dim_listings_minumum_nights, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m22:44:34.184631 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:44:34.192444 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m22:44:34.193328 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:44:34.196000 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m22:44:34.197065 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m22:44:34.197405 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m22:44:34.197697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:34.815587 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.617 seconds
[0m22:44:34.822057 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m22:44:34.974105 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.79s]
[0m22:44:34.975114 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m22:44:34.975768 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:44:34.976478 [info ] [Thread-1 (]: 5 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m22:44:34.977226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m22:44:34.977696 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:44:34.983965 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m22:44:34.985091 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:44:34.988076 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m22:44:34.989576 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m22:44:34.989970 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m22:44:34.990275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:35.655554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m22:44:35.659564 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m22:44:35.820021 [info ] [Thread-1 (]: 5 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.84s]
[0m22:44:35.821152 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m22:44:35.821824 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:44:35.822509 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m22:44:35.823242 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m22:44:35.823794 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:44:35.832444 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m22:44:35.833692 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:44:35.836462 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m22:44:35.837437 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m22:44:35.837856 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:44:35.838287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:44:36.345703 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.507 seconds
[0m22:44:36.352299 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m22:44:36.579655 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.76s]
[0m22:44:36.580733 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m22:44:36.582245 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:44:36.582611 [debug] [MainThread]: Connection 'test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m22:44:36.582966 [info ] [MainThread]: 
[0m22:44:36.583346 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 7.62 seconds (7.62s).
[0m22:44:36.584734 [debug] [MainThread]: Command end result
[0m22:44:36.614507 [info ] [MainThread]: 
[0m22:44:36.614878 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:44:36.615098 [info ] [MainThread]: 
[0m22:44:36.615313 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m22:44:36.617079 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.204827, "process_user_time": 1.63945, "process_kernel_time": 0.236027, "process_mem_max_rss": "140083200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m22:44:36.617516 [debug] [MainThread]: Command `dbt test` succeeded at 22:44:36.617454 after 8.21 seconds
[0m22:44:36.617774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112853b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148d0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145ad2e0>]}
[0m22:44:36.618006 [debug] [MainThread]: Flushing usage events
[0m23:42:08.096393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106514890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653b9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653b770>]}


============================== 23:42:08.099189 | 53831966-a434-4887-ba58-a46629cd795c ==============================
[0m23:42:08.099189 [info ] [MainThread]: Running with dbt=1.8.0
[0m23:42:08.099505 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:42:08.309900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53831966-a434-4887-ba58-a46629cd795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fbdb20>]}
[0m23:42:08.333553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53831966-a434-4887-ba58-a46629cd795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653be30>]}
[0m23:42:08.334398 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m23:42:08.344640 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m23:42:08.428028 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:42:08.428437 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://tests/consistent_created_at.sql
[0m23:42:08.519029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53831966-a434-4887-ba58-a46629cd795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107475340>]}
[0m23:42:08.590873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53831966-a434-4887-ba58-a46629cd795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077248f0>]}
[0m23:42:08.591356 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 seed, 6 data tests, 3 sources, 459 macros
[0m23:42:08.591549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53831966-a434-4887-ba58-a46629cd795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c2840>]}
[0m23:42:08.592628 [info ] [MainThread]: 
[0m23:42:08.592940 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:42:08.595158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m23:42:08.603655 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m23:42:08.603930 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m23:42:08.604085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:42:10.548432 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.944 seconds
[0m23:42:10.551695 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m23:42:10.776119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53831966-a434-4887-ba58-a46629cd795c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107289eb0>]}
[0m23:42:10.777096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:42:10.777517 [info ] [MainThread]: 
[0m23:42:10.782367 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m23:42:10.782906 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m23:42:10.783395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m23:42:10.783858 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m23:42:10.801924 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m23:42:10.802837 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m23:42:10.818331 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m23:42:10.819246 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m23:42:10.819551 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m23:42:10.819809 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:12.199228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.379 seconds
[0m23:42:12.211808 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m23:42:12.433493 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.65s]
[0m23:42:12.434717 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m23:42:12.435341 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.consistent_created_at
[0m23:42:12.435905 [info ] [Thread-1 (]: 2 of 6 START test consistent_created_at ........................................ [RUN]
[0m23:42:12.436484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.AIRBNB_DBT.consistent_created_at)
[0m23:42:12.436933 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.consistent_created_at
[0m23:42:12.441561 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.consistent_created_at"
[0m23:42:12.442874 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.consistent_created_at
[0m23:42:12.447707 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.consistent_created_at"
[0m23:42:12.449296 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.consistent_created_at"
[0m23:42:12.449714 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM AIRBNB.DEV.dim_listings_cleansed l
INNER JOIN AIRBNB.DEV.fct_reviews r
USING (listing_id)
WHERE l.created_at <= r.review_date
      
    ) dbt_internal_test
[0m23:42:12.450087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:13.618302 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.167 seconds
[0m23:42:13.624901 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: Close
[0m23:42:13.797345 [error] [Thread-1 (]: 2 of 6 FAIL 409697 consistent_created_at ....................................... [[31mFAIL 409697[0m in 1.36s]
[0m23:42:13.798575 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.consistent_created_at
[0m23:42:13.799237 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m23:42:13.799980 [info ] [Thread-1 (]: 3 of 6 START test dim_listings_minumum_nights .................................. [RUN]
[0m23:42:13.800754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.consistent_created_at, now test.AIRBNB_DBT.dim_listings_minumum_nights)
[0m23:42:13.801225 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m23:42:13.805455 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m23:42:13.808123 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m23:42:13.811322 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m23:42:13.813286 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m23:42:13.813698 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.dim_listings_minumum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m23:42:13.814017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:14.753515 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.939 seconds
[0m23:42:14.758589 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: Close
[0m23:42:14.924295 [info ] [Thread-1 (]: 3 of 6 PASS dim_listings_minumum_nights ........................................ [[32mPASS[0m in 1.12s]
[0m23:42:14.924907 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m23:42:14.925280 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m23:42:14.925570 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m23:42:14.926025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.dim_listings_minumum_nights, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m23:42:14.926379 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m23:42:14.932720 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m23:42:14.934399 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m23:42:14.936344 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m23:42:14.937161 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m23:42:14.937428 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m23:42:14.937658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:15.774679 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.836 seconds
[0m23:42:15.781721 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m23:42:15.921447 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.99s]
[0m23:42:15.922569 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m23:42:15.923243 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m23:42:15.923925 [info ] [Thread-1 (]: 5 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m23:42:15.924738 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m23:42:15.925329 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m23:42:15.931713 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m23:42:15.934710 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m23:42:15.937543 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m23:42:15.939341 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m23:42:15.939901 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m23:42:15.940251 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:16.622429 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.682 seconds
[0m23:42:16.626101 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m23:42:16.777647 [info ] [Thread-1 (]: 5 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.85s]
[0m23:42:16.778771 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m23:42:16.779416 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m23:42:16.780217 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m23:42:16.781168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m23:42:16.781704 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m23:42:16.789957 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m23:42:16.792526 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m23:42:16.794876 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m23:42:16.796093 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m23:42:16.796449 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:42:16.796765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:42:17.816765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.019 seconds
[0m23:42:17.821406 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m23:42:17.961893 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 1.18s]
[0m23:42:17.963652 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m23:42:17.965571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:42:17.966066 [debug] [MainThread]: Connection 'test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m23:42:17.966484 [info ] [MainThread]: 
[0m23:42:17.966873 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 9.37 seconds (9.37s).
[0m23:42:17.968337 [debug] [MainThread]: Command end result
[0m23:42:17.997093 [info ] [MainThread]: 
[0m23:42:17.997488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:42:17.997762 [info ] [MainThread]: 
[0m23:42:17.998059 [error] [MainThread]: [31mFailure in test consistent_created_at (tests/consistent_created_at.sql)[0m
[0m23:42:17.998358 [error] [MainThread]:   Got 409697 results, configured to fail if != 0
[0m23:42:17.998610 [info ] [MainThread]: 
[0m23:42:17.998853 [info ] [MainThread]:   compiled code at target/compiled/AIRBNB_DBT/tests/consistent_created_at.sql
[0m23:42:17.999069 [info ] [MainThread]: 
[0m23:42:17.999294 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m23:42:18.131607 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.070302, "process_user_time": 1.687846, "process_kernel_time": 0.278314, "process_mem_max_rss": "141836288", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m23:42:18.132261 [debug] [MainThread]: Command `dbt test` failed at 23:42:18.132172 after 10.07 seconds
[0m23:42:18.132635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079fdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10736e960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107953770>]}
[0m23:42:18.132972 [debug] [MainThread]: Flushing usage events
[0m00:01:28.987282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068bf710>]}


============================== 00:01:28.990233 | 7002f7e5-4598-40f1-9693-ceb67c470409 ==============================
[0m00:01:28.990233 [info ] [MainThread]: Running with dbt=1.8.0
[0m00:01:28.990548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m00:01:29.203269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7002f7e5-4598-40f1-9693-ceb67c470409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ce060>]}
[0m00:01:29.227825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7002f7e5-4598-40f1-9693-ceb67c470409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e0b530>]}
[0m00:01:29.228685 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m00:01:29.238689 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m00:01:29.323607 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:01:29.324002 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://tests/consistent_created_at.sql
[0m00:01:29.413627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7002f7e5-4598-40f1-9693-ceb67c470409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f1610>]}
[0m00:01:29.485558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7002f7e5-4598-40f1-9693-ceb67c470409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aa0e00>]}
[0m00:01:29.485876 [info ] [MainThread]: Found 8 models, 2 snapshots, 1 seed, 6 data tests, 3 sources, 459 macros
[0m00:01:29.486068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7002f7e5-4598-40f1-9693-ceb67c470409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107800bc0>]}
[0m00:01:29.487156 [info ] [MainThread]: 
[0m00:01:29.487461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:01:29.489655 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m00:01:29.497895 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m00:01:29.498160 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m00:01:29.498313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:30.494334 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.996 seconds
[0m00:01:30.498043 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m00:01:30.653838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7002f7e5-4598-40f1-9693-ceb67c470409', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733d220>]}
[0m00:01:30.654923 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:30.655418 [info ] [MainThread]: 
[0m00:01:30.659723 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m00:01:30.660351 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m00:01:30.660926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m00:01:30.661894 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m00:01:30.679615 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m00:01:30.680426 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m00:01:30.696304 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m00:01:30.697286 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m00:01:30.697579 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m00:01:30.697837 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:31.679141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m00:01:31.692093 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m00:01:31.840364 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.18s]
[0m00:01:31.841743 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m00:01:31.842429 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.consistent_created_at
[0m00:01:31.843198 [info ] [Thread-1 (]: 2 of 6 START test consistent_created_at ........................................ [RUN]
[0m00:01:31.843980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.AIRBNB_DBT.consistent_created_at)
[0m00:01:31.844451 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.consistent_created_at
[0m00:01:31.849151 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.consistent_created_at"
[0m00:01:31.850293 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.consistent_created_at
[0m00:01:31.853108 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.consistent_created_at"
[0m00:01:31.854622 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.consistent_created_at"
[0m00:01:31.855103 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM AIRBNB.DEV.dim_listings_cleansed l
INNER JOIN AIRBNB.DEV.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m00:01:31.855474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:33.621427 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.765 seconds
[0m00:01:33.625661 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: Close
[0m00:01:33.756861 [info ] [Thread-1 (]: 2 of 6 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.91s]
[0m00:01:33.757311 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.consistent_created_at
[0m00:01:33.757540 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m00:01:33.757781 [info ] [Thread-1 (]: 3 of 6 START test dim_listings_minumum_nights .................................. [RUN]
[0m00:01:33.758060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.consistent_created_at, now test.AIRBNB_DBT.dim_listings_minumum_nights)
[0m00:01:33.758265 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m00:01:33.759767 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m00:01:33.760165 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m00:01:33.762306 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m00:01:33.762793 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m00:01:33.762988 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.dim_listings_minumum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m00:01:33.763280 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:34.305928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m00:01:34.309880 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: Close
[0m00:01:34.457980 [info ] [Thread-1 (]: 3 of 6 PASS dim_listings_minumum_nights ........................................ [[32mPASS[0m in 0.70s]
[0m00:01:34.459139 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m00:01:34.459795 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m00:01:34.460363 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m00:01:34.460975 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.dim_listings_minumum_nights, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m00:01:34.461783 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m00:01:34.472679 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m00:01:34.474293 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m00:01:34.477081 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m00:01:34.478610 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m00:01:34.479094 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m00:01:34.479604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:35.169265 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.689 seconds
[0m00:01:35.173647 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m00:01:35.317590 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.86s]
[0m00:01:35.318807 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m00:01:35.319468 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m00:01:35.320163 [info ] [Thread-1 (]: 5 of 6 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m00:01:35.320933 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m00:01:35.321491 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m00:01:35.327808 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m00:01:35.328891 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m00:01:35.331926 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m00:01:35.333205 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m00:01:35.333600 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m00:01:35.333922 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:36.082033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.748 seconds
[0m00:01:36.085075 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m00:01:36.235155 [info ] [Thread-1 (]: 5 of 6 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.91s]
[0m00:01:36.236294 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m00:01:36.236909 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m00:01:36.237451 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m00:01:36.237994 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m00:01:36.238437 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m00:01:36.247371 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m00:01:36.248511 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m00:01:36.251308 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m00:01:36.252680 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m00:01:36.253085 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:01:36.253419 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:01:36.724632 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m00:01:36.726062 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m00:01:36.879818 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.64s]
[0m00:01:36.881036 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m00:01:36.882734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:36.883140 [debug] [MainThread]: Connection 'test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m00:01:36.883429 [info ] [MainThread]: 
[0m00:01:36.883690 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m00:01:36.884673 [debug] [MainThread]: Command end result
[0m00:01:36.914880 [info ] [MainThread]: 
[0m00:01:36.915258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:01:36.915484 [info ] [MainThread]: 
[0m00:01:36.915697 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m00:01:36.917910 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.964762, "process_user_time": 1.627265, "process_kernel_time": 0.237897, "process_mem_max_rss": "139608064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:01:36.918369 [debug] [MainThread]: Command `dbt test` succeeded at 00:01:36.918300 after 7.97 seconds
[0m00:01:36.918608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f40a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107544530>]}
[0m00:01:36.918823 [debug] [MainThread]: Flushing usage events
[0m21:29:41.020340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11115da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11143f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11143f590>]}


============================== 21:29:41.023673 | 9686b643-19cc-4850-b0f3-fa83dc7a3121 ==============================
[0m21:29:41.023673 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:29:41.024007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:29:41.107502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9686b643-19cc-4850-b0f3-fa83dc7a3121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11143f980>]}
[0m21:29:41.119646 [debug] [MainThread]: Set downloads directory='/var/folders/dw/l0t88yqj0251nsq1251sjs700000gn/T/dbt-downloads-y4rzsx_p'
[0m21:29:41.119973 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:29:41.315294 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:29:41.316521 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:29:41.468101 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:29:41.476646 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m21:29:41.536182 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m21:29:41.541171 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m21:29:41.605607 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m21:29:41.621669 [info ] [MainThread]: Updating lock file in file path: /Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/package-lock.yml
[0m21:29:41.624732 [debug] [MainThread]: Set downloads directory='/var/folders/dw/l0t88yqj0251nsq1251sjs700000gn/T/dbt-downloads-zlfrmltp'
[0m21:29:41.631109 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:29:42.105819 [info ] [MainThread]: Installed from version 1.1.1
[0m21:29:42.106143 [info ] [MainThread]: Updated version available: 1.3.0
[0m21:29:42.106376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9686b643-19cc-4850-b0f3-fa83dc7a3121', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b09df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11147d370>]}
[0m21:29:42.106592 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m21:29:42.833079 [info ] [MainThread]: Installed from version 0.10.1
[0m21:29:42.833380 [info ] [MainThread]: Updated version available: 0.10.4
[0m21:29:42.833585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9686b643-19cc-4850-b0f3-fa83dc7a3121', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114727b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115fddf0>]}
[0m21:29:42.833793 [info ] [MainThread]: Installing calogica/dbt_date
[0m21:29:43.093818 [info ] [MainThread]: Installed from version 0.10.1
[0m21:29:43.094150 [info ] [MainThread]: Up to date!
[0m21:29:43.094409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9686b643-19cc-4850-b0f3-fa83dc7a3121', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11163b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11163a3c0>]}
[0m21:29:43.094684 [info ] [MainThread]: 
[0m21:29:43.094909 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m21:29:43.244733 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.274062, "process_user_time": 1.069084, "process_kernel_time": 0.3575, "process_mem_max_rss": "107757568", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:29:43.245649 [debug] [MainThread]: Command `dbt deps` succeeded at 21:29:43.245531 after 2.28 seconds
[0m21:29:43.246087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110532240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ac5ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155cdd0>]}
[0m21:29:43.246920 [debug] [MainThread]: Flushing usage events
[0m21:34:11.906908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4b42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac1e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b743a40>]}


============================== 21:34:11.910349 | 25de51ed-270c-406e-8cc7-f3076de5c70a ==============================
[0m21:34:11.910349 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:34:11.910697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_reviews', 'send_anonymous_usage_stats': 'True'}
[0m21:34:12.485710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25de51ed-270c-406e-8cc7-f3076de5c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f9e50>]}
[0m21:34:12.510869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25de51ed-270c-406e-8cc7-f3076de5c70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c61dc70>]}
[0m21:34:12.512384 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:34:12.872060 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:34:12.970605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:34:12.971097 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/fct/fct_reviews.sql
[0m21:34:13.095086 [error] [MainThread]: Encountered an error:
Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The AIRBNB_DBT.fct_reviews model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m21:34:13.098105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2288117, "process_user_time": 0.998019, "process_kernel_time": 0.20188, "process_mem_max_rss": "125206528", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:34:13.099005 [debug] [MainThread]: Command `dbt run` failed at 21:34:13.098894 after 1.23 seconds
[0m21:34:13.099303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b703110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c814f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c644980>]}
[0m21:34:13.099553 [debug] [MainThread]: Flushing usage events
[0m21:35:22.829137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104255f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa7dd0>]}


============================== 21:35:22.832267 | 2d0e16b9-7e02-4487-a98f-e47d64a10286 ==============================
[0m21:35:22.832267 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:35:22.832695 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_reviews', 'send_anonymous_usage_stats': 'True'}
[0m21:35:23.078764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105140ce0>]}
[0m21:35:23.104653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fdeb0>]}
[0m21:35:23.105368 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:35:23.123515 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:35:23.212122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:35:23.212575 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://models/fct/fct_reviews.sql
[0m21:35:23.348238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e88a40>]}
[0m21:35:23.425806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a5b980>]}
[0m21:35:23.426160 [info ] [MainThread]: Found 8 models, 2 snapshots, 6 data tests, 1 seed, 3 sources, 834 macros
[0m21:35:23.426363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598e840>]}
[0m21:35:23.427332 [info ] [MainThread]: 
[0m21:35:23.427652 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:23.428107 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m21:35:23.435545 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m21:35:23.435794 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m21:35:23.435950 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:24.938299 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.502 seconds
[0m21:35:24.940738 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m21:35:25.149337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m21:35:25.161354 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m21:35:25.161935 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m21:35:25.162217 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:35:26.075885 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.913 seconds
[0m21:35:26.079474 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m21:35:26.230732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d9b170>]}
[0m21:35:26.231757 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:35:26.232641 [info ] [MainThread]: 
[0m21:35:26.237732 [debug] [Thread-1 (]: Began running node model.AIRBNB_DBT.fct_reviews
[0m21:35:26.238523 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m21:35:26.239102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.AIRBNB_DBT.fct_reviews)
[0m21:35:26.239644 [debug] [Thread-1 (]: Began compiling node model.AIRBNB_DBT.fct_reviews
[0m21:35:26.254328 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m21:35:26.259805 [debug] [Thread-1 (]: Writing injected SQL for node "model.AIRBNB_DBT.fct_reviews"
[0m21:35:26.261042 [debug] [Thread-1 (]: Began executing node model.AIRBNB_DBT.fct_reviews
[0m21:35:26.296689 [debug] [Thread-1 (]: Writing runtime sql for node "model.AIRBNB_DBT.fct_reviews"
[0m21:35:26.297774 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m21:35:26.298011 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

WITH  __dbt__cte__src_reviews as (
WITH raw_reviews AS(
    SELECT * FROM AIRBNB.raw.raw_reviews
)
SELECT
    listing_id,
    date AS review_date,
    reviewer_name,
    comments AS review_text,
    sentiment AS review_sentiment
FROM
    raw_reviews
), src_reviews AS(
    SELECT * FROM __dbt__cte__src_reviews
)

SELECT
 md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,
 * 
FROM 
  src_reviews as r
WHERE r.review_text IS NOT NULL

        );
[0m21:35:26.298256 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:35:31.319042 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.020 seconds
[0m21:35:31.332331 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m21:35:31.340063 [debug] [Thread-1 (]: Using snowflake connection "model.AIRBNB_DBT.fct_reviews"
[0m21:35:31.340730 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "model.AIRBNB_DBT.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m21:35:31.436202 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.095 seconds
[0m21:35:31.462282 [debug] [Thread-1 (]: On model.AIRBNB_DBT.fct_reviews: Close
[0m21:35:31.606182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d0e16b9-7e02-4487-a98f-e47d64a10286', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104256630>]}
[0m21:35:31.607605 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 5.37s]
[0m21:35:31.608621 [debug] [Thread-1 (]: Finished running node model.AIRBNB_DBT.fct_reviews
[0m21:35:31.610236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:31.610725 [debug] [MainThread]: Connection 'model.AIRBNB_DBT.fct_reviews' was properly closed.
[0m21:35:31.611114 [info ] [MainThread]: 
[0m21:35:31.611506 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m21:35:31.612278 [debug] [MainThread]: Command end result
[0m21:35:31.650978 [info ] [MainThread]: 
[0m21:35:31.651381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:35:31.651588 [info ] [MainThread]: 
[0m21:35:31.651789 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m21:35:31.653549 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.861595, "process_user_time": 1.570874, "process_kernel_time": 0.284869, "process_mem_max_rss": "142049280", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:35:31.653883 [debug] [MainThread]: Command `dbt run` succeeded at 21:35:31.653824 after 8.86 seconds
[0m21:35:31.654114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103aa7dd0>]}
[0m21:35:31.654317 [debug] [MainThread]: Flushing usage events
[0m21:39:36.456980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104713830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104710920>]}


============================== 21:39:36.459972 | b343f445-2562-417f-b797-1866b403b2ab ==============================
[0m21:39:36.459972 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:39:36.460280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:39:36.686154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104711d90>]}
[0m21:39:36.711125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106278650>]}
[0m21:39:36.712632 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:39:36.732505 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:39:36.799013 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:39:36.799383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051dd400>]}
[0m21:39:37.805817 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m21:39:37.806356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104bd3a0>]}
[0m21:39:37.893428 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.AIRBNB_DBT.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleaned_.d7fa15de55' (models/schema.yml) depends on a node named 'dim_hosts_cleaned' in package '' which was not found
[0m21:39:37.982630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11103f170>]}
[0m21:39:38.062241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110727a70>]}
[0m21:39:38.062583 [info ] [MainThread]: Found 8 models, 2 snapshots, 7 data tests, 1 seed, 3 sources, 835 macros
[0m21:39:38.062769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111078e00>]}
[0m21:39:38.063820 [info ] [MainThread]: 
[0m21:39:38.064145 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:39:38.066793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m21:39:38.075306 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m21:39:38.075535 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m21:39:38.075679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:39:38.799256 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.723 seconds
[0m21:39:38.802971 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m21:39:38.997231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b343f445-2562-417f-b797-1866b403b2ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111078e00>]}
[0m21:39:38.998384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:39:38.998833 [info ] [MainThread]: 
[0m21:39:39.002993 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:39:39.003528 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m21:39:39.004031 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m21:39:39.004853 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:39:39.017006 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:39:39.018864 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:39:39.035861 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:39:39.036872 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:39:39.037174 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m21:39:39.037433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:40.162114 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.124 seconds
[0m21:39:40.171928 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m21:39:40.310921 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.31s]
[0m21:39:40.312112 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:39:40.312686 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.consistent_created_at
[0m21:39:40.313331 [info ] [Thread-1 (]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m21:39:40.313940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.AIRBNB_DBT.consistent_created_at)
[0m21:39:40.314356 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.consistent_created_at
[0m21:39:40.319284 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.consistent_created_at"
[0m21:39:40.320823 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.consistent_created_at
[0m21:39:40.323862 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.consistent_created_at"
[0m21:39:40.325054 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.consistent_created_at"
[0m21:39:40.325442 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM AIRBNB.DEV.dim_listings_cleansed l
INNER JOIN AIRBNB.DEV.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m21:39:40.325777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:41.495064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.169 seconds
[0m21:39:41.499139 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: Close
[0m21:39:41.707327 [info ] [Thread-1 (]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.39s]
[0m21:39:41.708627 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.consistent_created_at
[0m21:39:41.709479 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:39:41.710327 [info ] [Thread-1 (]: 3 of 7 START test dim_listings_minumum_nights .................................. [RUN]
[0m21:39:41.710905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.consistent_created_at, now test.AIRBNB_DBT.dim_listings_minumum_nights)
[0m21:39:41.711364 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:39:41.716176 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m21:39:41.718686 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:39:41.722260 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m21:39:41.723597 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m21:39:41.723953 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.dim_listings_minumum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m21:39:41.724275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:42.558711 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.834 seconds
[0m21:39:42.561180 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: Close
[0m21:39:42.758136 [info ] [Thread-1 (]: 3 of 7 PASS dim_listings_minumum_nights ........................................ [[32mPASS[0m in 1.05s]
[0m21:39:42.759205 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:39:42.759683 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:39:42.760161 [info ] [Thread-1 (]: 4 of 7 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m21:39:42.760995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.dim_listings_minumum_nights, now test.AIRBNB_DBT.no_nulls_in_dim_listings)
[0m21:39:42.761523 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:39:42.765452 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:39:42.766364 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:39:42.768852 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:39:42.769674 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:39:42.770000 [debug] [Thread-1 (]: On test.AIRBNB_DBT.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      no_nulls_in_columns(AIRBNB.DEV.dim_listings_cleansed)
      
    ) dbt_internal_test
[0m21:39:42.770311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:43.242829 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b877d7-0004-2cf6-0002-456b0002e51e
[0m21:39:43.243729 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 6 at position 6 unexpected 'no_nulls_in_columns'.
[0m21:39:43.244465 [debug] [Thread-1 (]: On test.AIRBNB_DBT.no_nulls_in_dim_listings: Close
[0m21:39:43.387118 [debug] [Thread-1 (]: Database Error in test no_nulls_in_dim_listings (tests/no_nulls_in_dim_listings.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 6 unexpected 'no_nulls_in_columns'.
  compiled code at target/run/AIRBNB_DBT/tests/no_nulls_in_dim_listings.sql
[0m21:39:43.387832 [error] [Thread-1 (]: 4 of 7 ERROR no_nulls_in_dim_listings .......................................... [[31mERROR[0m in 0.63s]
[0m21:39:43.388329 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:39:43.388667 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:39:43.389734 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m21:39:43.390353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.no_nulls_in_dim_listings, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m21:39:43.390642 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:39:43.396968 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:39:43.397648 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:39:43.399514 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:39:43.400645 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:39:43.400915 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m21:39:43.401146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:44.115227 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m21:39:44.117843 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m21:39:44.301794 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.91s]
[0m21:39:44.302709 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:39:44.303122 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:39:44.303705 [info ] [Thread-1 (]: 6 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m21:39:44.304465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m21:39:44.304945 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:39:44.309351 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:39:44.310254 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:39:44.312588 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:39:44.313391 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:39:44.313660 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m21:39:44.313910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:44.785303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.471 seconds
[0m21:39:44.786832 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m21:39:44.910405 [info ] [Thread-1 (]: 6 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.61s]
[0m21:39:44.911222 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:39:44.911652 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:39:44.912214 [info ] [Thread-1 (]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m21:39:44.912970 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m21:39:44.913444 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:39:44.919551 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:39:44.920206 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:39:44.922401 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:39:44.923361 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:39:44.923662 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:39:44.923928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:39:45.583341 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m21:39:45.586419 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m21:39:45.780403 [info ] [Thread-1 (]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.87s]
[0m21:39:45.781683 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:39:45.783640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:39:45.784238 [debug] [MainThread]: Connection 'test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m21:39:45.784687 [info ] [MainThread]: 
[0m21:39:45.785236 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m21:39:45.787000 [debug] [MainThread]: Command end result
[0m21:39:45.825566 [info ] [MainThread]: 
[0m21:39:45.825940 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:39:45.826218 [info ] [MainThread]: 
[0m21:39:45.826631 [error] [MainThread]:   Database Error in test no_nulls_in_dim_listings (tests/no_nulls_in_dim_listings.sql)
  001003 (42000): SQL compilation error:
  syntax error line 6 at position 6 unexpected 'no_nulls_in_columns'.
  compiled code at target/run/AIRBNB_DBT/tests/no_nulls_in_dim_listings.sql
[0m21:39:45.826902 [info ] [MainThread]: 
[0m21:39:45.827115 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m21:39:45.828921 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 9.408934, "process_user_time": 2.646614, "process_kernel_time": 0.269091, "process_mem_max_rss": "149569536", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:39:45.829320 [debug] [MainThread]: Command `dbt test` failed at 21:39:45.829266 after 9.41 seconds
[0m21:39:45.829571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105122fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107a7050>]}
[0m21:39:45.829786 [debug] [MainThread]: Flushing usage events
[0m21:40:04.497929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046c76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc39b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc3740>]}


============================== 21:40:04.501003 | 9f1d2799-496e-4763-981e-d2f62d7fcb8e ==============================
[0m21:40:04.501003 [info ] [MainThread]: Running with dbt=1.8.0
[0m21:40:04.501326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'version_check': 'True', 'profiles_dir': '/Users/JELB/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:40:04.737474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f1d2799-496e-4763-981e-d2f62d7fcb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa6fc0>]}
[0m21:40:04.763739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f1d2799-496e-4763-981e-d2f62d7fcb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc04d0>]}
[0m21:40:04.764489 [info ] [MainThread]: Registered adapter: snowflake=1.8.4
[0m21:40:04.784277 [debug] [MainThread]: checksum: dbb12d416fdb55e3665e4828703bbedf40c5c90ed7ca6ff39bbbfb29b12b0a92, vars: {}, profile: , target: , version: 1.8.0
[0m21:40:04.893886 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:40:04.894312 [debug] [MainThread]: Partial parsing: updated file: AIRBNB_DBT://tests/no_nulls_in_dim_listings.sql
[0m21:40:04.995647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f1d2799-496e-4763-981e-d2f62d7fcb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714e690>]}
[0m21:40:05.080454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f1d2799-496e-4763-981e-d2f62d7fcb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072b6870>]}
[0m21:40:05.080765 [info ] [MainThread]: Found 8 models, 2 snapshots, 7 data tests, 1 seed, 3 sources, 835 macros
[0m21:40:05.080953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1d2799-496e-4763-981e-d2f62d7fcb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070bc740>]}
[0m21:40:05.082016 [info ] [MainThread]: 
[0m21:40:05.082317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:40:05.084594 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m21:40:05.092885 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m21:40:05.093119 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show objects in AIRBNB.DEV limit 10000
[0m21:40:05.093268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:40:05.970877 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.877 seconds
[0m21:40:05.974503 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m21:40:06.123575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1d2799-496e-4763-981e-d2f62d7fcb8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd0590>]}
[0m21:40:06.124809 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:40:06.125263 [info ] [MainThread]: 
[0m21:40:06.128904 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:40:06.129492 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m21:40:06.130056 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af)
[0m21:40:06.130431 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:40:06.148964 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:40:06.149755 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:40:06.165260 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:40:06.166274 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"
[0m21:40:06.166569 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listings_cleansed
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m21:40:06.166825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:06.813304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.646 seconds
[0m21:40:06.826157 [debug] [Thread-1 (]: On test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af: Close
[0m21:40:06.965990 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.84s]
[0m21:40:06.967282 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af
[0m21:40:06.968486 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.consistent_created_at
[0m21:40:06.969214 [info ] [Thread-1 (]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m21:40:06.969877 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af, now test.AIRBNB_DBT.consistent_created_at)
[0m21:40:06.970315 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.consistent_created_at
[0m21:40:06.975408 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.consistent_created_at"
[0m21:40:06.976496 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.consistent_created_at
[0m21:40:06.979748 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.consistent_created_at"
[0m21:40:06.981208 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.consistent_created_at"
[0m21:40:06.981582 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT * FROM AIRBNB.DEV.dim_listings_cleansed l
INNER JOIN AIRBNB.DEV.fct_reviews r
USING (listing_id)
WHERE l.created_at >= r.review_date
      
    ) dbt_internal_test
[0m21:40:06.981966 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:07.528534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.546 seconds
[0m21:40:07.532006 [debug] [Thread-1 (]: On test.AIRBNB_DBT.consistent_created_at: Close
[0m21:40:07.663705 [info ] [Thread-1 (]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.69s]
[0m21:40:07.664907 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.consistent_created_at
[0m21:40:07.665547 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:40:07.666323 [info ] [Thread-1 (]: 3 of 7 START test dim_listings_minumum_nights .................................. [RUN]
[0m21:40:07.667097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.consistent_created_at, now test.AIRBNB_DBT.dim_listings_minumum_nights)
[0m21:40:07.667566 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:40:07.672207 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m21:40:07.673275 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:40:07.676462 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m21:40:07.677730 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.dim_listings_minumum_nights"
[0m21:40:07.678109 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.dim_listings_minumum_nights"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      SELECT
*
FROM
AIRBNB.DEV.dim_listings_cleansed
WHERE minimum_nights < 1
LIMIT 10
      
    ) dbt_internal_test
[0m21:40:07.678433 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:08.211464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.533 seconds
[0m21:40:08.213187 [debug] [Thread-1 (]: On test.AIRBNB_DBT.dim_listings_minumum_nights: Close
[0m21:40:08.451353 [info ] [Thread-1 (]: 3 of 7 PASS dim_listings_minumum_nights ........................................ [[32mPASS[0m in 0.78s]
[0m21:40:08.452920 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.dim_listings_minumum_nights
[0m21:40:08.453606 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:40:08.454447 [info ] [Thread-1 (]: 4 of 7 START test no_nulls_in_dim_listings ..................................... [RUN]
[0m21:40:08.455299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.dim_listings_minumum_nights, now test.AIRBNB_DBT.no_nulls_in_dim_listings)
[0m21:40:08.455779 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:40:08.469017 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:40:08.469575 [debug] [Thread-1 (]: On test.AIRBNB_DBT.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.no_nulls_in_dim_listings"} */
describe table AIRBNB.DEV.dim_listings_cleansed
[0m21:40:08.469898 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:08.992951 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.522 seconds
[0m21:40:08.996945 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:40:08.998117 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:40:09.002269 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:40:09.003629 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.no_nulls_in_dim_listings"
[0m21:40:09.004095 [debug] [Thread-1 (]: On test.AIRBNB_DBT.no_nulls_in_dim_listings: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.no_nulls_in_dim_listings"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed WHERE
    LISTING_ID IS NULL OR
    LISTING_URL IS NULL OR
    LISTING_NAME IS NULL OR
    ROOM_TYPE IS NULL OR
    MINIMUM_NIGHTS IS NULL OR
    HOST_ID IS NULL OR
    PRICE IS NULL OR
    CREATED_AT IS NULL OR
    UPDATED_AT IS NULL OR
    
    FALSE

      
    ) dbt_internal_test
[0m21:40:09.435667 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.431 seconds
[0m21:40:09.439109 [debug] [Thread-1 (]: On test.AIRBNB_DBT.no_nulls_in_dim_listings: Close
[0m21:40:09.608353 [info ] [Thread-1 (]: 4 of 7 PASS no_nulls_in_dim_listings ........................................... [[32mPASS[0m in 1.15s]
[0m21:40:09.609453 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.no_nulls_in_dim_listings
[0m21:40:09.610117 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:40:09.610764 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_listings_cleansed_host_id ....................... [RUN]
[0m21:40:09.611395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.no_nulls_in_dim_listings, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be)
[0m21:40:09.611820 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:40:09.620401 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:40:09.621711 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:40:09.627052 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:40:09.628086 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"
[0m21:40:09.628442 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listings_cleansed
where host_id is null



      
    ) dbt_internal_test
[0m21:40:09.628731 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:10.120369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.491 seconds
[0m21:40:10.123836 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be: Close
[0m21:40:10.284813 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_listings_cleansed_host_id ............................. [[32mPASS[0m in 0.67s]
[0m21:40:10.286140 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be
[0m21:40:10.286715 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:40:10.287368 [info ] [Thread-1 (]: 6 of 7 START test not_null_dim_listings_cleansed_listing_id .................... [RUN]
[0m21:40:10.288085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_host_id.084e4105be, now test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9)
[0m21:40:10.288577 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:40:10.294665 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:40:10.295706 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:40:10.299019 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:40:10.300503 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"
[0m21:40:10.300932 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listings_cleansed
where listing_id is null



      
    ) dbt_internal_test
[0m21:40:10.301253 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:10.879104 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m21:40:10.882539 [debug] [Thread-1 (]: On test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9: Close
[0m21:40:11.104925 [info ] [Thread-1 (]: 6 of 7 PASS not_null_dim_listings_cleansed_listing_id .......................... [[32mPASS[0m in 0.82s]
[0m21:40:11.106038 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9
[0m21:40:11.106659 [debug] [Thread-1 (]: Began running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:40:11.107190 [info ] [Thread-1 (]: 7 of 7 START test unique_dim_listings_cleansed_listing_id ...................... [RUN]
[0m21:40:11.108081 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.AIRBNB_DBT.not_null_dim_listings_cleansed_listing_id.2da437bec9, now test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e)
[0m21:40:11.108698 [debug] [Thread-1 (]: Began compiling node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:40:11.117122 [debug] [Thread-1 (]: Writing injected SQL for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:40:11.118398 [debug] [Thread-1 (]: Began executing node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:40:11.121033 [debug] [Thread-1 (]: Writing runtime sql for node "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:40:11.122067 [debug] [Thread-1 (]: Using snowflake connection "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"
[0m21:40:11.122408 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: /* {"app": "dbt", "dbt_version": "1.8.0", "profile_name": "AIRBNB_DBT", "target_name": "dev", "node_id": "test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listings_cleansed
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:40:11.122723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:40:11.624985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m21:40:11.628118 [debug] [Thread-1 (]: On test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e: Close
[0m21:40:11.784530 [info ] [Thread-1 (]: 7 of 7 PASS unique_dim_listings_cleansed_listing_id ............................ [[32mPASS[0m in 0.68s]
[0m21:40:11.785686 [debug] [Thread-1 (]: Finished running node test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e
[0m21:40:11.787692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:40:11.788410 [debug] [MainThread]: Connection 'test.AIRBNB_DBT.unique_dim_listings_cleansed_listing_id.930e4e859e' was properly closed.
[0m21:40:11.788861 [info ] [MainThread]: 
[0m21:40:11.789269 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 6.71 seconds (6.71s).
[0m21:40:11.790938 [debug] [MainThread]: Command end result
[0m21:40:11.830246 [info ] [MainThread]: 
[0m21:40:11.830599 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:40:11.830804 [info ] [MainThread]: 
[0m21:40:11.831003 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m21:40:11.832634 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.3728905, "process_user_time": 1.863692, "process_kernel_time": 0.28325, "process_mem_max_rss": "142213120", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m21:40:11.833005 [debug] [MainThread]: Command `dbt test` succeeded at 21:40:11.832948 after 7.37 seconds
[0m21:40:11.833243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c52240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a08740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1021e2b70>]}
[0m21:40:11.833462 [debug] [MainThread]: Flushing usage events
[0m16:31:57.024918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e20560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111503860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111503590>]}


============================== 16:31:57.027712 | 4bce6eb0-fa0e-432e-ad69-8a168a389436 ==============================
[0m16:31:57.027712 [info ] [MainThread]: Running with dbt=1.8.0
[0m16:31:57.028065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/JELB/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/JELB/WorkSpace/DBT/dbtCourse/AIRBNB_DBT/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:57.099324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4bce6eb0-fa0e-432e-ad69-8a168a389436', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f3d1c0>]}
[0m16:31:57.140191 [debug] [MainThread]: Set downloads directory='/var/folders/dw/l0t88yqj0251nsq1251sjs700000gn/T/dbt-downloads-h712j_sz'
[0m16:31:57.140496 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:31:57.403302 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:31:57.403864 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:31:57.505137 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:31:57.507358 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m16:31:57.637732 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m16:31:57.640173 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m16:31:57.756264 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m16:31:57.759946 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:31:58.298453 [info ] [MainThread]: Installed from version 1.1.1
[0m16:31:58.298786 [info ] [MainThread]: Updated version available: 1.3.0
[0m16:31:58.299018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4bce6eb0-fa0e-432e-ad69-8a168a389436', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111500560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111503350>]}
[0m16:31:58.299255 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m16:31:59.186542 [info ] [MainThread]: Installed from version 0.10.1
[0m16:31:59.186836 [info ] [MainThread]: Updated version available: 0.10.4
[0m16:31:59.187037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4bce6eb0-fa0e-432e-ad69-8a168a389436', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115431d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111542d80>]}
[0m16:31:59.187238 [info ] [MainThread]: Installing calogica/dbt_date
[0m16:31:59.527259 [info ] [MainThread]: Installed from version 0.10.1
[0m16:31:59.527760 [info ] [MainThread]: Up to date!
[0m16:31:59.528062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4bce6eb0-fa0e-432e-ad69-8a168a389436', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111542d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111694800>]}
[0m16:31:59.528381 [info ] [MainThread]: 
[0m16:31:59.528653 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils', 'calogica/dbt_expectations']                 
Update your versions in packages.yml, then run dbt deps
[0m16:31:59.692357 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.7030044, "process_user_time": 0.782192, "process_kernel_time": 0.23092, "process_mem_max_rss": "107577344", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m16:31:59.693237 [debug] [MainThread]: Command `dbt deps` succeeded at 16:31:59.693110 after 2.70 seconds
[0m16:31:59.693650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11067e540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116c5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111581eb0>]}
[0m16:31:59.694054 [debug] [MainThread]: Flushing usage events
